import { Component, ViewChild, Input, HostListener, NgZone } from '@angular/core';
import { BufferAttribute, Clock, InstancedBufferAttribute, InstancedBufferGeometry, LinearFilter, Mesh, MeshBasicMaterial, PerspectiveCamera, PlaneGeometry, Raycaster, RGBFormat, Scene, TextureLoader, Vector2, WebGLRenderer } from 'three';
import { Object3D, RawShaderMaterial, Texture } from 'three';
import { TouchTexture } from './scripts/touch-texture';
import { Shaders } from './scripts/shaders';
import { RxjsTween } from '../tween/rxjs-tween';
import { interval, Subscription } from 'rxjs';
import { animate, style, transition, trigger } from '@angular/animations';
export class ImageAsParticlesComponent {
    constructor(ngZone) {
        this.ngZone = ngZone;
        // Declare variables
        this.renderer = new WebGLRenderer({ antialias: true, alpha: true });
        this.scene = new Scene();
        this.clock = new Clock(true);
        this.texture = new Texture();
        this.width = 0;
        this.height = 0;
        this.touch = new TouchTexture();
        this.mouse = new Vector2();
        this.raycaster = new Raycaster();
        this.pImageUrl = '';
        this.pImageChanging = false;
        this.gestureInfo$ = interval(2000);
        this.gestureInfoSubscription = new Subscription();
        this.showTouchGestureInfo = false;
        this.justifyContent = 'center';
        this.alignItems = 'center';
        this.backgroundColor = '#000000';
        this.imageWidth = '100%';
        this.imageHeight = '100%';
        this.animationEnabled = true;
    }
    // Inputs
    set imageUrl(imageUrl) {
        this.pImageUrl = imageUrl;
        if (this.pImageChanging === true) {
            return;
        }
        if (this.mesh != null) {
            this.pImageChanging = true;
            this.triggerImageChange();
        }
    }
    get imageUrl() { return this.pImageUrl; }
    set horizontalAlignment(horizontalAlignment) {
        switch (horizontalAlignment) {
            case 'start':
                this.justifyContent = 'flex-start';
                break;
            case 'center':
                this.justifyContent = 'center';
                break;
            case 'end':
                this.justifyContent = 'flex-end';
                break;
            default:
                this.justifyContent = 'center';
                break;
        }
    }
    get horizontalAlignment() { return this.justifyContent; }
    set verticalAlignment(verticalAlignment) {
        switch (verticalAlignment) {
            case 'top':
                this.alignItems = 'flex-start';
                break;
            case 'center':
                this.alignItems = 'center';
                break;
            case 'bottom':
                this.alignItems = 'flex-end';
                break;
            default:
                this.alignItems = 'center';
                break;
        }
    }
    get verticalAlignment() { return this.alignItems; }
    ngAfterViewInit() {
        if (this.pImageUrl === '') {
            return;
        }
        const canvasWidth = this.canvasRef.nativeElement.clientWidth;
        const canvasHeight = this.canvasRef.nativeElement.clientHeight;
        // Set camera
        this.camera = new PerspectiveCamera(50, canvasWidth / canvasHeight, 1, 10000);
        this.camera.position.z = 300;
        // Init particles
        this.initParticles(this.pImageUrl);
        // Init renderer
        this.renderer.setSize(canvasWidth - 1, canvasHeight);
        this.canvasRef.nativeElement.appendChild(this.renderer.domElement);
        // Start animation
        this.animate();
    }
    ngOnDestroy() {
        this.scene.clear();
        this.renderer.clear();
        this.texture.dispose();
        this.renderer.dispose();
    }
    /**
     * Creates the particles depending on the image and initializes the touch canvas
     * @param url url of the image
     */
    initParticles(url) {
        const loader = new TextureLoader();
        loader.load(url, (texture) => {
            this.texture = texture;
            this.texture.minFilter = LinearFilter;
            this.texture.magFilter = LinearFilter;
            this.texture.format = RGBFormat;
            this.width = texture.image.width;
            this.height = texture.image.height;
            this.initPoints(true);
            this.initHitArea();
            this.initTouch();
            this.resize();
            this.show();
        });
    }
    /**
     * Initializes the points
     * @param discard discard pixels darker than threshold #22
     */
    initPoints(discard) {
        const numPoints = this.width * this.height;
        let numVisible = numPoints;
        let threshold = 0;
        let originalColors = new Float32Array();
        if (discard) {
            // discard pixels darker than threshold #22
            numVisible = 0;
            threshold = 34;
            const img = this.texture.image;
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            canvas.width = this.width;
            canvas.height = this.height;
            if (ctx != null) {
                ctx.scale(1, -1);
                ctx.drawImage(img, 0, 0, this.width, this.height * -1);
                const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                originalColors = Float32Array.from(imgData.data);
                for (let i = 0; i < numPoints; i++) {
                    if (originalColors[i * 4 + 0] > threshold) {
                        numVisible++;
                    }
                }
            }
        }
        const uniforms = {
            uTime: { value: 0 },
            uRandom: { value: 1.0 },
            uDepth: { value: 2.0 },
            uSize: { value: 0.0 },
            uTextureSize: { value: new Vector2(this.width, this.height) },
            uTexture: { value: this.texture },
            uTouch: { value: null },
        };
        const shaders = new Shaders();
        const material = new RawShaderMaterial({
            uniforms,
            vertexShader: shaders.particleVertex,
            fragmentShader: shaders.particleFragment,
            depthTest: false,
            transparent: true,
            // blending: THREE.AdditiveBlending
        });
        const geometry = new InstancedBufferGeometry();
        // positions
        const positions = new BufferAttribute(new Float32Array(4 * 3), 3);
        positions.setXYZ(0, -0.5, 0.5, 0.0);
        positions.setXYZ(1, 0.5, 0.5, 0.0);
        positions.setXYZ(2, -0.5, -0.5, 0.0);
        positions.setXYZ(3, 0.5, -0.5, 0.0);
        geometry.setAttribute('position', positions);
        // uvs
        const uvs = new BufferAttribute(new Float32Array(4 * 2), 2);
        uvs.setXY(0, 0.0, 0.0);
        uvs.setXY(1, 1.0, 0.0);
        uvs.setXY(2, 0.0, 1.0);
        uvs.setXY(3, 1.0, 1.0);
        geometry.setAttribute('uv', uvs);
        // index
        geometry.setIndex(new BufferAttribute(new Uint16Array([0, 2, 1, 2, 3, 1]), 1));
        const indices = new Uint16Array(numVisible);
        const offsets = new Float32Array(numVisible * 3);
        const angles = new Float32Array(numVisible);
        for (let i = 0, j = 0; i < numPoints; i++) {
            if (discard && originalColors[i * 4 + 0] <= threshold) {
                continue;
            }
            offsets[j * 3 + 0] = i % this.width;
            offsets[j * 3 + 1] = Math.floor(i / this.width);
            indices[j] = i;
            angles[j] = Math.random() * Math.PI;
            j++;
        }
        geometry.setAttribute('pindex', new InstancedBufferAttribute(indices, 1, false));
        geometry.setAttribute('offset', new InstancedBufferAttribute(offsets, 3, false));
        geometry.setAttribute('angle', new InstancedBufferAttribute(angles, 1, false));
        this.mesh = new Mesh(geometry, material);
        const object3d = new Object3D();
        object3d.add(this.mesh);
        this.scene.add(object3d);
    }
    /**
     * Initializes the touch area
     */
    initTouch() {
        this.mesh.material.uniforms.uTouch.value = this.touch.texture;
    }
    /**
     * Initializes the hit area
     */
    initHitArea() {
        const geometry = new PlaneGeometry(this.width, this.height, 1, 1);
        const material = new MeshBasicMaterial({ color: 0xFFFFFF, wireframe: true, depthTest: false });
        material.visible = false;
        this.hitArea = new Mesh(geometry, material);
        this.mesh.add(this.hitArea);
    }
    /**
     * animation for showing the particles
     * @param time time of animation in ms
     */
    show(time = 1000) {
        // Tween in
        this.ngZone.runOutsideAngular(() => {
            RxjsTween.createTween(RxjsTween.easeInOutQuad, [0.5, 0.0, 70.0], [1.5, 2.0, 4.0], time).subscribe(val => {
                this.mesh.material.uniforms.uSize.value = val[0];
                this.mesh.material.uniforms.uRandom.value = val[1];
                this.mesh.material.uniforms.uDepth.value = val[2];
            }, () => { }, () => {
                this.pImageChanging = false;
            });
        });
    }
    /**
     * animation for tween out the particles and destroy everything
     * @param time time of animation in ms
     */
    triggerImageChange(time = 1000) {
        const uSizeStart = this.mesh.material.uniforms.uSize.value;
        const uRandomStart = this.mesh.material.uniforms.uRandom.value;
        const uDepth = this.mesh.material.uniforms.uDepth.value;
        this.ngZone.runOutsideAngular(() => {
            // Tween out
            RxjsTween.createTween(RxjsTween.easeInOutQuad, [uSizeStart, uRandomStart, uDepth], [0.0, 5.0, -20.0], time).subscribe(val => {
                this.mesh.material.uniforms.uSize.value = val[0];
                this.mesh.material.uniforms.uRandom.value = val[1];
                this.mesh.material.uniforms.uDepth.value = val[2];
            }, () => { }, () => {
                if (this.mesh != null) {
                    if (this.mesh.parent != null) {
                        this.mesh.parent.remove(this.mesh);
                    }
                    this.mesh.geometry.dispose();
                    this.mesh.material.dispose();
                }
                if (this.hitArea != null) {
                    if (this.hitArea.parent != null) {
                        this.hitArea.parent.remove(this.hitArea);
                    }
                    this.hitArea.geometry.dispose();
                    this.hitArea.material.dispose();
                }
                this.initParticles(this.pImageUrl);
                this.pImageChanging = false;
            });
        });
    }
    /**
     * Method for triggering the animation
     */
    animate() {
        this.ngZone.runOutsideAngular(() => {
            window.requestAnimationFrame(() => this.animate());
            if (this.animationEnabled === true) {
                const delta = this.clock.getDelta();
                if (this.mesh != null) {
                    if (this.touch) {
                        this.touch.update();
                    }
                    this.mesh.material.uniforms.uTime.value += delta;
                }
                this.renderer.render(this.scene, this.camera);
            }
        });
    }
    /**
     * Handle mouse move event
     * @param event mouse event
     */
    onMouseMove(event) {
        // getBoundingClientRect retruns the distance in pixels of the top left corner of the element
        // to the top left corner of the viewport
        const domRect = this.canvasRef.nativeElement.getBoundingClientRect();
        // get the offset distance between the canvas, which contains the particles, to the outer container element
        const canvasEl = this.canvasRef.nativeElement.children[0];
        // Calculate the relative mouse position
        this.mouse.x = (event.clientX - domRect.left - canvasEl.offsetLeft) / canvasEl.clientWidth * 2 - 1;
        this.mouse.y = -(event.clientY - domRect.top - canvasEl.offsetTop) / canvasEl.clientHeight * 2 + 1;
        // console.info('raw: x= ' + event.clientX + ' , y= ' + event.clientY);
        // console.info('normalized: x= ' + this.mouse.x + ' , y= ' + this.mouse.y);
        this.raycaster.setFromCamera(this.mouse, this.camera);
        if (this.hitArea === undefined) {
            return;
        }
        const intersects = this.raycaster.intersectObject(this.hitArea);
        if (intersects !== undefined && intersects.length > 0 && this.touch && intersects[0].uv !== undefined) {
            this.touch.addTouch(intersects[0].uv.x, intersects[0].uv.y);
        }
    }
    /**
     * Handle touch move envent
     * @param event mouse event
     */
    onTouchMove(event) {
        if (event.touches.length < 2) {
            this.showTouchGestureInfo = true;
            this.gestureInfoSubscription.unsubscribe();
            this.gestureInfoSubscription = this.gestureInfo$.subscribe({
                next: () => {
                    this.showTouchGestureInfo = false;
                    this.gestureInfoSubscription.unsubscribe();
                }
            });
            return;
        }
        event.preventDefault();
        // getBoundingClientRect retruns the distance in pixels of the top left corner of the element
        // to the top left corner of the viewport
        const domRect = this.canvasRef.nativeElement.getBoundingClientRect();
        // get the offset distance between the canvas, which contains the particles, to the outer container element
        const canvasEl = this.canvasRef.nativeElement.children[0];
        // Calculate the relative mouse position
        this.mouse.x = (event.touches[0].clientX - domRect.left - canvasEl.offsetLeft) / canvasEl.clientWidth * 2 - 1;
        this.mouse.y = -(event.touches[0].clientY - domRect.top - canvasEl.offsetTop) / canvasEl.clientHeight * 2 + 1;
        this.raycaster.setFromCamera(this.mouse, this.camera);
        const intersects = this.raycaster.intersectObject(this.hitArea);
        if (intersects !== undefined && intersects.length > 0 && this.touch && intersects[0].uv !== undefined) {
            this.touch.addTouch(intersects[0].uv.x, intersects[0].uv.y);
        }
    }
    resize() {
        if (this.height !== undefined) {
            this.camera.aspect = this.canvasRef.nativeElement.clientWidth / this.canvasRef.nativeElement.clientHeight;
            this.camera.updateProjectionMatrix();
            const fovHeight = 2 * Math.tan(this.camera.fov * Math.PI / 180 / 2) * this.camera.position.z;
            const scale = fovHeight / this.height;
            this.mesh.scale.set(scale, scale, 1);
            // this.hitArea.scale.set(scale, scale, 1);
            if (this.renderer !== undefined) {
                const width = this.imageWidth == null ? this.canvasRef.nativeElement.clientWidth :
                    this.distanceAsNumber(this.imageWidth, this.canvasRef.nativeElement.clientWidth);
                const height = this.imageHeight == null ? this.canvasRef.nativeElement.clientHeight :
                    this.distanceAsNumber(this.imageHeight, this.canvasRef.nativeElement.clientHeight);
                this.renderer.setSize(width, height);
            }
        }
    }
    distanceAsNumber(distance, parentDistance) {
        let returnVal = 0;
        if (distance.includes('px')) {
            returnVal = Number.parseInt(distance.replace('px', ''), 10);
        }
        else if (distance.includes('%')) {
            returnVal = Number.parseInt(distance.replace('%', ''), 10) / 100 * parentDistance;
        }
        else {
            returnVal = Number.parseInt(distance, 10);
        }
        return returnVal;
    }
}
ImageAsParticlesComponent.decorators = [
    { type: Component, args: [{
                selector: 'lib-image-as-particles',
                template: `
    <div #container class="threejs-container" [style.background-color]="backgroundColor"
                      [style.justify-content]="justifyContent"
                      [style.align-items]="alignItems"
                      (mousemove)="onMouseMove($event)" (touchmove)="onTouchMove($event)"></div>
    <div *ngIf="showTouchGestureInfo==true" class="touch-gesture-info" [@showHideGestureInformation]>
      <div>
        <span>Use two fingers for touch animation</span>
        <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" viewBox="0 0 24 24" fill="white" width="18px" height="18px">
          <g><rect fill="none" height="24" width="24" x="0"/></g><g><g><g>
            <path d="M9,11.24V7.5C9,6.12,10.12,5,11.5,5S14,6.12,14,7.5v3.74c1.21-0.81,2-2.18,2-3.74C16,5.01,13.99,3,11.5,3S7,5.01,7,7.5 C7,9.06,7.79,10.43,9,11.24z M18.84,15.87l-4.54-2.26c-0.17-0.07-0.35-0.11-0.54-0.11H13v-6C13,6.67,12.33,6,11.5,6 S10,6.67,10,7.5v10.74c-3.6-0.76-3.54-0.75-3.67-0.75c-0.31,0-0.59,0.13-0.79,0.33l-0.79,0.8l4.94,4.94 C9.96,23.83,10.34,24,10.75,24h6.79c0.75,0,1.33-0.55,1.44-1.28l0.75-5.27c0.01-0.07,0.02-0.14,0.02-0.2 C19.75,16.63,19.37,16.09,18.84,15.87z"/></g></g></g>
          </svg>
      </div>
    </div>
  `,
                animations: [
                    trigger('showHideGestureInformation', [
                        transition(':enter', [
                            style({ opacity: '0' }),
                            animate('300ms ease-in', style({ opacity: '1' }))
                        ]),
                        transition(':leave', [
                            style({ opacity: '1' }),
                            animate('300ms ease-in', style({ opacity: '0' }))
                        ])
                    ])
                ],
                styles: [`
    .threejs-container{
      position: relative;
      display: flex;
      justify-content: center;
      align-items: center;
      width: 100%;
      height: 100%;
      background-color: #222222;
    }

    .touch-gesture-info{
      position: absolute;
      width: 100%;
      display: flex;
      flex-direction: row;
      justify-content: center;
      top: 20px;
      color: white;
    }

    .touch-gesture-info div{
      background-color: rgba(0,0,0,0.3);
      display: flex;
      flex-direction: row;
      padding: 6px 10px 6px 10px;
      border-radius: 5px;
    }
  `]
            },] }
];
ImageAsParticlesComponent.ctorParameters = () => [
    { type: NgZone }
];
ImageAsParticlesComponent.propDecorators = {
    imageUrl: [{ type: Input }],
    backgroundColor: [{ type: Input }],
    imageWidth: [{ type: Input }],
    imageHeight: [{ type: Input }],
    horizontalAlignment: [{ type: Input }],
    verticalAlignment: [{ type: Input }],
    animationEnabled: [{ type: Input }],
    canvasRef: [{ type: ViewChild, args: ['container',] }],
    resize: [{ type: HostListener, args: ['window:resize',] }]
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW1hZ2UtYXMtcGFydGljbGVzLmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL25neC1hY3V3L3NyYy9saWIvaW1hZ2UtYXMtcGFydGljbGVzL2ltYWdlLWFzLXBhcnRpY2xlcy5jb21wb25lbnQudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQTZCLEtBQUssRUFBYSxZQUFZLEVBQUUsTUFBTSxFQUFXLE1BQU0sZUFBZSxDQUFDO0FBQ2pJLE9BQU8sRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFFLHdCQUF3QixFQUFFLHVCQUF1QixFQUFFLFlBQVksRUFBRSxJQUFJLEVBQUUsaUJBQWlCLEVBQUUsaUJBQWlCLEVBQUUsYUFBYSxFQUFFLFNBQVMsRUFBRSxTQUFTLEVBQUUsS0FBSyxFQUFFLGFBQWEsRUFBRSxPQUFPLEVBQUUsYUFBYSxFQUFFLE1BQU0sT0FBTyxDQUFDO0FBQy9PLE9BQU8sRUFBRSxRQUFRLEVBQUUsaUJBQWlCLEVBQUUsT0FBTyxFQUFFLE1BQU0sT0FBTyxDQUFDO0FBQzdELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSx5QkFBeUIsQ0FBQztBQUN2RCxPQUFPLEVBQUUsT0FBTyxFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDNUMsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBQ2hELE9BQU8sRUFBRSxRQUFRLEVBQWMsWUFBWSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzFELE9BQU8sRUFBRSxPQUFPLEVBQUUsS0FBSyxFQUFFLFVBQVUsRUFBRSxPQUFPLEVBQUUsTUFBTSxxQkFBcUIsQ0FBQztBQTZEMUUsTUFBTSxPQUFPLHlCQUF5QjtJQTZFcEMsWUFBb0IsTUFBYztRQUFkLFdBQU0sR0FBTixNQUFNLENBQVE7UUEzRWxDLG9CQUFvQjtRQUNaLGFBQVEsR0FBa0IsSUFBSSxhQUFhLENBQUMsRUFB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Ozs7Ozs7O0dBY1Q7Z0JBOEJELFVBQVUsRUFBRTtvQkFDVixPQUFPLENBQUMsNEJBQTRCLEVBQUU7d0JBQ3BDLFVBQVUsQ0FBQyxRQUFRLEVBQUU7NEJBQ25CLEtBQUssQ0FBQyxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsQ0FBQzs0QkFDdkIsT0FBTyxDQUFDLGVBQWUsRUFBRSxLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUMsQ0FBQzt5QkFDbEQsQ0FBQzt3QkFDRixVQUFVLENBQUMsUUFBUSxFQUFFOzRCQUNuQixLQUFLLENBQUMsRUFBRSxPQUFPLEVBQUUsR0FBRyxFQUFFLENBQUM7NEJBQ3ZCLE9BQU8sQ0FBQyxlQUFlLEVBQUUsS0FBSyxDQUFDLEVBQUUsT0FBTyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7eUJBQ2xELENBQUM7cUJBQ0gsQ0FBQztpQkFDSDt5QkF4Q1E7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0E0QlI7YUFhRjs7O1lBbkV5RixNQUFNOzs7dUJBNEY3RixLQUFLOzhCQVVMLEtBQUs7eUJBQ0wsS0FBSzswQkFDTCxLQUFLO2tDQUNMLEtBQUs7Z0NBa0JMLEtBQUs7K0JBa0JMLEtBQUs7d0JBRUwsU0FBUyxTQUFDLFdBQVc7cUJBdVNyQixZQUFZLFNBQUMsZUFBZSIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgVmlld0NoaWxkLCBFbGVtZW50UmVmLCBBZnRlclZpZXdJbml0LCBJbnB1dCwgT25EZXN0cm95LCBIb3N0TGlzdGVuZXIsIE5nWm9uZSwgRG9DaGVjayB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgQnVmZmVyQXR0cmlidXRlLCBDbG9jaywgSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlLCBJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSwgTGluZWFyRmlsdGVyLCBNZXNoLCBNZXNoQmFzaWNNYXRlcmlhbCwgUGVyc3BlY3RpdmVDYW1lcmEsIFBsYW5lR2VvbWV0cnksIFJheWNhc3RlciwgUkdCRm9ybWF0LCBTY2VuZSwgVGV4dHVyZUxvYWRlciwgVmVjdG9yMiwgV2ViR0xSZW5kZXJlciB9IGZyb20gJ3RocmVlJztcbmltcG9ydCB7IE9iamVjdDNELCBSYXdTaGFkZXJNYXRlcmlhbCwgVGV4dHVyZSB9IGZyb20gJ3RocmVlJztcbmltcG9ydCB7IFRvdWNoVGV4dHVyZSB9IGZyb20gJy4vc2NyaXB0cy90b3VjaC10ZXh0dXJlJztcbmltcG9ydCB7IFNoYWRlcnMgfSBmcm9tICcuL3NjcmlwdHMvc2hhZGVycyc7XG5pbXBvcnQgeyBSeGpzVHdlZW4gfSBmcm9tICcuLi90d2Vlbi9yeGpzLXR3ZWVuJztcbmltcG9ydCB7IGludGVydmFsLCBPYnNlcnZhYmxlLCBTdWJzY3JpcHRpb24gfSBmcm9tICdyeGpzJztcbmltcG9ydCB7IGFuaW1hdGUsIHN0eWxlLCB0cmFuc2l0aW9uLCB0cmlnZ2VyIH0gZnJvbSAnQGFuZ3VsYXIvYW5pbWF0aW9ucyc7XG5cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ2xpYi1pbWFnZS1hcy1wYXJ0aWNsZXMnLFxuICB0ZW1wbGF0ZTogYFxuICAgIDxkaXYgI2NvbnRhaW5lciBjbGFzcz1cInRocmVlanMtY29udGFpbmVyXCIgW3N0eWxlLmJhY2tncm91bmQtY29sb3JdPVwiYmFja2dyb3VuZENvbG9yXCJcbiAgICAgICAgICAgICAgICAgICAgICBbc3R5bGUuanVzdGlmeS1jb250ZW50XT1cImp1c3RpZnlDb250ZW50XCJcbiAgICAgICAgICAgICAgICAgICAgICBbc3R5bGUuYWxpZ24taXRlbXNdPVwiYWxpZ25JdGVtc1wiXG4gICAgICAgICAgICAgICAgICAgICAgKG1vdXNlbW92ZSk9XCJvbk1vdXNlTW92ZSgkZXZlbnQpXCIgKHRvdWNobW92ZSk9XCJvblRvdWNoTW92ZSgkZXZlbnQpXCI+PC9kaXY+XG4gICAgPGRpdiAqbmdJZj1cInNob3dUb3VjaEdlc3R1cmVJbmZvPT10cnVlXCIgY2xhc3M9XCJ0b3VjaC1nZXN0dXJlLWluZm9cIiBbQHNob3dIaWRlR2VzdHVyZUluZm9ybWF0aW9uXT5cbiAgICAgIDxkaXY+XG4gICAgICAgIDxzcGFuPlVzZSB0d28gZmluZ2VycyBmb3IgdG91Y2ggYW5pbWF0aW9uPC9zcGFuPlxuICAgICAgICA8c3ZnIHhtbG5zPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIiBlbmFibGUtYmFja2dyb3VuZD1cIm5ldyAwIDAgMjQgMjRcIiB2aWV3Qm94PVwiMCAwIDI0IDI0XCIgZmlsbD1cIndoaXRlXCIgd2lkdGg9XCIxOHB4XCIgaGVpZ2h0PVwiMThweFwiPlxuICAgICAgICAgIDxnPjxyZWN0IGZpbGw9XCJub25lXCIgaGVpZ2h0PVwiMjRcIiB3aWR0aD1cIjI0XCIgeD1cIjBcIi8+PC9nPjxnPjxnPjxnPlxuICAgICAgICAgICAgPHBhdGggZD1cIk05LDExLjI0VjcuNUM5LDYuMTIsMTAuMTIsNSwxMS41LDVTMTQsNi4xMiwxNCw3LjV2My43NGMxLjIxLTAuODEsMi0yLjE4LDItMy43NEMxNiw1LjAxLDEzLjk5LDMsMTEuNSwzUzcsNS4wMSw3LDcuNSBDNyw5LjA2LDcuNzksMTAuNDMsOSwxMS4yNHogTTE4Ljg0LDE1Ljg3bC00LjU0LTIuMjZjLTAuMTctMC4wNy0wLjM1LTAuMTEtMC41NC0wLjExSDEzdi02QzEzLDYuNjcsMTIuMzMsNiwxMS41LDYgUzEwLDYuNjcsMTAsNy41djEwLjc0Yy0zLjYtMC43Ni0zLjU0LTAuNzUtMy42Ny0wLjc1Yy0wLjMxLDAtMC41OSwwLjEzLTAuNzksMC4zM2wtMC43OSwwLjhsNC45NCw0Ljk0IEM5Ljk2LDIzLjgzLDEwLjM0LDI0LDEwLjc1LDI0aDYuNzljMC43NSwwLDEuMzMtMC41NSwxLjQ0LTEuMjhsMC43NS01LjI3YzAuMDEtMC4wNywwLjAyLTAuMTQsMC4wMi0wLjIgQzE5Ljc1LDE2LjYzLDE5LjM3LDE2LjA5LDE4Ljg0LDE1Ljg3elwiLz48L2c+PC9nPjwvZz5cbiAgICAgICAgICA8L3N2Zz5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICBgLFxuICBzdHlsZXM6IFtgXG4gICAgLnRocmVlanMtY29udGFpbmVye1xuICAgICAgcG9zaXRpb246IHJlbGF0aXZlO1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgIHdpZHRoOiAxMDAlO1xuICAgICAgaGVpZ2h0OiAxMDAlO1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogIzIyMjIyMjtcbiAgICB9XG5cbiAgICAudG91Y2gtZ2VzdHVyZS1pbmZve1xuICAgICAgcG9zaXRpb246IGFic29sdXRlO1xuICAgICAgd2lkdGg6IDEwMCU7XG4gICAgICBkaXNwbGF5OiBmbGV4O1xuICAgICAgZmxleC1kaXJlY3Rpb246IHJvdztcbiAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgdG9wOiAyMHB4O1xuICAgICAgY29sb3I6IHdoaXRlO1xuICAgIH1cblxuICAgIC50b3VjaC1nZXN0dXJlLWluZm8gZGl2e1xuICAgICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgwLDAsMCwwLjMpO1xuICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgIGZsZXgtZGlyZWN0aW9uOiByb3c7XG4gICAgICBwYWRkaW5nOiA2cHggMTBweCA2cHggMTBweDtcbiAgICAgIGJvcmRlci1yYWRpdXM6IDVweDtcbiAgICB9XG4gIGBdLFxuICBhbmltYXRpb25zOiBbXG4gICAgdHJpZ2dlcignc2hvd0hpZGVHZXN0dXJlSW5mb3JtYXRpb24nLCBbXG4gICAgICB0cmFuc2l0aW9uKCc6ZW50ZXInLCBbXG4gICAgICAgIHN0eWxlKHsgb3BhY2l0eTogJzAnIH0pLFxuICAgICAgICBhbmltYXRlKCczMDBtcyBlYXNlLWluJywgc3R5bGUoeyBvcGFjaXR5OiAnMScgfSkpXG4gICAgICBdKSxcbiAgICAgIHRyYW5zaXRpb24oJzpsZWF2ZScsIFtcbiAgICAgICAgc3R5bGUoeyBvcGFjaXR5OiAnMScgfSksXG4gICAgICAgIGFuaW1hdGUoJzMwMG1zIGVhc2UtaW4nLCBzdHlsZSh7IG9wYWNpdHk6ICcwJyB9KSlcbiAgICAgIF0pXG4gICAgXSlcbiAgXVxufSlcbmV4cG9ydCBjbGFzcyBJbWFnZUFzUGFydGljbGVzQ29tcG9uZW50IGltcGxlbWVudHMgQWZ0ZXJWaWV3SW5pdCwgT25EZXN0cm95IHtcblxuICAvLyBEZWNsYXJlIHZhcmlhYmxlc1xuICBwcml2YXRlIHJlbmRlcmVyOiBXZWJHTFJlbmRlcmVyID0gbmV3IFdlYkdMUmVuZGVyZXIoeyBhbnRpYWxpYXM6IHRydWUsIGFscGhhOiB0cnVlIH0pO1xuICBwcml2YXRlIHNjZW5lOiBTY2VuZSA9IG5ldyBTY2VuZSgpO1xuICBwcml2YXRlIGNhbWVyYSE6IFBlcnNwZWN0aXZlQ2FtZXJhO1xuICBwcml2YXRlIGNsb2NrOiBDbG9jayA9IG5ldyBDbG9jayh0cnVlKTtcbiAgcHJpdmF0ZSB0ZXh0dXJlOiBUZXh0dXJlID0gbmV3IFRleHR1cmUoKTtcbiAgcHJpdmF0ZSBtZXNoITogTWVzaDtcbiAgcHJpdmF0ZSBoaXRBcmVhITogTWVzaDtcbiAgcHJpdmF0ZSB3aWR0aCA9IDA7XG4gIHByaXZhdGUgaGVpZ2h0ID0gMDtcbiAgcHJpdmF0ZSB0b3VjaDogVG91Y2hUZXh0dXJlID0gbmV3IFRvdWNoVGV4dHVyZSgpO1xuICBwcml2YXRlIG1vdXNlOiBWZWN0b3IyID0gbmV3IFZlY3RvcjIoKTtcbiAgcHJpdmF0ZSByYXljYXN0ZXI6IFJheWNhc3RlciA9IG5ldyBSYXljYXN0ZXIoKTtcbiAgcHJpdmF0ZSBwSW1hZ2VVcmwgPSAnJztcbiAgcHJpdmF0ZSBwSW1hZ2VDaGFuZ2luZyA9IGZhbHNlO1xuICBwcml2YXRlIGdlc3R1cmVJbmZvJDogT2JzZXJ2YWJsZTxudW1iZXI+ID0gaW50ZXJ2YWwoMjAwMCk7XG4gIHByaXZhdGUgZ2VzdHVyZUluZm9TdWJzY3JpcHRpb246IFN1YnNjcmlwdGlvbiA9IG5ldyBTdWJzY3JpcHRpb24oKTtcbiAgc2hvd1RvdWNoR2VzdHVyZUluZm8gPSBmYWxzZTtcbiAganVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJztcbiAgYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuXG4gIC8vIElucHV0c1xuICBASW5wdXQoKVxuICBzZXQgaW1hZ2VVcmwoaW1hZ2VVcmw6IHN0cmluZykge1xuICAgIHRoaXMucEltYWdlVXJsID0gaW1hZ2VVcmw7XG4gICAgaWYgKHRoaXMucEltYWdlQ2hhbmdpbmcgPT09IHRydWUpIHsgcmV0dXJuOyB9XG4gICAgaWYgKHRoaXMubWVzaCAhPSBudWxsKSB7XG4gICAgICB0aGlzLnBJbWFnZUNoYW5naW5nID0gdHJ1ZTtcbiAgICAgIHRoaXMudHJpZ2dlckltYWdlQ2hhbmdlKCk7XG4gICAgfVxuICB9XG4gIGdldCBpbWFnZVVybCgpOiBzdHJpbmcgeyByZXR1cm4gdGhpcy5wSW1hZ2VVcmw7IH1cbiAgQElucHV0KCkgYmFja2dyb3VuZENvbG9yID0gJyMwMDAwMDAnO1xuICBASW5wdXQoKSBpbWFnZVdpZHRoID0gJzEwMCUnO1xuICBASW5wdXQoKSBpbWFnZUhlaWdodCA9ICcxMDAlJztcbiAgQElucHV0KClcbiAgc2V0IGhvcml6b250YWxBbGlnbm1lbnQoaG9yaXpvbnRhbEFsaWdubWVudDogc3RyaW5nKSB7XG4gICAgc3dpdGNoIChob3Jpem9udGFsQWxpZ25tZW50KSB7XG4gICAgICBjYXNlICdzdGFydCc6XG4gICAgICAgIHRoaXMuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1zdGFydCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgY2FzZSAnY2VudGVyJzpcbiAgICAgICAgdGhpcy5qdXN0aWZ5Q29udGVudCA9ICdjZW50ZXInO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2VuZCc6XG4gICAgICAgIHRoaXMuanVzdGlmeUNvbnRlbnQgPSAnZmxleC1lbmQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRoaXMuanVzdGlmeUNvbnRlbnQgPSAnY2VudGVyJztcbiAgICAgICAgYnJlYWs7XG4gICAgfVxuICB9XG4gIGdldCBob3Jpem9udGFsQWxpZ25tZW50KCk6IHN0cmluZyB7IHJldHVybiB0aGlzLmp1c3RpZnlDb250ZW50OyB9XG4gIEBJbnB1dCgpXG4gIHNldCB2ZXJ0aWNhbEFsaWdubWVudCh2ZXJ0aWNhbEFsaWdubWVudDogc3RyaW5nKSB7XG4gICAgc3dpdGNoICh2ZXJ0aWNhbEFsaWdubWVudCkge1xuICAgICAgY2FzZSAndG9wJzpcbiAgICAgICAgdGhpcy5hbGlnbkl0ZW1zID0gJ2ZsZXgtc3RhcnQnO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2NlbnRlcic6XG4gICAgICAgIHRoaXMuYWxpZ25JdGVtcyA9ICdjZW50ZXInO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ2JvdHRvbSc6XG4gICAgICAgIHRoaXMuYWxpZ25JdGVtcyA9ICdmbGV4LWVuZCc7XG4gICAgICAgIGJyZWFrO1xuICAgICAgZGVmYXVsdDpcbiAgICAgICAgdGhpcy5hbGlnbkl0ZW1zID0gJ2NlbnRlcic7XG4gICAgICAgIGJyZWFrO1xuICAgIH1cbiAgfVxuICBnZXQgdmVydGljYWxBbGlnbm1lbnQoKTogc3RyaW5nIHsgcmV0dXJuIHRoaXMuYWxpZ25JdGVtczsgfVxuICBASW5wdXQoKSBhbmltYXRpb25FbmFibGVkID0gdHJ1ZTtcblxuICBAVmlld0NoaWxkKCdjb250YWluZXInKSBjYW52YXNSZWYhOiBFbGVtZW50UmVmO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgbmdab25lOiBOZ1pvbmUpIHtcbiAgfVxuXG4gIG5nQWZ0ZXJWaWV3SW5pdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5wSW1hZ2VVcmwgPT09ICcnKSB7IHJldHVybjsgfVxuXG4gICAgY29uc3QgY2FudmFzV2lkdGggPSB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoO1xuICAgIGNvbnN0IGNhbnZhc0hlaWdodCA9IHRoaXMuY2FudmFzUmVmLm5hdGl2ZUVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICAgIC8vIFNldCBjYW1lcmFcbiAgICB0aGlzLmNhbWVyYSA9IG5ldyBQZXJzcGVjdGl2ZUNhbWVyYSg1MCwgY2FudmFzV2lkdGggLyBjYW52YXNIZWlnaHQsIDEsIDEwMDAwKTtcbiAgICB0aGlzLmNhbWVyYS5wb3NpdGlvbi56ID0gMzAwO1xuICAgIC8vIEluaXQgcGFydGljbGVzXG4gICAgdGhpcy5pbml0UGFydGljbGVzKHRoaXMucEltYWdlVXJsKTtcbiAgICAvLyBJbml0IHJlbmRlcmVyXG4gICAgdGhpcy5yZW5kZXJlci5zZXRTaXplKGNhbnZhc1dpZHRoIC0gMSwgY2FudmFzSGVpZ2h0KTtcbiAgICB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmFwcGVuZENoaWxkKHRoaXMucmVuZGVyZXIuZG9tRWxlbWVudCk7XG4gICAgLy8gU3RhcnQgYW5pbWF0aW9uXG4gICAgdGhpcy5hbmltYXRlKCk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLnNjZW5lLmNsZWFyKCk7XG4gICAgdGhpcy5yZW5kZXJlci5jbGVhcigpO1xuICAgIHRoaXMudGV4dHVyZS5kaXNwb3NlKCk7XG4gICAgdGhpcy5yZW5kZXJlci5kaXNwb3NlKCk7XG4gIH1cblxuICAvKipcbiAgICogQ3JlYXRlcyB0aGUgcGFydGljbGVzIGRlcGVuZGluZyBvbiB0aGUgaW1hZ2UgYW5kIGluaXRpYWxpemVzIHRoZSB0b3VjaCBjYW52YXNcbiAgICogQHBhcmFtIHVybCB1cmwgb2YgdGhlIGltYWdlXG4gICAqL1xuICBwcml2YXRlIGluaXRQYXJ0aWNsZXModXJsOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBjb25zdCBsb2FkZXIgPSBuZXcgVGV4dHVyZUxvYWRlcigpO1xuICAgIGxvYWRlci5sb2FkKHVybCwgKHRleHR1cmUpID0+IHtcbiAgICAgIHRoaXMudGV4dHVyZSA9IHRleHR1cmU7XG4gICAgICB0aGlzLnRleHR1cmUubWluRmlsdGVyID0gTGluZWFyRmlsdGVyO1xuICAgICAgdGhpcy50ZXh0dXJlLm1hZ0ZpbHRlciA9IExpbmVhckZpbHRlcjtcbiAgICAgIHRoaXMudGV4dHVyZS5mb3JtYXQgPSBSR0JGb3JtYXQ7XG5cbiAgICAgIHRoaXMud2lkdGggPSB0ZXh0dXJlLmltYWdlLndpZHRoO1xuICAgICAgdGhpcy5oZWlnaHQgPSB0ZXh0dXJlLmltYWdlLmhlaWdodDtcblxuICAgICAgdGhpcy5pbml0UG9pbnRzKHRydWUpO1xuICAgICAgdGhpcy5pbml0SGl0QXJlYSgpO1xuICAgICAgdGhpcy5pbml0VG91Y2goKTtcbiAgICAgIHRoaXMucmVzaXplKCk7XG4gICAgICB0aGlzLnNob3coKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgcG9pbnRzXG4gICAqIEBwYXJhbSBkaXNjYXJkIGRpc2NhcmQgcGl4ZWxzIGRhcmtlciB0aGFuIHRocmVzaG9sZCAjMjJcbiAgICovXG4gIHByaXZhdGUgaW5pdFBvaW50cyhkaXNjYXJkOiBib29sZWFuKTogdm9pZCB7XG4gICAgY29uc3QgbnVtUG9pbnRzOiBudW1iZXIgPSB0aGlzLndpZHRoICogdGhpcy5oZWlnaHQ7XG5cbiAgICBsZXQgbnVtVmlzaWJsZSA9IG51bVBvaW50cztcbiAgICBsZXQgdGhyZXNob2xkID0gMDtcbiAgICBsZXQgb3JpZ2luYWxDb2xvcnMgPSBuZXcgRmxvYXQzMkFycmF5KCk7XG5cbiAgICBpZiAoZGlzY2FyZCkge1xuICAgICAgLy8gZGlzY2FyZCBwaXhlbHMgZGFya2VyIHRoYW4gdGhyZXNob2xkICMyMlxuICAgICAgbnVtVmlzaWJsZSA9IDA7XG4gICAgICB0aHJlc2hvbGQgPSAzNDtcblxuICAgICAgY29uc3QgaW1nID0gdGhpcy50ZXh0dXJlLmltYWdlO1xuICAgICAgY29uc3QgY2FudmFzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnY2FudmFzJyk7XG4gICAgICBjb25zdCBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTtcblxuICAgICAgY2FudmFzLndpZHRoID0gdGhpcy53aWR0aDtcbiAgICAgIGNhbnZhcy5oZWlnaHQgPSB0aGlzLmhlaWdodDtcbiAgICAgIGlmIChjdHggIT0gbnVsbCkge1xuICAgICAgICBjdHguc2NhbGUoMSwgLTEpO1xuICAgICAgICBjdHguZHJhd0ltYWdlKGltZywgMCwgMCwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQgKiAtMSk7XG4gICAgICAgIGNvbnN0IGltZ0RhdGEgPSBjdHguZ2V0SW1hZ2VEYXRhKDAsIDAsIGNhbnZhcy53aWR0aCwgY2FudmFzLmhlaWdodCk7XG4gICAgICAgIG9yaWdpbmFsQ29sb3JzID0gRmxvYXQzMkFycmF5LmZyb20oaW1nRGF0YS5kYXRhKTtcblxuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG51bVBvaW50czsgaSsrKSB7XG4gICAgICAgICAgaWYgKG9yaWdpbmFsQ29sb3JzW2kgKiA0ICsgMF0gPiB0aHJlc2hvbGQpIHsgbnVtVmlzaWJsZSsrOyB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB1bmlmb3JtcyA9IHtcbiAgICAgIHVUaW1lOiB7IHZhbHVlOiAwIH0sXG4gICAgICB1UmFuZG9tOiB7IHZhbHVlOiAxLjAgfSxcbiAgICAgIHVEZXB0aDogeyB2YWx1ZTogMi4wIH0sXG4gICAgICB1U2l6ZTogeyB2YWx1ZTogMC4wIH0sXG4gICAgICB1VGV4dHVyZVNpemU6IHsgdmFsdWU6IG5ldyBWZWN0b3IyKHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KSB9LFxuICAgICAgdVRleHR1cmU6IHsgdmFsdWU6IHRoaXMudGV4dHVyZSB9LFxuICAgICAgdVRvdWNoOiB7IHZhbHVlOiBudWxsIH0sXG4gICAgfTtcblxuICAgIGNvbnN0IHNoYWRlcnMgPSBuZXcgU2hhZGVycygpO1xuICAgIGNvbnN0IG1hdGVyaWFsID0gbmV3IFJhd1NoYWRlck1hdGVyaWFsKHtcbiAgICAgIHVuaWZvcm1zLFxuICAgICAgdmVydGV4U2hhZGVyOiBzaGFkZXJzLnBhcnRpY2xlVmVydGV4LFxuICAgICAgZnJhZ21lbnRTaGFkZXI6IHNoYWRlcnMucGFydGljbGVGcmFnbWVudCxcbiAgICAgIGRlcHRoVGVzdDogZmFsc2UsXG4gICAgICB0cmFuc3BhcmVudDogdHJ1ZSxcbiAgICAgIC8vIGJsZW5kaW5nOiBUSFJFRS5BZGRpdGl2ZUJsZW5kaW5nXG4gICAgfSk7XG5cbiAgICBjb25zdCBnZW9tZXRyeSA9IG5ldyBJbnN0YW5jZWRCdWZmZXJHZW9tZXRyeSgpO1xuXG4gICAgLy8gcG9zaXRpb25zXG4gICAgY29uc3QgcG9zaXRpb25zID0gbmV3IEJ1ZmZlckF0dHJpYnV0ZShuZXcgRmxvYXQzMkFycmF5KDQgKiAzKSwgMyk7XG4gICAgcG9zaXRpb25zLnNldFhZWigwLCAtMC41LCAwLjUsIDAuMCk7XG4gICAgcG9zaXRpb25zLnNldFhZWigxLCAwLjUsIDAuNSwgMC4wKTtcbiAgICBwb3NpdGlvbnMuc2V0WFlaKDIsIC0wLjUsIC0wLjUsIDAuMCk7XG4gICAgcG9zaXRpb25zLnNldFhZWigzLCAwLjUsIC0wLjUsIDAuMCk7XG4gICAgZ2VvbWV0cnkuc2V0QXR0cmlidXRlKCdwb3NpdGlvbicsIHBvc2l0aW9ucyk7XG5cbiAgICAvLyB1dnNcbiAgICBjb25zdCB1dnMgPSBuZXcgQnVmZmVyQXR0cmlidXRlKG5ldyBGbG9hdDMyQXJyYXkoNCAqIDIpLCAyKTtcbiAgICB1dnMuc2V0WFkoMCwgMC4wLCAwLjApO1xuICAgIHV2cy5zZXRYWSgxLCAxLjAsIDAuMCk7XG4gICAgdXZzLnNldFhZKDIsIDAuMCwgMS4wKTtcbiAgICB1dnMuc2V0WFkoMywgMS4wLCAxLjApO1xuICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgndXYnLCB1dnMpO1xuXG4gICAgLy8gaW5kZXhcbiAgICBnZW9tZXRyeS5zZXRJbmRleChuZXcgQnVmZmVyQXR0cmlidXRlKG5ldyBVaW50MTZBcnJheShbMCwgMiwgMSwgMiwgMywgMV0pLCAxKSk7XG5cbiAgICBjb25zdCBpbmRpY2VzID0gbmV3IFVpbnQxNkFycmF5KG51bVZpc2libGUpO1xuICAgIGNvbnN0IG9mZnNldHMgPSBuZXcgRmxvYXQzMkFycmF5KG51bVZpc2libGUgKiAzKTtcbiAgICBjb25zdCBhbmdsZXMgPSBuZXcgRmxvYXQzMkFycmF5KG51bVZpc2libGUpO1xuXG4gICAgZm9yIChsZXQgaSA9IDAsIGogPSAwOyBpIDwgbnVtUG9pbnRzOyBpKyspIHtcbiAgICAgIGlmIChkaXNjYXJkICYmIG9yaWdpbmFsQ29sb3JzW2kgKiA0ICsgMF0gPD0gdGhyZXNob2xkKSB7IGNvbnRpbnVlOyB9XG5cbiAgICAgIG9mZnNldHNbaiAqIDMgKyAwXSA9IGkgJSB0aGlzLndpZHRoO1xuICAgICAgb2Zmc2V0c1tqICogMyArIDFdID0gTWF0aC5mbG9vcihpIC8gdGhpcy53aWR0aCk7XG5cbiAgICAgIGluZGljZXNbal0gPSBpO1xuXG4gICAgICBhbmdsZXNbal0gPSBNYXRoLnJhbmRvbSgpICogTWF0aC5QSTtcblxuICAgICAgaisrO1xuICAgIH1cblxuICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgncGluZGV4JywgbmV3IEluc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZShpbmRpY2VzLCAxLCBmYWxzZSkpO1xuICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgnb2Zmc2V0JywgbmV3IEluc3RhbmNlZEJ1ZmZlckF0dHJpYnV0ZShvZmZzZXRzLCAzLCBmYWxzZSkpO1xuICAgIGdlb21ldHJ5LnNldEF0dHJpYnV0ZSgnYW5nbGUnLCBuZXcgSW5zdGFuY2VkQnVmZmVyQXR0cmlidXRlKGFuZ2xlcywgMSwgZmFsc2UpKTtcblxuICAgIHRoaXMubWVzaCA9IG5ldyBNZXNoKGdlb21ldHJ5LCBtYXRlcmlhbCk7XG4gICAgY29uc3Qgb2JqZWN0M2QgPSBuZXcgT2JqZWN0M0QoKTtcbiAgICBvYmplY3QzZC5hZGQodGhpcy5tZXNoKTtcbiAgICB0aGlzLnNjZW5lLmFkZChvYmplY3QzZCk7XG4gIH1cblxuICAvKipcbiAgICogSW5pdGlhbGl6ZXMgdGhlIHRvdWNoIGFyZWFcbiAgICovXG4gIHByaXZhdGUgaW5pdFRvdWNoKCk6IHZvaWQge1xuICAgICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVUb3VjaC52YWx1ZSA9IHRoaXMudG91Y2gudGV4dHVyZTtcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplcyB0aGUgaGl0IGFyZWFcbiAgICovXG4gIHByaXZhdGUgaW5pdEhpdEFyZWEoKTogdm9pZCB7XG4gICAgY29uc3QgZ2VvbWV0cnkgPSBuZXcgUGxhbmVHZW9tZXRyeSh0aGlzLndpZHRoLCB0aGlzLmhlaWdodCwgMSwgMSk7XG4gICAgY29uc3QgbWF0ZXJpYWwgPSBuZXcgTWVzaEJhc2ljTWF0ZXJpYWwoeyBjb2xvcjogMHhGRkZGRkYsIHdpcmVmcmFtZTogdHJ1ZSwgZGVwdGhUZXN0OiBmYWxzZSB9KTtcbiAgICBtYXRlcmlhbC52aXNpYmxlID0gZmFsc2U7XG4gICAgdGhpcy5oaXRBcmVhID0gbmV3IE1lc2goZ2VvbWV0cnksIG1hdGVyaWFsKTtcbiAgICB0aGlzLm1lc2guYWRkKHRoaXMuaGl0QXJlYSk7XG4gIH1cblxuICAvKipcbiAgICogYW5pbWF0aW9uIGZvciBzaG93aW5nIHRoZSBwYXJ0aWNsZXNcbiAgICogQHBhcmFtIHRpbWUgdGltZSBvZiBhbmltYXRpb24gaW4gbXNcbiAgICovXG4gIHByaXZhdGUgc2hvdyh0aW1lOiBudW1iZXIgPSAxMDAwKTogdm9pZCB7XG4gICAgLy8gVHdlZW4gaW5cbiAgICB0aGlzLm5nWm9uZS5ydW5PdXRzaWRlQW5ndWxhcigoKSA9PiB7XG4gICAgICBSeGpzVHdlZW4uY3JlYXRlVHdlZW4oUnhqc1R3ZWVuLmVhc2VJbk91dFF1YWQsIFswLjUsIDAuMCwgNzAuMF0sIFsxLjUsIDIuMCwgNC4wXSwgdGltZSkuc3Vic2NyaWJlKHZhbCA9PiB7XG4gICAgICAgICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVTaXplLnZhbHVlID0gdmFsWzBdO1xuICAgICAgICAodGhpcy5tZXNoLm1hdGVyaWFsIGFzIFJhd1NoYWRlck1hdGVyaWFsKS51bmlmb3Jtcy51UmFuZG9tLnZhbHVlID0gdmFsWzFdO1xuICAgICAgICAodGhpcy5tZXNoLm1hdGVyaWFsIGFzIFJhd1NoYWRlck1hdGVyaWFsKS51bmlmb3Jtcy51RGVwdGgudmFsdWUgPSB2YWxbMl07XG4gICAgICB9LCAoKSA9PiB7IH0sICgpID0+IHtcbiAgICAgICAgdGhpcy5wSW1hZ2VDaGFuZ2luZyA9IGZhbHNlO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cblxuICAvKipcbiAgICogYW5pbWF0aW9uIGZvciB0d2VlbiBvdXQgdGhlIHBhcnRpY2xlcyBhbmQgZGVzdHJveSBldmVyeXRoaW5nXG4gICAqIEBwYXJhbSB0aW1lIHRpbWUgb2YgYW5pbWF0aW9uIGluIG1zXG4gICAqL1xuICBwcml2YXRlIHRyaWdnZXJJbWFnZUNoYW5nZSh0aW1lOiBudW1iZXIgPSAxMDAwKTogdm9pZCB7XG4gICAgY29uc3QgdVNpemVTdGFydCA9ICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVTaXplLnZhbHVlO1xuICAgIGNvbnN0IHVSYW5kb21TdGFydCA9ICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVSYW5kb20udmFsdWU7XG4gICAgY29uc3QgdURlcHRoID0gKHRoaXMubWVzaC5tYXRlcmlhbCBhcyBSYXdTaGFkZXJNYXRlcmlhbCkudW5pZm9ybXMudURlcHRoLnZhbHVlO1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIC8vIFR3ZWVuIG91dFxuICAgICAgUnhqc1R3ZWVuLmNyZWF0ZVR3ZWVuKFJ4anNUd2Vlbi5lYXNlSW5PdXRRdWFkLCBbdVNpemVTdGFydCwgdVJhbmRvbVN0YXJ0LCB1RGVwdGhdLCBbMC4wLCA1LjAsIC0yMC4wXSwgdGltZSkuc3Vic2NyaWJlKHZhbCA9PiB7XG4gICAgICAgICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVTaXplLnZhbHVlID0gdmFsWzBdO1xuICAgICAgICAodGhpcy5tZXNoLm1hdGVyaWFsIGFzIFJhd1NoYWRlck1hdGVyaWFsKS51bmlmb3Jtcy51UmFuZG9tLnZhbHVlID0gdmFsWzFdO1xuICAgICAgICAodGhpcy5tZXNoLm1hdGVyaWFsIGFzIFJhd1NoYWRlck1hdGVyaWFsKS51bmlmb3Jtcy51RGVwdGgudmFsdWUgPSB2YWxbMl07XG4gICAgICB9LCAoKSA9PiB7IH0sICgpID0+IHtcbiAgICAgICAgaWYgKHRoaXMubWVzaCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKHRoaXMubWVzaC5wYXJlbnQgIT0gbnVsbCkgeyB0aGlzLm1lc2gucGFyZW50LnJlbW92ZSh0aGlzLm1lc2gpOyB9XG4gICAgICAgICAgdGhpcy5tZXNoLmdlb21ldHJ5LmRpc3Bvc2UoKTtcbiAgICAgICAgICAodGhpcy5tZXNoLm1hdGVyaWFsIGFzIFJhd1NoYWRlck1hdGVyaWFsKS5kaXNwb3NlKCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodGhpcy5oaXRBcmVhICE9IG51bGwpIHtcbiAgICAgICAgICBpZiAodGhpcy5oaXRBcmVhLnBhcmVudCAhPSBudWxsKSB7IHRoaXMuaGl0QXJlYS5wYXJlbnQucmVtb3ZlKHRoaXMuaGl0QXJlYSk7IH1cbiAgICAgICAgICB0aGlzLmhpdEFyZWEuZ2VvbWV0cnkuZGlzcG9zZSgpO1xuICAgICAgICAgICh0aGlzLmhpdEFyZWEubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLmRpc3Bvc2UoKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmluaXRQYXJ0aWNsZXModGhpcy5wSW1hZ2VVcmwpO1xuICAgICAgICB0aGlzLnBJbWFnZUNoYW5naW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNZXRob2QgZm9yIHRyaWdnZXJpbmcgdGhlIGFuaW1hdGlvblxuICAgKi9cbiAgcHJpdmF0ZSBhbmltYXRlKCk6IHZvaWQge1xuICAgIHRoaXMubmdab25lLnJ1bk91dHNpZGVBbmd1bGFyKCgpID0+IHtcbiAgICAgIHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gdGhpcy5hbmltYXRlKCkpO1xuICAgICAgaWYgKHRoaXMuYW5pbWF0aW9uRW5hYmxlZCA9PT0gdHJ1ZSkge1xuICAgICAgICBjb25zdCBkZWx0YSA9IHRoaXMuY2xvY2suZ2V0RGVsdGEoKTtcbiAgICAgICAgaWYgKHRoaXMubWVzaCAhPSBudWxsKSB7XG4gICAgICAgICAgaWYgKHRoaXMudG91Y2gpIHsgdGhpcy50b3VjaC51cGRhdGUoKTsgfVxuICAgICAgICAgICh0aGlzLm1lc2gubWF0ZXJpYWwgYXMgUmF3U2hhZGVyTWF0ZXJpYWwpLnVuaWZvcm1zLnVUaW1lLnZhbHVlICs9IGRlbHRhO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMucmVuZGVyZXIucmVuZGVyKHRoaXMuc2NlbmUsIHRoaXMuY2FtZXJhKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBIYW5kbGUgbW91c2UgbW92ZSBldmVudFxuICAgKiBAcGFyYW0gZXZlbnQgbW91c2UgZXZlbnRcbiAgICovXG4gIG9uTW91c2VNb3ZlKGV2ZW50OiBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgLy8gZ2V0Qm91bmRpbmdDbGllbnRSZWN0IHJldHJ1bnMgdGhlIGRpc3RhbmNlIGluIHBpeGVscyBvZiB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSBlbGVtZW50XG4gICAgLy8gdG8gdGhlIHRvcCBsZWZ0IGNvcm5lciBvZiB0aGUgdmlld3BvcnRcbiAgICBjb25zdCBkb21SZWN0ID0gKHRoaXMuY2FudmFzUmVmLm5hdGl2ZUVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIC8vIGdldCB0aGUgb2Zmc2V0IGRpc3RhbmNlIGJldHdlZW4gdGhlIGNhbnZhcywgd2hpY2ggY29udGFpbnMgdGhlIHBhcnRpY2xlcywgdG8gdGhlIG91dGVyIGNvbnRhaW5lciBlbGVtZW50XG4gICAgY29uc3QgY2FudmFzRWw6IEhUTUxFbGVtZW50ID0gKHRoaXMuY2FudmFzUmVmLm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW5bMF0gYXMgSFRNTEVsZW1lbnQpO1xuICAgIC8vIENhbGN1bGF0ZSB0aGUgcmVsYXRpdmUgbW91c2UgcG9zaXRpb25cbiAgICB0aGlzLm1vdXNlLnggPSAoZXZlbnQuY2xpZW50WCAtIGRvbVJlY3QubGVmdCAtIGNhbnZhc0VsLm9mZnNldExlZnQpIC8gY2FudmFzRWwuY2xpZW50V2lkdGggKiAyIC0gMTtcbiAgICB0aGlzLm1vdXNlLnkgPSAtIChldmVudC5jbGllbnRZIC0gZG9tUmVjdC50b3AgLSBjYW52YXNFbC5vZmZzZXRUb3ApIC8gY2FudmFzRWwuY2xpZW50SGVpZ2h0ICogMiArIDE7XG4gICAgLy8gY29uc29sZS5pbmZvKCdyYXc6IHg9ICcgKyBldmVudC5jbGllbnRYICsgJyAsIHk9ICcgKyBldmVudC5jbGllbnRZKTtcbiAgICAvLyBjb25zb2xlLmluZm8oJ25vcm1hbGl6ZWQ6IHg9ICcgKyB0aGlzLm1vdXNlLnggKyAnICwgeT0gJyArIHRoaXMubW91c2UueSk7XG4gICAgdGhpcy5yYXljYXN0ZXIuc2V0RnJvbUNhbWVyYSh0aGlzLm1vdXNlLCB0aGlzLmNhbWVyYSk7XG5cbiAgICBpZiAodGhpcy5oaXRBcmVhID09PSB1bmRlZmluZWQpIHsgcmV0dXJuOyB9XG4gICAgY29uc3QgaW50ZXJzZWN0cyA9IHRoaXMucmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdCh0aGlzLmhpdEFyZWEpO1xuICAgIGlmIChpbnRlcnNlY3RzICE9PSB1bmRlZmluZWQgJiYgaW50ZXJzZWN0cy5sZW5ndGggPiAwICYmIHRoaXMudG91Y2ggJiYgaW50ZXJzZWN0c1swXS51diAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnRvdWNoLmFkZFRvdWNoKGludGVyc2VjdHNbMF0udXYueCwgaW50ZXJzZWN0c1swXS51di55KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogSGFuZGxlIHRvdWNoIG1vdmUgZW52ZW50XG4gICAqIEBwYXJhbSBldmVudCBtb3VzZSBldmVudFxuICAgKi9cbiAgb25Ub3VjaE1vdmUoZXZlbnQ6IFRvdWNoRXZlbnQpOiB2b2lkIHtcbiAgICBpZiAoZXZlbnQudG91Y2hlcy5sZW5ndGggPCAyKSB7XG4gICAgICB0aGlzLnNob3dUb3VjaEdlc3R1cmVJbmZvID0gdHJ1ZTtcbiAgICAgIHRoaXMuZ2VzdHVyZUluZm9TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgIHRoaXMuZ2VzdHVyZUluZm9TdWJzY3JpcHRpb24gPSB0aGlzLmdlc3R1cmVJbmZvJC5zdWJzY3JpYmUoe1xuICAgICAgICBuZXh0OiAoKSA9PiB7XG4gICAgICAgICAgdGhpcy5zaG93VG91Y2hHZXN0dXJlSW5mbyA9IGZhbHNlO1xuICAgICAgICAgIHRoaXMuZ2VzdHVyZUluZm9TdWJzY3JpcHRpb24udW5zdWJzY3JpYmUoKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy8gZ2V0Qm91bmRpbmdDbGllbnRSZWN0IHJldHJ1bnMgdGhlIGRpc3RhbmNlIGluIHBpeGVscyBvZiB0aGUgdG9wIGxlZnQgY29ybmVyIG9mIHRoZSBlbGVtZW50XG4gICAgLy8gdG8gdGhlIHRvcCBsZWZ0IGNvcm5lciBvZiB0aGUgdmlld3BvcnRcbiAgICBjb25zdCBkb21SZWN0ID0gKHRoaXMuY2FudmFzUmVmLm5hdGl2ZUVsZW1lbnQgYXMgSFRNTEVsZW1lbnQpLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICAgIC8vIGdldCB0aGUgb2Zmc2V0IGRpc3RhbmNlIGJldHdlZW4gdGhlIGNhbnZhcywgd2hpY2ggY29udGFpbnMgdGhlIHBhcnRpY2xlcywgdG8gdGhlIG91dGVyIGNvbnRhaW5lciBlbGVtZW50XG4gICAgY29uc3QgY2FudmFzRWw6IEhUTUxFbGVtZW50ID0gKHRoaXMuY2FudmFzUmVmLm5hdGl2ZUVsZW1lbnQuY2hpbGRyZW5bMF0gYXMgSFRNTEVsZW1lbnQpO1xuICAgIC8vIENhbGN1bGF0ZSB0aGUgcmVsYXRpdmUgbW91c2UgcG9zaXRpb25cbiAgICB0aGlzLm1vdXNlLnggPSAoZXZlbnQudG91Y2hlc1swXS5jbGllbnRYIC0gZG9tUmVjdC5sZWZ0IC0gY2FudmFzRWwub2Zmc2V0TGVmdCkgLyBjYW52YXNFbC5jbGllbnRXaWR0aCAqIDIgLSAxO1xuICAgIHRoaXMubW91c2UueSA9IC0gKGV2ZW50LnRvdWNoZXNbMF0uY2xpZW50WSAtIGRvbVJlY3QudG9wIC0gY2FudmFzRWwub2Zmc2V0VG9wKSAvIGNhbnZhc0VsLmNsaWVudEhlaWdodCAqIDIgKyAxO1xuICAgIHRoaXMucmF5Y2FzdGVyLnNldEZyb21DYW1lcmEodGhpcy5tb3VzZSwgdGhpcy5jYW1lcmEpO1xuXG4gICAgY29uc3QgaW50ZXJzZWN0cyA9IHRoaXMucmF5Y2FzdGVyLmludGVyc2VjdE9iamVjdCh0aGlzLmhpdEFyZWEpO1xuICAgIGlmIChpbnRlcnNlY3RzICE9PSB1bmRlZmluZWQgJiYgaW50ZXJzZWN0cy5sZW5ndGggPiAwICYmIHRoaXMudG91Y2ggJiYgaW50ZXJzZWN0c1swXS51diAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLnRvdWNoLmFkZFRvdWNoKGludGVyc2VjdHNbMF0udXYueCwgaW50ZXJzZWN0c1swXS51di55KTtcbiAgICB9XG4gIH1cblxuICBASG9zdExpc3RlbmVyKCd3aW5kb3c6cmVzaXplJykgcmVzaXplKCk6IHZvaWQge1xuICAgIGlmICh0aGlzLmhlaWdodCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICB0aGlzLmNhbWVyYS5hc3BlY3QgPSB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoIC8gdGhpcy5jYW52YXNSZWYubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gICAgICB0aGlzLmNhbWVyYS51cGRhdGVQcm9qZWN0aW9uTWF0cml4KCk7XG4gICAgICBjb25zdCBmb3ZIZWlnaHQgPSAyICogTWF0aC50YW4odGhpcy5jYW1lcmEuZm92ICogTWF0aC5QSSAvIDE4MCAvIDIpICogdGhpcy5jYW1lcmEucG9zaXRpb24uejtcbiAgICAgIGNvbnN0IHNjYWxlID0gZm92SGVpZ2h0IC8gdGhpcy5oZWlnaHQ7XG4gICAgICB0aGlzLm1lc2guc2NhbGUuc2V0KHNjYWxlLCBzY2FsZSwgMSk7XG4gICAgICAvLyB0aGlzLmhpdEFyZWEuc2NhbGUuc2V0KHNjYWxlLCBzY2FsZSwgMSk7XG4gICAgICBpZiAodGhpcy5yZW5kZXJlciAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IHdpZHRoID0gdGhpcy5pbWFnZVdpZHRoID09IG51bGwgPyB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoIDpcbiAgICAgICAgICB0aGlzLmRpc3RhbmNlQXNOdW1iZXIodGhpcy5pbWFnZVdpZHRoLCB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmNsaWVudFdpZHRoKTtcbiAgICAgICAgY29uc3QgaGVpZ2h0ID0gdGhpcy5pbWFnZUhlaWdodCA9PSBudWxsID8gdGhpcy5jYW52YXNSZWYubmF0aXZlRWxlbWVudC5jbGllbnRIZWlnaHQgOlxuICAgICAgICAgIHRoaXMuZGlzdGFuY2VBc051bWJlcih0aGlzLmltYWdlSGVpZ2h0LCB0aGlzLmNhbnZhc1JlZi5uYXRpdmVFbGVtZW50LmNsaWVudEhlaWdodCk7XG4gICAgICAgIHRoaXMucmVuZGVyZXIuc2V0U2l6ZSh3aWR0aCwgaGVpZ2h0KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGRpc3RhbmNlQXNOdW1iZXIoZGlzdGFuY2U6IHN0cmluZywgcGFyZW50RGlzdGFuY2U6IG51bWJlcik6IG51bWJlciB7XG4gICAgbGV0IHJldHVyblZhbCA9IDA7XG4gICAgaWYgKGRpc3RhbmNlLmluY2x1ZGVzKCdweCcpKSB7XG4gICAgICByZXR1cm5WYWwgPSBOdW1iZXIucGFyc2VJbnQoZGlzdGFuY2UucmVwbGFjZSgncHgnLCAnJyksIDEwKTtcbiAgICB9IGVsc2UgaWYgKGRpc3RhbmNlLmluY2x1ZGVzKCclJykpIHtcbiAgICAgIHJldHVyblZhbCA9IE51bWJlci5wYXJzZUludChkaXN0YW5jZS5yZXBsYWNlKCclJywgJycpLCAxMCkgLyAxMDAgKiBwYXJlbnREaXN0YW5jZTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuVmFsID0gTnVtYmVyLnBhcnNlSW50KGRpc3RhbmNlLCAxMCk7XG4gICAgfVxuICAgIHJldHVybiByZXR1cm5WYWw7XG4gIH1cbn1cbiJdfQ==