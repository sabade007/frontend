{"version":3,"file":"taiga-ui-i18n-switch.js","sources":["ng://@taiga-ui/i18n/switch/utils.ts","ng://@taiga-ui/i18n/switch/language-switcher.service.ts","ng://@taiga-ui/i18n/switch/language-switcher.providers.ts","ng://@taiga-ui/i18n/switch/taiga-ui-i18n-switch.ts"],"sourcesContent":["import type {\n    TuiLanguage,\n    TuiLanguageLoader,\n    TuiLanguageName,\n} from '@taiga-ui/i18n/interfaces';\nimport {from, Observable, of} from 'rxjs';\nimport {map} from 'rxjs/operators';\n\nexport function tuiAsyncLoadLanguage(\n    language: TuiLanguageName | null,\n    loader: TuiLanguageLoader | null,\n    fallback: TuiLanguage,\n): Observable<TuiLanguage> {\n    return language && loader ? tuiLoadLanguage(language, loader) : of(fallback);\n}\n\nexport function tuiLoadLanguage(\n    language: TuiLanguageName,\n    loader: TuiLanguageLoader,\n): Observable<TuiLanguage> {\n    return from(normalizeCommonJSImport(loader(language))).pipe(\n        map((module: any) => module?.[`TUI_${language.toUpperCase()}_LANGUAGE`]),\n    );\n}\n\n// CommonJS `module.exports` is wrapped as `default` in ESModule.\nasync function normalizeCommonJSImport<T>(importPromise: Promise<T>): Promise<T> {\n    return importPromise.then((m: any) => m.default || m);\n}\n","import {Inject, Injectable, Optional} from '@angular/core';\nimport {LOCAL_STORAGE} from '@ng-web-apis/common';\nimport {\n    TuiLanguage,\n    TuiLanguageLoader,\n    TuiLanguageName,\n    TuiLanguageStorage,\n} from '@taiga-ui/i18n/interfaces';\nimport {TUI_LANGUAGE_LOADER, TUI_LANGUAGE_STORAGE_KEY} from '@taiga-ui/i18n/tokens';\nimport {TUI_DEFAULT_LANGUAGE} from '@taiga-ui/i18n/tools';\nimport {BehaviorSubject, Observable, of} from 'rxjs';\n\nimport {tuiAsyncLoadLanguage} from './utils';\n\n// @dynamic\n@Injectable({providedIn: `root`})\nexport class TuiLanguageSwitcher extends BehaviorSubject<Observable<TuiLanguage>> {\n    constructor(\n        @Inject(TUI_DEFAULT_LANGUAGE)\n        private readonly fallback: TuiLanguage,\n        @Inject(TUI_LANGUAGE_STORAGE_KEY)\n        private readonly key: string,\n        @Inject(LOCAL_STORAGE)\n        private readonly storage: TuiLanguageStorage,\n        @Optional()\n        @Inject(TUI_LANGUAGE_LOADER)\n        private readonly loader: TuiLanguageLoader | null,\n    ) {\n        super(tuiAsyncLoadLanguage(storage.getItem(key), loader, fallback));\n    }\n\n    get language(): TuiLanguageName {\n        return this.storage.getItem(this.key) || this.fallback.name;\n    }\n\n    setLanguage(language: TuiLanguageName): void {\n        this.storage.setItem(this.key, language);\n\n        this.next(tuiAsyncLoadLanguage(language, this.loader, this.fallback));\n    }\n\n    clear(): void {\n        this.storage.removeItem(this.key);\n\n        this.next(of(this.fallback));\n    }\n}\n","import type {Provider} from '@angular/core';\nimport {TuiLanguageLoader} from '@taiga-ui/i18n/interfaces';\nimport {TUI_LANGUAGE_LOADER} from '@taiga-ui/i18n/tokens';\nimport {TUI_LANGUAGE} from '@taiga-ui/i18n/tools';\n\nimport {TuiLanguageSwitcher} from './language-switcher.service';\n\nexport function tuiLanguageSwitcher(loader: TuiLanguageLoader): Provider[] {\n    return [\n        {\n            provide: TUI_LANGUAGE_LOADER,\n            useFactory: () => loader,\n        },\n        {\n            provide: TUI_LANGUAGE,\n            useExisting: TuiLanguageSwitcher,\n        },\n    ];\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;;SAQgB,oBAAoB,CAChC,QAAgC,EAChC,MAAgC,EAChC,QAAqB;IAErB,OAAO,QAAQ,IAAI,MAAM,GAAG,eAAe,CAAC,QAAQ,EAAE,MAAM,CAAC,GAAG,EAAE,CAAC,QAAQ,CAAC,CAAC;AACjF,CAAC;SAEe,eAAe,CAC3B,QAAyB,EACzB,MAAyB;IAEzB,OAAO,IAAI,CAAC,uBAAuB,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,IAAI,CACvD,GAAG,CAAC,UAAC,MAAW,WAAK,MAAM,aAAN,MAAM,uBAAN,MAAM,CAAG,SAAO,QAAQ,CAAC,WAAW,EAAE,cAAW,IAAC,CAAC,CAC3E,CAAC;AACN,CAAC;AAED;AACA,SAAe,uBAAuB,CAAI,aAAyB;;;YAC/D,sBAAO,aAAa,CAAC,IAAI,CAAC,UAAC,CAAM,IAAK,OAAA,CAAC,CAAC,OAAO,IAAI,CAAC,GAAA,CAAC,EAAC;;;;;ACb1D;;IAEyC,uCAAwC;IAC7E,6BAEqB,QAAqB,EAErB,GAAW,EAEX,OAA2B,EAG3B,MAAgC;QATrD,YAWI,kBAAM,oBAAoB,CAAC,OAAO,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE,MAAM,EAAE,QAAQ,CAAC,CAAC,SACtE;QAVoB,cAAQ,GAAR,QAAQ,CAAa;QAErB,SAAG,GAAH,GAAG,CAAQ;QAEX,aAAO,GAAP,OAAO,CAAoB;QAG3B,YAAM,GAAN,MAAM,CAA0B;;KAGpD;IAED,sBAAI,yCAAQ;aAAZ;YACI,OAAO,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;SAC/D;;;OAAA;IAED,yCAAW,GAAX,UAAY,QAAyB;QACjC,IAAI,CAAC,OAAO,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE,QAAQ,CAAC,CAAC;QAEzC,IAAI,CAAC,IAAI,CAAC,oBAAoB,CAAC,QAAQ,EAAE,IAAI,CAAC,MAAM,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;KACzE;IAED,mCAAK,GAAL;QACI,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QAElC,IAAI,CAAC,IAAI,CAAC,EAAE,CAAC,IAAI,CAAC,QAAQ,CAAC,CAAC,CAAC;KAChC;;gDA3BI,MAAM,SAAC,oBAAoB;6CAE3B,MAAM,SAAC,wBAAwB;gDAE/B,MAAM,SAAC,aAAa;gDAEpB,QAAQ,YACR,MAAM,SAAC,mBAAmB;;;IATtB,mBAAmB;QAD/B,UAAU,CAAC,EAAC,UAAU,EAAE,MAAM,EAAC,CAAC;QAGxB,WAAA,MAAM,CAAC,oBAAoB,CAAC,CAAA;QAE5B,WAAA,MAAM,CAAC,wBAAwB,CAAC,CAAA;QAEhC,WAAA,MAAM,CAAC,aAAa,CAAC,CAAA;QAErB,WAAA,QAAQ,EAAE,CAAA;QACV,WAAA,MAAM,CAAC,mBAAmB,CAAC,CAAA;OATvB,mBAAmB,CA8B/B;8BA9CD;CA8CC,CA9BwC,eAAe;;SCTxC,mBAAmB,CAAC,MAAyB;IACzD,OAAO;QACH;YACI,OAAO,EAAE,mBAAmB;YAC5B,UAAU,EAAE,cAAM,OAAA,MAAM,GAAA;SAC3B;QACD;YACI,OAAO,EAAE,YAAY;YACrB,WAAW,EAAE,mBAAmB;SACnC;KACJ,CAAC;AACN;;AClBA;;;;;;"}