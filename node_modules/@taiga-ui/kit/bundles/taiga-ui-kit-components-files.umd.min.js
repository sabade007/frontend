!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/platform-browser"),require("@taiga-ui/cdk"),require("@taiga-ui/kit/tokens"),require("@taiga-ui/kit/utils/files"),require("rxjs"),require("rxjs/operators"),require("@angular/common"),require("@taiga-ui/core"),require("@tinkoff/ng-polymorpheus")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/files",["exports","@angular/core","@angular/platform-browser","@taiga-ui/cdk","@taiga-ui/kit/tokens","@taiga-ui/kit/utils/files","rxjs","rxjs/operators","@angular/common","@taiga-ui/core","@tinkoff/ng-polymorpheus"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].kit=e["taiga-ui"].kit||{},e["taiga-ui"].kit.components=e["taiga-ui"].kit.components||{},e["taiga-ui"].kit.components.files={}),e.ng.core,e.ng.platformBrowser,e.cdk,e["taiga-ui"].kit.tokens,e["taiga-ui"].kit.utils.files,e.rxjs,e.rxjs.operators,e.ng.common,e.core$1,e.ngPolymorpheus)}(this,(function(e,t,n,i,o,r,a,s,l,u,c){"use strict";function p(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function f(e,t){return function(n,i){t(n,i,e)}}Object.create;Object.create;var d=function(){function e(e,n,i,o){this.isMobile=e,this.sanitizer=n,this.fileTexts$=i,this.units$=o,this.file={name:""},this.state="normal",this.size="m",this.showSize=!0,this.leftContent="",this.removed=new t.EventEmitter,this.focused=!1}return Object.defineProperty(e.prototype,"preview",{get:function(){return this.isBig?this.createPreview(this.file,this.sanitizer):""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isBig",{get:function(){return"l"===this.size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return"loading"===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isError",{get:function(){return"error"===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isDeleted",{get:function(){return"deleted"===this.state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowDelete",{get:function(){return i.tuiIsObserved(this.removed)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){if("normal"===this.state&&this.isBig)return"tuiIconDefaultDocLarge";switch(this.state){case"deleted":return"tuiIconTrashLarge";case"error":return"tuiIconAlertCircleLarge";default:return"tuiIconCheckCircleLarge"}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"src",{get:function(){return this.file.src||""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"name",{get:function(){return this.getName(this.file)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this.getType(this.file)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content$",{get:function(){return this.calculateContent$(this.state,this.file,this.fileTexts$)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"fileSize$",{get:function(){return this.calculateFileSize$(this.file,this.units$)},enumerable:!0,configurable:!0}),e.prototype.onRemoveClick=function(){this.removed.emit()},e.prototype.onFocusVisible=function(e){this.focused=e},e.prototype.calculateContent$=function(e,t,n){return"error"!==e||t.content?a.of(this.file.content||""):n.pipe(s.map((function(e){return e.loadingError})))},e.prototype.calculateFileSize$=function(e,t){return t.pipe(s.map((function(t){return r.formatSize(t,e.size)})))},e.prototype.createPreview=function(e,t){return e.src?e.src:e instanceof File&&e.type&&e.type.startsWith("image/")?t.bypassSecurityTrustUrl(URL.createObjectURL(e)):""},e.prototype.getName=function(e){return e.name.split(".").slice(0,-1).join(".")},e.prototype.getType=function(e){return"."+e.name.split(".").pop()||""},e.ctorParameters=function(){return[{type:Boolean,decorators:[{type:t.Inject,args:[i.TUI_IS_MOBILE]}]},{type:n.DomSanitizer,decorators:[{type:t.Inject,args:[n.DomSanitizer]}]},{type:a.Observable,decorators:[{type:t.Inject,args:[o.TUI_FILE_TEXTS]}]},{type:a.Observable,decorators:[{type:t.Inject,args:[o.TUI_DIGITAL_INFORMATION_UNITS]}]}]},p([t.Input(),i.tuiDefaultProp()],e.prototype,"file",void 0),p([t.Input(),i.tuiDefaultProp()],e.prototype,"state",void 0),p([t.Input(),i.tuiDefaultProp()],e.prototype,"size",void 0),p([t.Input(),i.tuiDefaultProp()],e.prototype,"showSize",void 0),p([t.Input(),i.tuiDefaultProp()],e.prototype,"leftContent",void 0),p([t.Output()],e.prototype,"removed",void 0),p([t.HostBinding("class._focused")],e.prototype,"focused",void 0),p([t.HostBinding("class._link")],e.prototype,"src",null),p([i.tuiPure],e.prototype,"calculateContent$",null),p([i.tuiPure],e.prototype,"calculateFileSize$",null),p([i.tuiPure],e.prototype,"createPreview",null),p([i.tuiPure],e.prototype,"getName",null),p([i.tuiPure],e.prototype,"getType",null),e=p([t.Component({selector:"tui-file",changeDetection:t.ChangeDetectionStrategy.OnPush,template:'<ng-container\n    *ngIf="!src; else withLink"\n    [ngTemplateOutlet]="fileInfoTemplate"\n></ng-container>\n\n<ng-template #withLink>\n    <a\n        rel="noreferrer noopener"\n        target="_blank"\n        class="t-link"\n        [href]="src"\n        (tuiFocusVisibleChange)="onFocusVisible($event)"\n    >\n        <ng-container [ngTemplateOutlet]="fileInfoTemplate"></ng-container>\n    </a>\n</ng-template>\n\n<ng-template #fileInfoTemplate>\n    <div\n        polymorpheus-outlet\n        class="t-preview"\n        [class.t-preview_big]="isBig"\n        [content]="leftContent || defaultLeftContent"\n    ></div>\n    <div class="t-wrapper">\n        <div class="t-text">\n            <div\n                automation-id="tui-file__name"\n                class="t-name"\n            >\n                {{ name }}\n            </div>\n            <div\n                automation-id="tui-file__type"\n                class="t-type"\n            >\n                {{ type }}\n            </div>\n            <div\n                *ngIf="showSize && (fileSize$ | async) as fileSize"\n                automation-id="tui-file__size"\n                class="t-size"\n            >\n                {{ fileSize }}\n            </div>\n        </div>\n        <div\n            *ngIf="content$ | async as content"\n            polymorpheus-outlet\n            automation-id="tui-file__content"\n            class="t-content"\n            [content]="content"\n        ></div>\n        <ng-content></ng-content>\n    </div>\n    <ng-container *ngIf="allowDelete">\n        <button\n            *ngIf="fileTexts$ | async as texts"\n            automation-id="tui-file__remove"\n            tuiIconButton\n            type="button"\n            size="xs"\n            icon="tuiIconCloseLarge"\n            appearance="icon"\n            class="t-remove"\n            [title]="texts.remove"\n            [class.t-remove_mobile]="isMobile"\n            (click.prevent)="onRemoveClick()"\n        ></button>\n    </ng-container>\n</ng-template>\n\n<ng-template #defaultLeftContent>\n    <img\n        *ngIf="preview; else loader"\n        automation-id="tui-file__preview"\n        class="t-image"\n        [src]="preview"\n    />\n    <ng-template #loader>\n        <tui-loader\n            *ngIf="isLoading; else svg"\n            automation-id="tui-file__loader"\n            class="t-loader"\n            [inheritColor]="isBig"\n        ></tui-loader>\n    </ng-template>\n    <ng-template #svg>\n        <tui-svg\n            automation-id="tui-file__icon"\n            class="t-icon"\n            [class.t-icon_deleted]="isDeleted"\n            [class.t-icon_error]="isError"\n            [src]="icon"\n        ></tui-svg>\n    </ng-template>\n</ng-template>\n',styles:[":host{position:relative;display:flex;align-items:center;font:var(--tui-font-text-m);border:1px solid var(--tui-base-03);border-radius:var(--tui-radius-m)}:host[data-mode=onDark]{color:var(--tui-text-01-night)}:host:not(._link){padding:.5625rem 2.1875rem .5625rem .5625rem}:host:hover .t-remove{opacity:1}:host._focused{border-color:var(--tui-focus);box-shadow:0 0 0 1px inset var(--tui-focus)}.t-link{display:flex;flex:1;padding:.5625rem 2.1875rem .5625rem .5625rem;text-decoration:none;outline:0;cursor:pointer;color:var(--tui-text-01);max-width:calc(100% - 2.75rem)}.t-link:hover{background-color:var(--tui-base-02)}.t-preview{position:relative;display:flex;align-items:center;justify-content:center;flex-shrink:0;width:1.5rem;height:1.5rem;margin-right:.75rem;border-radius:var(--tui-radius-m);overflow:hidden;color:var(--tui-base-06)}.t-preview_big{width:4rem;height:4rem;margin-right:1rem}.t-preview_big:before{position:absolute;top:0;left:0;width:100%;height:100%;content:'';background:var(--tui-base-08);opacity:.08}.t-image{max-width:100%;max-height:100%}.t-loader{position:absolute;top:0;left:0;width:100%;height:100%}.t-icon{position:absolute;top:0;left:0;width:100%;height:100%;color:var(--tui-success-fill)}.t-icon_error{color:var(--tui-error-fill)}.t-icon_deleted{color:var(--tui-base-06)}.t-remove{transition-property:opacity;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out;position:absolute;top:.625rem;right:.625rem;opacity:0}.t-remove:focus,.t-remove_mobile{opacity:1}.t-wrapper{display:flex;flex-direction:column;justify-content:center;overflow:hidden}.t-text{display:flex}.t-size{flex-shrink:0;opacity:var(--tui-disabled-opacity);margin-left:.5rem}.t-type{flex-shrink:0}.t-name{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.t-content{font:var(--tui-font-text-s);color:var(--tui-error-fill)}"]}),f(0,t.Inject(i.TUI_IS_MOBILE)),f(1,t.Inject(n.DomSanitizer)),f(2,t.Inject(o.TUI_FILE_TEXTS)),f(3,t.Inject(o.TUI_DIGITAL_INFORMATION_UNITS))],e)}(),g=function(){function e(e,t){this.hideText$=e,this.showAllText$=t,this.items=null,this.max=0,this.hidden=!0}return Object.defineProperty(e.prototype,"hasExtraItems",{get:function(){var e,t;return!!this.max&&(null!==(t=null===(e=this.items)||void 0===e?void 0:e.length)&&void 0!==t?t:0)>this.max},enumerable:!0,configurable:!0}),e.prototype.toggle=function(){this.hidden=!this.hidden},e.ctorParameters=function(){return[{type:a.Observable,decorators:[{type:t.Inject,args:[o.TUI_HIDE_TEXT]}]},{type:a.Observable,decorators:[{type:t.Inject,args:[o.TUI_SHOW_ALL_TEXT]}]}]},p([t.ContentChildren(i.TuiItemDirective,{read:t.TemplateRef})],e.prototype,"items",void 0),p([t.Input(),i.tuiDefaultProp()],e.prototype,"max",void 0),e=p([t.Component({selector:"tui-files",template:'<ng-container *ngIf="items?.changes | async"></ng-container>\n\n<section\n    tuiGroup\n    orientation="vertical"\n    class="t-files"\n    [collapsed]="true"\n>\n    <ng-content></ng-content>\n    <ng-container *ngFor="let item of items; let index = index">\n        <ng-container\n            *ngIf="!max || index < max"\n            [ngTemplateOutlet]="item"\n        ></ng-container>\n    </ng-container>\n    <tui-expand\n        *ngIf="hasExtraItems"\n        [expanded]="!hidden"\n    >\n        <div class="t-extra-items">\n            <ng-container *ngFor="let item of items; let index = index">\n                <ng-container\n                    *ngIf="max && index >= max"\n                    [ngTemplateOutlet]="item"\n                ></ng-container>\n            </ng-container>\n        </div>\n    </tui-expand>\n    <button\n        *ngIf="hasExtraItems"\n        tuiButton\n        appearance="outline"\n        size="m"\n        class="t-button"\n        [class.t-button_collapsed]="hidden"\n        (click)="toggle()"\n    >\n        {{ (hidden ? showAllText$ : hideText$) | async }}\n    </button>\n</section>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,encapsulation:t.ViewEncapsulation.None,styles:["tui-files{display:block}tui-files .t-files{position:relative;display:block;width:100%;height:100%;border-radius:var(--tui-radius-m);overflow:hidden}tui-files .t-button{z-index:3;width:100%;background:var(--tui-base-01)}tui-files .t-button_collapsed{box-shadow:0 1.125rem 1.875rem rgba(0,0,0,.48);margin-top:-1.5rem}tui-files .t-extra-items tui-file{border-radius:0;margin-top:0;margin-bottom:-.0625rem}"]}),f(0,t.Inject(o.TUI_HIDE_TEXT)),f(1,t.Inject(o.TUI_SHOW_ALL_TEXT))],e)}(),m=function(){function e(){}return e=p([t.NgModule({declarations:[g,d],imports:[l.CommonModule,u.TuiGroupModule,u.TuiLoaderModule,c.PolymorpheusModule,u.TuiSvgModule,i.TuiFocusVisibleModule,u.TuiButtonModule,i.TuiItemModule,u.TuiExpandModule],exports:[g,d,i.TuiItemDirective]})],e)}();e.TuiFileComponent=d,e.TuiFilesComponent=g,e.TuiFilesModule=m,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-files.umd.min.js.map