!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@taiga-ui/kit/abstract"),require("@taiga-ui/kit/components/input-number"),require("@taiga-ui/kit/components/range"),require("@taiga-ui/kit/constants"),require("@angular/common"),require("@tinkoff/ng-polymorpheus")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/input-range",["exports","@angular/core","@angular/forms","@taiga-ui/cdk","@taiga-ui/core","@taiga-ui/kit/abstract","@taiga-ui/kit/components/input-number","@taiga-ui/kit/components/range","@taiga-ui/kit/constants","@angular/common","@tinkoff/ng-polymorpheus"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].kit=e["taiga-ui"].kit||{},e["taiga-ui"].kit.components=e["taiga-ui"].kit.components||{},e["taiga-ui"].kit.components["input-range"]={}),e.ng.core,e.ng.forms,e.cdk,e.core$1,e["taiga-ui"].kit.abstract,e["taiga-ui"].kit.components["input-number"],e["taiga-ui"].kit.components.range,e["taiga-ui"].kit.constants,e.ng.common,e.ngPolymorpheus)}(this,(function(e,t,n,i,a,o,r,u,l,p,s){"use strict";var c=function(e,t){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function d(e,t,n,i){var a,o=arguments.length,r=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var u=e.length-1;u>=0;u--)(a=e[u])&&(r=(o<3?a(r):o>3?a(t,n,r):a(t,n))||r);return o>3&&r&&Object.defineProperty(t,n,r),r}function f(e,t){return function(n,i){t(n,i,e)}}Object.create;function g(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,a,o=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=o.next()).done;)r.push(i.value)}catch(e){a={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(a)throw a.error}}return r}Object.create;var m=function(e){function p(t,n,a,o,r,u,l){var p=e.call(this,t,n)||this;return p.isMobile=a,p.appearance=o,p.elementRef=r,p.controller=u,p.isNew=l,p.inputNumberRefs=i.EMPTY_QUERY,p.rangeRef=null,p.min=0,p.max=1/0,p.quantum=1,p.steps=0,p.segments=0,p.keySteps=null,p.leftValueContent="",p.rightValueContent="",p.lastActiveSide="left",p}var s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}c(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(p,e),s=p,Object.defineProperty(p.prototype,"leftFocusableElement",{get:function(){var e;return(null===(e=this.inputNumberRefs.first)||void 0===e?void 0:e.nativeFocusableElement)||null},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"rightFocusableElement",{get:function(){var e;return(null===(e=this.inputNumberRefs.last)||void 0===e?void 0:e.nativeFocusableElement)||null},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"nativeFocusableElement",{get:function(){return this.disabled?null:this.leftFocusableElement||this.rightFocusableElement},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"focused",{get:function(){return i.isNativeFocusedIn(this.elementRef.nativeElement)},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"showLeftValueContent",{get:function(){var e;return Boolean((this.minLabel||this.leftValueContent)&&!i.isNativeFocused(this.leftFocusableElement)&&!((null===(e=this.rangeRef)||void 0===e?void 0:e.focused)&&"left"===this.lastActiveSide))},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"showRightValueContent",{get:function(){var e;return Boolean((this.maxLabel||this.rightValueContent)&&!i.isNativeFocused(this.rightFocusableElement)&&!((null===(e=this.rangeRef)||void 0===e?void 0:e.focused)&&"right"===this.lastActiveSide))},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"precision",{get:function(){return a.getFractionPartPadded(this.quantum).length},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"decimal",{get:function(){return this.precision?"not-zero":"never"},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"computedSteps",{get:function(){return this.steps||(this.max-this.min)/this.quantum},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"computedSize",{get:function(){return this.isNew&&"s"!==this.controller.size?this.controller.size:this.size},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"legacyLabelOutside",{get:function(){return this.isNew?this.controller.labelOutside:"m"===this.computedSize},enumerable:!0,configurable:!0}),p.prototype.onActiveZone=function(e){this.updateFocused(e)},p.prototype.onTextInputFocused=function(e,t){if(!e){var n=g(this.inputNumberRefs,2),i=n[0],a=n[1],o=t?a:i,r=t?1:0;o.nativeValue&&o.value===this.value[r]||this.updateTextInputValue(this.safeCurrentValue[r],t)}},p.prototype.changeByStep=function(e,t){var n=g(t,2),i=n[0],a=n[1];if(!this.readOnly){e.preventDefault();var o=this.valueGuard([this.value[0]+i*this.step,this.value[1]+a*this.step]),r=o[0]!==this.value[0],u=o[1]!==this.value[1];(r||u)&&(this.safelyUpdateValue(o),this.updateTextInputValue(o[u?1:0],u))}},p.prototype.onInputLeft=function(e){this.safelyUpdateValue([null!=e?e:this.safeCurrentValue[0],this.value[1]])},p.prototype.onInputRight=function(e){this.safelyUpdateValue([this.value[0],null!=e?e:this.safeCurrentValue[1]])},p.prototype.onRangeValue=function(e){this.safelyUpdateValue(e);var t="right"===this.lastActiveSide;this.updateTextInputValue(this.value[t?1:0],t)},p.prototype.focusToTextInput=function(){var e="left"===this.lastActiveSide?this.leftFocusableElement:this.rightFocusableElement;!this.isMobile&&e&&e.focus()},p.prototype.onActiveThumbChange=function(e){this.lastActiveSide=e},p.prototype.getFallbackValue=function(){return[0,0]},p.prototype.safelyUpdateValue=function(e){this.updateValue(this.valueGuard(e))},p.prototype.valueGuard=function(e){var t=g(e,2),n=t[0],i=t[1],a=this.calibrate(n),o=this.calibrate(i);return[Math.min(a,this.value[1]),Math.max(o,this.value[0])]},p.prototype.calibrate=function(e){var t=i.round(Math.round(e/this.quantum)*this.quantum,l.TUI_FLOATING_PRECISION);return i.clamp(t,this.min,this.max)},p.prototype.updateTextInputValue=function(e,t){var n=g(this.inputNumberRefs,2),i=n[0],a=n[1],o=t?a:i;o&&(o.nativeValue=o.getFormattedValue(e))},p.ctorParameters=function(){return[{type:n.NgControl,decorators:[{type:t.Optional},{type:t.Self},{type:t.Inject,args:[n.NgControl]}]},{type:t.ChangeDetectorRef,decorators:[{type:t.Inject,args:[t.ChangeDetectorRef]}]},{type:Boolean,decorators:[{type:t.Inject,args:[i.TUI_IS_MOBILE]}]},{type:String,decorators:[{type:t.Inject,args:[a.TUI_TEXTFIELD_APPEARANCE]}]},{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:a.TuiTextfieldController,decorators:[{type:t.Inject,args:[a.TUI_TEXTFIELD_WATCHED_CONTROLLER]}]},{type:u.TuiNewRangeDirective,decorators:[{type:t.Optional},{type:t.Inject,args:[u.TuiNewRangeDirective]}]}]},d([t.ViewChildren(r.TuiInputNumberComponent)],p.prototype,"inputNumberRefs",void 0),d([t.ViewChild(u.TuiRangeComponent)],p.prototype,"rangeRef",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"min",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"max",void 0),d([t.Input(),i.tuiDefaultProp(o.quantumAssertion,"Quantum must be positive")],p.prototype,"quantum",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"steps",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"segments",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"keySteps",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"leftValueContent",void 0),d([t.Input(),i.tuiDefaultProp()],p.prototype,"rightValueContent",void 0),d([t.HostBinding("class._label-outside")],p.prototype,"legacyLabelOutside",null),p=s=d([t.Component({selector:"tui-input-range",template:'<tui-wrapper\n    class="t-wrapper"\n    [appearance]="appearance"\n    [readOnly]="readOnly"\n    [disabled]="disabled"\n    [focused]="computedFocused"\n    [hovered]="computedHovered"\n    [invalid]="computedInvalid"\n    (tuiActiveZoneChange)="onActiveZone($event)"\n>\n    <tui-input-number\n        tuiTextfieldAppearance="none"\n        automation-id="tui-input-range__left-input"\n        class="t-left t-text-input"\n        [min]="min"\n        [max]="value[1]"\n        [precision]="precision"\n        [decimal]="decimal"\n        [postfix]="pluralizeMap && !showLeftValueContent ? (value[0] | i18nPlural: pluralizeMap) : \'\'"\n        [disabled]="computedDisabled"\n        [readOnly]="readOnly"\n        [tuiTextfieldSize]="computedSize"\n        [tuiTextfieldLabelOutside]="legacyLabelOutside"\n        [ngModel]="value[0]"\n        (ngModelChange)="onInputLeft($event)"\n        (focusedChange)="onTextInputFocused($event, false)"\n        (keydown.arrowUp)="changeByStep($event, [1, 0])"\n        (keydown.arrowDown)="changeByStep($event, [-1, 0])"\n    >\n        <ng-content></ng-content>\n        <div\n            *ngIf="showLeftValueContent"\n            polymorpheus-outlet\n            [content]="minLabel ? legacyMinLabel : leftValueContent"\n            [context]="{$implicit: value[0]}"\n        ></div>\n    </tui-input-number>\n\n    <div class="t-right">\n        <tui-input-number\n            tuiTextfieldAppearance="none"\n            automation-id="tui-input-range__right-input"\n            class="t-text-input"\n            [min]="value[0]"\n            [max]="max"\n            [precision]="precision"\n            [decimal]="decimal"\n            [disabled]="computedDisabled"\n            [readOnly]="readOnly"\n            [tuiTextfieldSize]="computedSize"\n            [tuiTextfieldLabelOutside]="legacyLabelOutside"\n            [ngModel]="value[1]"\n            (ngModelChange)="onInputRight($event)"\n            (focusedChange)="onTextInputFocused($event, true)"\n            (keydown.arrowUp)="changeByStep($event, [0, 1])"\n            (keydown.arrowDown)="changeByStep($event, [0, -1])"\n        >\n            <div\n                *ngIf="showRightValueContent"\n                polymorpheus-outlet\n                [content]="maxLabel ? legacyMaxLabel : rightValueContent"\n                [context]="{$implicit: value[1]}"\n            ></div>\n        </tui-input-number>\n\n        \x3c!-- TODO replace by postfix of the right InputNumber (after fix https://github.com/Tinkoff/taiga-ui/issues/1193) --\x3e\n        <span\n            *ngIf="!showRightValueContent && pluralizeMap"\n            automation-id="tui-input-range__pluralize-right"\n            class="t-pluralize-right"\n        >\n            &nbsp;{{ value[1] | i18nPlural: pluralizeMap }}\n        </span>\n    </div>\n\n    <tui-range\n        class="t-slider"\n        [min]="min"\n        [max]="max"\n        [steps]="computedSteps"\n        [segments]="segments"\n        [keySteps]="keySteps"\n        [pluralize]="segmentsPluralizeMap"\n        [focusable]="false"\n        [disabled]="readOnly || disabled"\n        [ngModel]="value"\n        (ngModelChange)="onRangeValue($event)"\n        (tuiPressedChange)="focusToTextInput()"\n        (activeThumbChange)="onActiveThumbChange($event)"\n    ></tui-range>\n</tui-wrapper>\n\n\x3c!-- TODO: 3.0 remove --\x3e\n<ng-template\n    #legacyMinLabel\n    let-value\n>\n    <ng-container *ngIf="value === min">{{ minLabel }}</ng-container>\n    <ng-container *ngIf="value !== min">\n        {{ value }}&nbsp;{{ value | i18nPlural: pluralizeMap || pluralizeMapFallback }}\n    </ng-container>\n</ng-template>\n\n\x3c!-- TODO: 3.0 remove --\x3e\n<ng-template\n    #legacyMaxLabel\n    let-value\n>\n    <ng-container *ngIf="value === max">{{ maxLabel }}</ng-container>\n    <ng-container *ngIf="value !== max">\n        {{ value }}&nbsp;{{ value | i18nPlural: pluralizeMap || pluralizeMapFallback }}\n    </ng-container>\n</ng-template>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,providers:[{provide:i.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:t.forwardRef((function(){return s}))},a.TEXTFIELD_CONTROLLER_PROVIDER],host:{"[class._show-ticks-labels]":"!isNew"},styles:[".t-wrapper{position:relative}.t-left{width:100%}.t-right{position:absolute;right:0;top:0;display:flex;width:50%;height:100%;text-align:right}.t-right .t-text-input{flex:1}.t-text-input{text-align:inherit}.t-pluralize-right{display:flex;align-items:center;padding:1.125rem var(--tui-padding-m) 0 0;margin-left:-.75rem;font:var(--tui-font-text-s)}:host[data-size='l'] .t-pluralize-right{font:var(--tui-font-text-m);padding-top:1.25rem;margin-left:-1rem;padding-right:var(--tui-padding-l)}:host._label-outside .t-pluralize-right{padding-top:0}:host._disabled .t-pluralize-right{color:var(--tui-text-03)}:host{display:block;border-radius:var(--tui-radius-m)}:host._show-ticks-labels._segmented{border-bottom:26px solid transparent}.t-slider{position:absolute;top:100%;left:0;right:0;z-index:1;margin:-.125rem 0 0;background:0 0}"]}),f(0,t.Optional()),f(0,t.Self()),f(0,t.Inject(n.NgControl)),f(1,t.Inject(t.ChangeDetectorRef)),f(2,t.Inject(i.TUI_IS_MOBILE)),f(3,t.Inject(a.TUI_TEXTFIELD_APPEARANCE)),f(4,t.Inject(t.ElementRef)),f(5,t.Inject(a.TUI_TEXTFIELD_WATCHED_CONTROLLER)),f(6,t.Optional()),f(6,t.Inject(u.TuiNewRangeDirective))],p)}(o.AbstractTuiInputSlider);function h(e){return e.nativeElement.getAttribute("tuiTextfieldAppearance")}var v=function(){function e(){}return e=d([t.Directive({selector:"[tuiTextfieldAppearance]",providers:[{provide:a.TUI_TEXTFIELD_APPEARANCE,deps:[t.ElementRef],useFactory:h}]})],e)}(),y=function(){function e(){}return e=d([t.NgModule({imports:[p.CommonModule,n.FormsModule,n.ReactiveFormsModule,s.PolymorpheusModule,i.TuiActiveZoneModule,r.TuiInputNumberModule,i.TuiPressedModule,u.TuiRangeModule,a.TuiTextfieldControllerModule,a.TuiWrapperModule],declarations:[m,v],exports:[m,u.TuiNewRangeDirective]})],e)}();e.TuiInputRangeComponent=m,e.TuiInputRangeModule=y,e.TuiTextfieldAppearanceDirective=v,e.tuiTextfieldAppearanceDirectiveFactory=h,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-input-range.umd.min.js.map