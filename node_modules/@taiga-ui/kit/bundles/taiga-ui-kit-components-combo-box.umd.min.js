!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@taiga-ui/kit/components/arrow"),require("@taiga-ui/kit/tokens"),require("@taiga-ui/kit/components/select-option"),require("@taiga-ui/kit/providers"),require("@angular/common"),require("@tinkoff/ng-polymorpheus")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/combo-box",["exports","@angular/core","@angular/forms","@taiga-ui/cdk","@taiga-ui/core","@taiga-ui/kit/components/arrow","@taiga-ui/kit/tokens","@taiga-ui/kit/components/select-option","@taiga-ui/kit/providers","@angular/common","@tinkoff/ng-polymorpheus"],e):e(((t=t||self)["taiga-ui"]=t["taiga-ui"]||{},t["taiga-ui"].kit=t["taiga-ui"].kit||{},t["taiga-ui"].kit.components=t["taiga-ui"].kit.components||{},t["taiga-ui"].kit.components["combo-box"]={}),t.ng.core,t.ng.forms,t.cdk,t.core$1,t["taiga-ui"].kit.components.arrow,t["taiga-ui"].kit.tokens,t["taiga-ui"].kit.components["select-option"],t["taiga-ui"].kit.providers,t.ng.common,t.ngPolymorpheus)}(this,(function(t,e,o,n,i,r,u,a,c,s,p){"use strict";var l=function(t,e){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)};function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}l(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}function h(t,e,o,n){var i,r=arguments.length,u=r<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,o,n);else for(var a=t.length-1;a>=0;a--)(i=t[a])&&(u=(r<3?i(u):r>3?i(e,o,u):i(e,o))||u);return r>3&&u&&Object.defineProperty(e,o,u),u}function f(t,e){return function(o,n){e(o,n,t)}}Object.create;Object.create;var v=a.TUI_SELECT_OPTION,g=[{provide:n.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:e.forwardRef((function(){return y}))},{provide:i.TUI_DATA_LIST_HOST,useExisting:e.forwardRef((function(){return y}))},{provide:n.AbstractTuiControl,useExisting:e.forwardRef((function(){return y}))},{provide:i.TUI_OPTION_CONTENT,useValue:v},c.FIXED_DROPDOWN_CONTROLLER_PROVIDER],y=function(t){function a(o,i,r,u){var a=t.call(this,o,i)||this;return a.arrowMode=r,a.itemsHandlers=u,a.stringify=a.itemsHandlers.stringify,a.strictMatcher=n.TUI_STRICT_MATCHER,a.identityMatcher=a.itemsHandlers.identityMatcher,a.valueContent="",a.strict=!0,a.search=null,a.searchChange=new e.EventEmitter,a.datalist="",a.open=!1,a}return d(a,t),Object.defineProperty(a.prototype,"arrow",{get:function(){return this.interactive?this.arrowMode.interactive:this.arrowMode.disabled},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeFocusableElement",{get:function(){return this.textfield?this.textfield.nativeFocusableElement:null},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"focused",{get:function(){return n.isNativeFocused(this.nativeFocusableElement)||!!this.hostedDropdown&&this.hostedDropdown.focused},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeValue",{get:function(){return null===this.value?this.search||"":this.stringify(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"showValueTemplate",{get:function(){return n.isPresent(this.value)&&!this.focused},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"computedContent",{get:function(){return this.valueContent||this.nativeValue},enumerable:!0,configurable:!0}),a.prototype.onActiveZone=function(t){this.updateFocused(t)},a.prototype.checkOption=function(t){this.isStrictMatch(t)&&(this.updateValue(t),this.updateSearch(null))},a.prototype.handleOption=function(t){this.focusInput(),this.close(),this.updateSearch(null),this.updateValue(t),this.value&&this.setNativeValue(this.stringify(t))},a.prototype.onFieldKeyDownEnter=function(t){var e;this.open&&t.preventDefault();var o=(null===(e=this.accessor)||void 0===e?void 0:e.getOptions())||[];1===o.length&&(this.updateValue(o[0]),this.updateSearch(null),this.close())},a.prototype.onValueChange=function(t){var e,o,n=this;this.updateSearch(t);var i=null===(e=this.accessor)||void 0===e?void 0:e.getOptions().find((function(t){return n.isStrictMatch(t)}));if(void 0!==i)return this.updateValue(i),void this.updateSearch(null);(this.strict||""===this.search)&&this.updateValue(null),null===(o=this.hostedDropdown)||void 0===o||o.updateOpen(!0)},a.prototype.updateValue=function(e){t.prototype.updateValue.call(this,e)},a.prototype.onHovered=function(t){this.updateHovered(t)},a.prototype.toggle=function(){var t;null===(t=this.hostedDropdown)||void 0===t||t.updateOpen(!this.open)},a.prototype.isStrictMatch=function(t){return this.strictMatcher(t,this.search||"",this.stringify)},a.prototype.close=function(){var t;null===(t=this.hostedDropdown)||void 0===t||t.updateOpen(!1)},a.prototype.updateSearch=function(t){this.search!==t&&(this.search=t,this.searchChange.emit(t))},a.prototype.setNativeValue=function(t){this.nativeFocusableElement&&(this.nativeFocusableElement.value=t)},a.prototype.focusInput=function(t){void 0===t&&(t=!1),this.nativeFocusableElement&&n.setNativeFocused(this.nativeFocusableElement,!0,t)},a.ctorParameters=function(){return[{type:o.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[o.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:void 0,decorators:[{type:e.Inject,args:[r.TUI_ARROW_MODE]}]},{type:void 0,decorators:[{type:e.Inject,args:[u.TUI_ITEMS_HANDLERS]}]}]},h([e.ContentChild(i.TUI_DATA_LIST_ACCESSOR)],a.prototype,"accessor",void 0),h([e.ViewChild(i.TuiHostedDropdownComponent)],a.prototype,"hostedDropdown",void 0),h([e.ViewChild(i.TuiPrimitiveTextfieldComponent)],a.prototype,"textfield",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"stringify",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"strictMatcher",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"identityMatcher",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"valueContent",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"strict",void 0),h([e.Input(),n.tuiDefaultProp()],a.prototype,"search",void 0),h([e.Output()],a.prototype,"searchChange",void 0),h([e.ContentChild(i.TuiDataListDirective,{read:e.TemplateRef})],a.prototype,"datalist",void 0),a=h([e.Component({selector:"tui-combo-box",template:'<tui-hosted-dropdown\n    class="t-hosted"\n    [canOpen]="interactive"\n    [content]="datalist || \'\'"\n    [(open)]="open"\n    (tuiActiveZoneChange)="onActiveZone($event)"\n>\n    <tui-primitive-textfield\n        automation-id="tui-combo-box__textfield"\n        class="t-textfield"\n        [pseudoFocused]="computedFocused"\n        [pseudoHovered]="computedHovered"\n        [invalid]="computedInvalid"\n        [nativeId]="nativeId"\n        [readOnly]="readOnly"\n        [iconContent]="arrow ? icon : \'\'"\n        [disabled]="computedDisabled"\n        [focusable]="computedFocusable"\n        [value]="nativeValue"\n        (valueChange)="onValueChange($event)"\n        (hoveredChange)="onHovered($event)"\n        (click)="toggle()"\n        (keydown.enter)="onFieldKeyDownEnter($event)"\n    >\n        <ng-content></ng-content>\n        <ng-content\n            select="input"\n            ngProjectAs="input"\n        ></ng-content>\n        <div\n            *ngIf="showValueTemplate"\n            polymorpheus-outlet\n            automation-id="tui-combo-box__template"\n            class="t-value"\n            [content]="computedContent"\n            [context]="{$implicit: value!, active: computedFocused}"\n        ></div>\n    </tui-primitive-textfield>\n\n    <ng-template #icon>\n        <div\n            polymorpheus-outlet\n            class="t-icon"\n            [content]="arrow"\n        ></div>\n    </ng-template>\n</tui-hosted-dropdown>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,providers:g,styles:[":host{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-hosted{display:block;border-radius:inherit}.t-textfield{border-radius:inherit;text-align:inherit}.t-value{display:flex;width:100%;align-items:center}.t-icon{pointer-events:auto}"]}),f(0,e.Optional()),f(0,e.Self()),f(0,e.Inject(o.NgControl)),f(1,e.Inject(e.ChangeDetectorRef)),f(2,e.Inject(r.TUI_ARROW_MODE)),f(3,e.Inject(u.TUI_ITEMS_HANDLERS))],a)}(n.AbstractTuiNullableControl),m=function(t){function o(){return null!==t&&t.apply(this,arguments)||this}var n;return d(o,t),n=o,Object.defineProperty(o.prototype,"value",{get:function(){return this.host.nativeValue},enumerable:!0,configurable:!0}),o.prototype.onValueChange=function(t){this.host.onValueChange(t)},o=n=h([e.Directive({selector:"tui-combo-box",providers:[{provide:i.TUI_TEXTFIELD_HOST,useExisting:e.forwardRef((function(){return n}))}]})],o)}(i.TuiAbstractTextfieldHost),b=function(){function t(t){this.comboBox=t,this.strict=!0}return t.prototype.onInput=function(){!this.strict&&this.comboBox.search&&this.comboBox.updateValue(this.comboBox.search)},t.ctorParameters=function(){return[{type:y,decorators:[{type:e.Inject,args:[y]}]}]},h([e.Input(),n.tuiDefaultProp()],t.prototype,"strict",void 0),h([e.HostListener("input")],t.prototype,"onInput",null),t=h([e.Directive({selector:"tui-combo-box[strict]"}),f(0,e.Inject(y))],t)}(),O=function(){function t(){}return t=h([e.NgModule({imports:[s.CommonModule,p.PolymorpheusModule,n.TuiActiveZoneModule,i.TuiPrimitiveTextfieldModule,i.TuiHostedDropdownModule,a.TuiSelectOptionModule,r.TuiArrowModule],declarations:[y,b,m],exports:[y,b,m,i.TuiTextfieldComponent]})],t)}();t.COMBOBOX_OPTION=v,t.TUI_COMBO_BOX_PROVIDERS=g,t.TuiComboBoxComponent=y,t.TuiComboBoxDirective=m,t.TuiComboBoxModule=O,t.TuiComboBoxStrictDirective=b,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-combo-box.umd.min.js.map