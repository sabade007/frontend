!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@angular/forms"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@taiga-ui/kit/tokens"),require("rxjs"),require("@angular/common"),require("@taiga-ui/kit/directives"),require("@tinkoff/ng-polymorpheus"),require("angular2-text-mask")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/input-count",["exports","@angular/core","@angular/forms","@taiga-ui/cdk","@taiga-ui/core","@taiga-ui/kit/tokens","rxjs","@angular/common","@taiga-ui/kit/directives","@tinkoff/ng-polymorpheus","angular2-text-mask"],e):e(((t=t||self)["taiga-ui"]=t["taiga-ui"]||{},t["taiga-ui"].kit=t["taiga-ui"].kit||{},t["taiga-ui"].kit.components=t["taiga-ui"].kit.components||{},t["taiga-ui"].kit.components["input-count"]={}),t.ng.core,t.ng.forms,t.cdk,t.core$1,t["taiga-ui"].kit.tokens,t.rxjs,t.ng.common,t["taiga-ui"].kit.directives,t.ngPolymorpheus,t.angular2TextMask)}(this,(function(t,e,n,i,o,r,u,a,s,l,p){"use strict";var c=function(t,e){return(c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function d(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}c(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var f=function(){return(f=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};function h(t,e,n,i){var o,r=arguments.length,u=r<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,n,i);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(u=(r<3?o(u):r>3?o(e,n,u):o(e,n))||u);return r>3&&u&&Object.defineProperty(e,n,u),u}function m(t,e){return function(n,i){e(n,i,t)}}Object.create;Object.create;var b={icons:{up:"tuiIconPlus",down:"tuiIconMinus"},appearance:"textfield",hideButtons:!1,min:0,max:1/0,step:1,postfix:""},g=new e.InjectionToken("Default parameters for input count component",{factory:function(){return b}}),v=function(t){function a(e,n,i,o,r,u,a,s){var l=t.call(this,e,n)||this;return l.appearance=i,l.textfieldSize=o,l.minusTexts$=r,l.isMobile=u,l.options=a,l.numberFormat=s,l.unfinishedValue="",l.step=l.options.step,l.min=l.options.min,l.max=l.options.max,l.hideButtons=l.options.hideButtons,l.prefix="",l.postfix=l.options.postfix,l}var s;return d(a,t),s=a,a.prototype.getMask=function(t){return{mask:o.tuiCreateNumberMask({allowNegative:t,decimalSymbol:this.numberFormat.decimalSeparator,thousandSymbol:this.numberFormat.thousandSeparator}),guide:!1}},Object.defineProperty(a.prototype,"buttonsHidden",{get:function(){return this.hideButtons||"table"===this.appearance},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"iconUp",{get:function(){return this.options.icons.up},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"iconDown",{get:function(){return this.options.icons.down},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeFocusableElement",{get:function(){return!this.primitiveTextfield||this.computedDisabled?null:this.primitiveTextfield.nativeFocusableElement},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"size",{get:function(){return this.textfieldSize.size},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"focused",{get:function(){return i.isNativeFocused(this.nativeFocusableElement)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"exampleText",{get:function(){return String(this.min)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"computedValue",{get:function(){return this.focused?this.nativeValue:this.formatNumber(this.value)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"minusButtonDisabled",{get:function(){return!this.interactive||i.isPresent(this.value)&&this.value<=this.min},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"plusButtonDisabled",{get:function(){return!this.interactive||i.isPresent(this.value)&&this.value>=this.max},enumerable:!0,configurable:!0}),a.prototype.onButtonMouseDown=function(t,e){void 0===e&&(e=!1),e||!this.nativeFocusableElement||this.isMobile||(t.preventDefault(),i.setNativeFocused(this.nativeFocusableElement))},a.prototype.onFocused=function(t){t||this.onBlur(),this.updateFocused(t)},a.prototype.onHovered=function(t){this.updateHovered(t)},a.prototype.onPressed=function(t){this.updatePressed(t)},a.prototype.onValueChange=function(){if(this.isNativeValueNotFinished)this.unfinishedValue=this.nativeValue;else{this.unfinishedValue=null;var t=this.capValue(this.nativeNumberValue);if(this.isNotNumber(t))this.updateValue(null);else{var e=this.formatNumber(t);this.nativeValue!==e&&(this.nativeValue=e),this.updateValue(t)}}},a.prototype.decreaseValue=function(){if(!this.readOnly){var t=(this.value||0)-this.step;this.safeUpdateValue(t)}},a.prototype.increaseValue=function(){if(!this.readOnly){var t=(this.value||0)+this.step;this.safeUpdateValue(t)}},a.prototype.onKeydown=function(t){switch(t.key){case"ArrowUp":case"Up":this.increaseValue(),t.preventDefault();break;case"ArrowDown":case"Down":this.decreaseValue(),t.preventDefault()}},Object.defineProperty(a.prototype,"nativeNumberValue",{get:function(){return parseInt(this.nativeValue.split(this.numberFormat.thousandSeparator).join(""),10)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeValue",{get:function(){return this.nativeFocusableElement?this.nativeFocusableElement.value:""},set:function(t){this.nativeFocusableElement&&(this.nativeFocusableElement.value=t)},enumerable:!0,configurable:!0}),a.prototype.safeUpdateValue=function(t){var e=i.clamp(t,this.min,this.max);this.updateValue(e),this.nativeValue=this.formatNumber(e)},a.prototype.capValue=function(t){var e=Math.min(t,this.max);return Number.isNaN(e)||e<this.min?null:e},a.prototype.onBlur=function(){var t=this.unfinishedValue?o.tuiMaskedNumberStringToNumber(this.unfinishedValue,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator):this.nativeNumberValue;if(this.unfinishedValue=null,this.isNotNumber(t))this.updateValue(null);else{var e=Math.max(t||0,this.min),n=this.formatNumber(e);this.nativeValue=n,this.updateValue(e),this.primitiveTextfield&&(this.primitiveTextfield.value=n)}},a.prototype.formatNumber=function(t){return this.isNotNumber(t)?"":o.formatNumber(t,null,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator)},a.prototype.isNotNumber=function(t){return!i.isPresent(t)||Number.isNaN(t)},Object.defineProperty(a.prototype,"isNativeValueNotFinished",{get:function(){var t=this.nativeNumberValue;return t<0?t>this.max:t<this.min},enumerable:!0,configurable:!0}),a.ctorParameters=function(){return[{type:n.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[n.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:String,decorators:[{type:e.Inject,args:[o.TUI_TEXTFIELD_APPEARANCE]}]},{type:o.TuiTextfieldSizeDirective,decorators:[{type:e.Inject,args:[o.TUI_TEXTFIELD_SIZE]}]},{type:u.Observable,decorators:[{type:e.Inject,args:[r.TUI_PLUS_MINUS_TEXTS]}]},{type:Boolean,decorators:[{type:e.Inject,args:[i.TUI_IS_MOBILE]}]},{type:void 0,decorators:[{type:e.Inject,args:[g]}]},{type:void 0,decorators:[{type:e.Inject,args:[o.TUI_NUMBER_FORMAT]}]}]},h([e.ViewChild(o.TuiPrimitiveTextfieldComponent)],a.prototype,"primitiveTextfield",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"step",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"min",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"max",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"hideButtons",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"prefix",void 0),h([e.Input(),i.tuiDefaultProp()],a.prototype,"postfix",void 0),h([i.tuiPure],a.prototype,"getMask",null),h([e.HostBinding("class._hide-buttons")],a.prototype,"buttonsHidden",null),h([e.HostBinding("attr.data-size")],a.prototype,"size",null),a=s=h([e.Component({selector:"tui-input-count",template:'<tui-primitive-textfield\n    tuiValueAccessor\n    tuiTextfieldAutocomplete="off"\n    tuiTextfieldInputMode="numeric"\n    class="t-textfield"\n    [tuiTextfieldMaxLength]="18"\n    [pseudoFocused]="pseudoFocused"\n    [pseudoHovered]="pseudoHovered"\n    [pseudoPressed]="pseudoPressed"\n    [focusable]="focusable"\n    [nativeId]="nativeId"\n    [prefix]="prefix"\n    [postfix]="postfix"\n    [disabled]="computedDisabled"\n    [readOnly]="readOnly"\n    [textMask]="getMask(min < 0)"\n    [invalid]="computedInvalid"\n    [value]="computedValue"\n    (valueChange)="onValueChange()"\n    (keydown)="onKeydown($event)"\n    (focusedChange)="onFocused($event)"\n    (hoveredChange)="onHovered($event)"\n    (pressedChange)="onPressed($event)"\n>\n    <ng-content></ng-content>\n    <ng-content\n        select="input"\n        ngProjectAs="input"\n    ></ng-content>\n</tui-primitive-textfield>\n<ng-container *ngIf="!buttonsHidden">\n    <ng-container *ngIf="minusTexts$ | async as texts">\n        <section class="t-buttons">\n            <button\n                tuiIconButton\n                type="button"\n                automation-id="tui-input-count__plus-button"\n                size="s"\n                class="t-button t-button_plus"\n                [icon]="iconUp"\n                [appearance]="options.appearance"\n                [title]="texts[0]"\n                [disabled]="plusButtonDisabled"\n                [focusable]="false"\n                (mousedown)="onButtonMouseDown($event, plusButtonDisabled)"\n                (click)="increaseValue()"\n            ></button>\n            <button\n                tuiIconButton\n                type="button"\n                automation-id="tui-input-count__minus-button"\n                size="s"\n                class="t-button t-button_minus"\n                [icon]="iconDown"\n                [appearance]="options.appearance"\n                [disabled]="minusButtonDisabled"\n                [focusable]="false"\n                [title]="texts[1]"\n                (mousedown)="onButtonMouseDown($event, minusButtonDisabled)"\n                (click)="decreaseValue()"\n            ></button>\n        </section>\n    </ng-container>\n</ng-container>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,providers:[{provide:i.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:e.forwardRef((function(){return s}))},{provide:i.AbstractTuiControl,useExisting:e.forwardRef((function(){return s}))}],styles:[":host{display:flex;font:var(--tui-font-text-s);border-radius:var(--tui-radius-m);height:var(--tui-height-m);color:var(--tui-text-01);text-align:left}:host._disabled{pointer-events:none}:host[data-size='l']{font:var(--tui-font-text-m);height:var(--tui-height-l)}.t-textfield{position:relative;border-radius:inherit;text-align:inherit;flex-grow:1;min-width:0}:host:not(._hide-buttons) .t-textfield{border-top-right-radius:0;border-bottom-right-radius:0}.t-buttons{display:flex;flex-direction:column;margin-left:.125rem;height:100%}.t-buttons .t-button{display:flex;width:calc(var(--tui-height-m) * .75);height:calc(50% - .0625rem)}.t-buttons .t-button_plus{margin-bottom:.125rem;border-radius:0 var(--tui-radius-m) 0 0}.t-buttons .t-button_minus{border-radius:0 0 var(--tui-radius-m)}:host[data-size='l'] .t-buttons .t-button{width:calc(var(--tui-height-l) * .75)}"]}),m(0,e.Optional()),m(0,e.Self()),m(0,e.Inject(n.NgControl)),m(1,e.Inject(e.ChangeDetectorRef)),m(2,e.Inject(o.TUI_TEXTFIELD_APPEARANCE)),m(3,e.Inject(o.TUI_TEXTFIELD_SIZE)),m(4,e.Inject(r.TUI_PLUS_MINUS_TEXTS)),m(5,e.Inject(i.TUI_IS_MOBILE)),m(6,e.Inject(g)),m(7,e.Inject(o.TUI_NUMBER_FORMAT))],a)}(i.AbstractTuiNullableControl),y=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}var i;return d(n,t),i=n,n.prototype.onValueChange=function(){this.host.onValueChange()},n.prototype.process=function(t){t.autocomplete="off",t.inputMode="numeric"},n=i=h([e.Directive({selector:"tui-input-count",providers:[{provide:o.TUI_TEXTFIELD_HOST,useExisting:e.forwardRef((function(){return i}))}]})],n)}(o.TuiAbstractTextfieldHost),x=function(){function t(){}return t=h([e.NgModule({imports:[a.CommonModule,p.TextMaskModule,o.TuiButtonModule,o.TuiPrimitiveTextfieldModule,o.TuiTextfieldControllerModule,s.TuiValueAccessorModule,l.PolymorpheusModule],declarations:[v,y],exports:[v,y,o.TuiTextfieldComponent]})],t)}();t.PASSWORD_ICON_DOWN="tuiIconMinus",t.PASSWORD_ICON_UP="tuiIconPlus",t.TUI_INPUT_COUNT_DEFAULT_OPTIONS=b,t.TUI_INPUT_COUNT_OPTIONS=g,t.TuiInputCountComponent=v,t.TuiInputCountDirective=y,t.TuiInputCountModule=x,t.tuiInputCountOptionsProvider=function(t){return{provide:g,useValue:f(f({},b),t)}},Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-input-count.umd.min.js.map