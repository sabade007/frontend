!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@angular/forms"),require("@taiga-ui/kit/constants"),require("@taiga-ui/kit/tokens"),require("rxjs"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/abstract",["exports","@angular/core","@taiga-ui/cdk","@taiga-ui/core","@angular/forms","@taiga-ui/kit/constants","@taiga-ui/kit/tokens","rxjs","rxjs/operators"],e):e(((t=t||self)["taiga-ui"]=t["taiga-ui"]||{},t["taiga-ui"].kit=t["taiga-ui"].kit||{},t["taiga-ui"].kit.abstract={}),t.ng.core,t.cdk,t.core$1,t.ng.forms,t["taiga-ui"].kit.constants,t["taiga-ui"].kit.tokens,t.rxjs,t.rxjs.operators)}(this,(function(t,e,r,o,n,i,u,a,p){"use strict";var s=function(t,e){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])})(t,e)};function c(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}s(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function l(t,e,r,o){var n,i=arguments.length,u=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,r):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(t,e,r,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(u=(i<3?n(u):i>3?n(e,r,u):n(e,r))||u);return i>3&&u&&Object.defineProperty(e,r,u),u}Object.create;function f(t,e){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var o,n,i=r.call(t),u=[];try{for(;(void 0===e||e-- >0)&&!(o=i.next()).done;)u.push(o.value)}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return u}Object.create;function m(t){return t>0}var y=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.min=0,e.max=1/0,e.minLabel="",e.maxLabel="",e.segments=0,e.steps=0,e.quantum=1,e.keySteps=null,e.size="l",e.pluralizeMap=null,e.segmentsPluralizeMap=null,e.pluralizeMapFallback={one:"",few:"",many:"",other:""},e}return c(n,t),Object.defineProperty(n.prototype,"pluralize",{set:function(t){this.pluralizeMap=Array.isArray(t)?o.tuiPluralizeToICU(t):t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"segmentsPluralize",{set:function(t){this.segmentsPluralizeMap=Array.isArray(t)?o.tuiPluralizeToICU(t):t},enumerable:!0,configurable:!0}),n.prototype.getTickPrefix=function(t,e,r){return 1!==e?"":0===t?""+r[0]:""+r[1]},Object.defineProperty(n.prototype,"segmented",{get:function(){return this.segments>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"length",{get:function(){return this.max-this.min},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"computedSteps",{get:function(){return this.steps||this.length/this.quantum},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"step",{get:function(){return this.length/this.computedSteps},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"computedKeySteps",{get:function(){return this.computePureKeySteps(this.keySteps,this.min,this.max)},enumerable:!0,configurable:!0}),n.prototype.onHovered=function(t){this.updateHovered(t)},n.prototype.computePureKeySteps=function(t,e,r){return function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}([[0,e]],t||[],[[100,r]])},l([e.Input(),r.tuiDefaultProp()],n.prototype,"min",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"max",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"minLabel",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"maxLabel",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"pluralize",null),l([e.Input(),r.tuiDefaultProp()],n.prototype,"segmentsPluralize",null),l([e.Input(),r.tuiDefaultProp()],n.prototype,"segments",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"steps",void 0),l([e.Input(),r.tuiDefaultProp(m,"Quantum must be positive")],n.prototype,"quantum",void 0),l([e.Input(),r.tuiDefaultProp()],n.prototype,"keySteps",void 0),l([e.Input(),e.HostBinding("attr.data-size"),r.tuiDefaultProp()],n.prototype,"size",void 0),l([r.tuiPure],n.prototype,"getTickPrefix",null),l([e.HostBinding("class._segmented")],n.prototype,"segmented",null),l([r.tuiPure],n.prototype,"computePureKeySteps",null),n=l([e.Directive()],n)}(r.AbstractTuiControl),h={s:8,m:16},d=function(t){function s(e,r,o,n){var i=t.call(this,e,r)||this;return i.documentRef=o,i.fromToTexts$=n,i.pointerDown$=new a.Subject,i.min=0,i.max=1/0,i.segments=0,i.steps=0,i.quantum=0,i.size="m",i.keySteps=null,i.focusVisibleLeft=!1,i.focusVisibleRight=!1,i.pluralizeMap=null,i}var f,m;return c(s,t),Object.defineProperty(s.prototype,"pluralize",{set:function(t){this.pluralizeMap=Array.isArray(t)?o.tuiPluralizeToICU(t):t},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"segmented",{get:function(){return this.segments>0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"discrete",{get:function(){return this.steps>0},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"length",{get:function(){return this.max-this.min},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"computedStep",{get:function(){return this.steps?1/this.steps:this.quantum?this.quantum/this.length:.05},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isLeftFocusable",{get:function(){return!this.disabled&&this.focusable&&100!==this.right},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"isRightFocusable",{get:function(){return!this.disabled&&this.focusable&&100!==this.left},enumerable:!0,configurable:!0}),s.prototype.ngOnInit=function(){var e=this;t.prototype.ngOnInit.call(this);var o,n=r.typedFromEvent(this.documentRef,"mousemove"),i=r.typedFromEvent(this.documentRef,"mouseup"),u=r.typedFromEvent(this.documentRef,"touchmove"),s=r.typedFromEvent(this.documentRef,"touchend");this.pointerDown$.pipe(p.map((function(t){r.tuiAssertIsHTMLElement(t.currentTarget);var n=t.currentTarget.getBoundingClientRect(),i=t instanceof MouseEvent?t.clientX:t.touches[0].clientX,u=r.clamp(e.getFractionFromEvents(n,i),0,1),a=100*u-e.left,p=100*u-100+e.right;o=Math.abs(a)>Math.abs(p)||p>0||0===e.left&&100===e.right;var s=r.clamp(e.getCalibratedFractionFromEvents(n,i,o),0,1),c=e.getValueFromFraction(e.fractionGuard(s));return e.processValue(c,o),e.processFocus(o),n})),p.switchMap((function(t){return a.race([u,n]).pipe(p.map((function(r){return e.getCalibratedFractionFromEvents(t,r instanceof MouseEvent?r.clientX:r.touches[0].clientX,o)})),p.takeUntil(a.race([i,s])))})),p.map((function(t){return e.fractionGuard(t)}))).subscribe((function(t){e.processValue(e.getValueFromFraction(t),o)}))},s.prototype.ngOnDestroy=function(){t.prototype.ngOnDestroy.call(this),this.pointerDown$.complete()},s.prototype.onMouseDown=function(t){this.disabled||(t.preventDefault(),this.pointerDown$.next(t))},s.prototype.onTouchStart=function(t){this.disabled||(t.preventDefault(),this.pointerDown$.next(t))},s.prototype.getSegmentLabel=function(t){return r.round(this.getValueFromFraction(t/this.segments),2)},s.prototype.getSegmentPrefix=function(t,e){return 1!==this.segments?"":0===t?e[0]+" ":e[1]+" "},s.prototype.onActiveZone=function(t){this.updateFocused(t)},s.prototype.onLeftFocusVisible=function(t){this.focusVisibleLeft=t},s.prototype.onRightFocusVisible=function(t){this.focusVisibleRight=t},s.prototype.getValueFromFraction=function(t){return null!==this.keySteps?this.fractionValueKeyStepConverter(t,!0):r.round(this.fractionGuard(t)*this.length+this.min,i.TUI_FLOATING_PRECISION)},s.prototype.fractionGuard=function(t){return this.discrete?r.clamp(r.quantize(t,1/this.steps),0,1):r.clamp(t,0,1)},s.prototype.getFractionFromValue=function(t){var e=(t-this.min)/this.length;return null!==this.keySteps?this.fractionValueKeyStepConverter(t,!1):r.clamp(Number.isFinite(e)?e:1,0,1)},s.prototype.getCalibratedFractionFromEvents=function(t,e,r){return this.getFractionFromEvents(t,e)},s.prototype.valueGuard=function(t){return this.quantum?r.clamp(r.round(Math.round(t/this.quantum)*this.quantum,i.TUI_FLOATING_PRECISION),this.min,this.max):r.clamp(t,this.min,this.max)},s.prototype.processFocus=function(t){this.focusable&&this.dotRight&&this.dotLeft&&(t?r.setNativeFocused(this.dotRight.nativeElement):r.setNativeFocused(this.dotLeft.nativeElement))},s.prototype.fractionValueKeyStepConverter=function(t,e){for(var o=[[0,this.min]].concat(this.keySteps,[[100,this.max]]),n=0,u=100,a=this.min,p=this.max,s=1;s<o.length;s++)if(e&&o[s][0]/100>t||!e&&o[s][1]>t){n=o[s-1][0]||0,u=o[s][0],a=o[s-1][1],p=o[s][1];break}var c=u-n,l=p-a;return e?r.round((100*t-n)/c*l+a,i.TUI_FLOATING_PRECISION):r.clamp((t-a)/l*c+n,0,100)/100},s.prototype.getFractionFromEvents=function(t,e){var o=e-t.left-h[this.size]/2,n=t.width-h[this.size];return r.round(o/n,i.TUI_FLOATING_PRECISION)},s.ctorParameters=function(){return[{type:n.NgControl},{type:e.ChangeDetectorRef},{type:Document},{type:a.Observable,decorators:[{type:e.Inject,args:[u.TUI_FROM_TO_TEXTS]}]}]},l([e.ViewChild("dotLeft",{read:e.ElementRef})],s.prototype,"dotLeft",void 0),l([e.ViewChild("dotRight",{read:e.ElementRef})],s.prototype,"dotRight",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"min",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"max",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"segments",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"steps",void 0),l([e.Input(),r.tuiDefaultProp(r.nonNegativeFiniteAssertion,"Quantum must be a non-negative number")],s.prototype,"quantum",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"pluralize",null),l([e.Input(),e.HostBinding("attr.data-size"),r.tuiDefaultProp()],s.prototype,"size",void 0),l([e.Input(),r.tuiDefaultProp()],s.prototype,"keySteps",void 0),l([e.HostBinding("class._segmented")],s.prototype,"segmented",null),s=l([e.Directive(),(f=3,m=e.Inject(u.TUI_FROM_TO_TEXTS),function(t,e){m(t,e,f)})],s)}(r.AbstractTuiControl);t.AbstractTuiInputSlider=y,t.AbstractTuiSlider=d,t.DOT_WIDTH=h,t.SLIDER_KEYBOARD_STEP=.05,t.quantumAssertion=m,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-abstract.umd.min.js.map