!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@tinkoff/ng-polymorpheus"),require("@angular/common"),require("@taiga-ui/kit/directives"),require("angular2-text-mask")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/input-number",["exports","@angular/core","@angular/forms","@taiga-ui/cdk","@taiga-ui/core","@tinkoff/ng-polymorpheus","@angular/common","@taiga-ui/kit/directives","angular2-text-mask"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].kit=e["taiga-ui"].kit||{},e["taiga-ui"].kit.components=e["taiga-ui"].kit.components||{},e["taiga-ui"].kit.components["input-number"]={}),e.ng.core,e.ng.forms,e.cdk,e.core$1,e.ngPolymorpheus,e.ng.common,e["taiga-ui"].kit.directives,e.angular2TextMask)}(this,(function(e,t,n,i,o,r,a,u,l){"use strict";var s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function c(e,t,n,i){var o,r=arguments.length,a=r<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,i);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(r<3?o(a):r>3?o(t,n,a):o(t,n))||a);return r>3&&a&&Object.defineProperty(t,n,a),a}function m(e,t){return function(n,i){t(n,i,e)}}Object.create;Object.create;var d=function(e){function a(t,n,r,a){var u=e.call(this,t,n)||this;return u.numberFormat=r,u.isIOS=a,u.unfinishedValue="",u.min=-1/0,u.max=1/0,u.decimal="not-zero",u.precision=2,u.prefix="",u.postfix="",u.polymorpheusValueContent=i.EMPTY_QUERY,u.mask=function(e,t,n,i){return{mask:o.tuiCreateNumberMask({allowNegative:e,decimalLimit:n,allowDecimal:"never"!==t,requireDecimal:"always"===t,decimalSymbol:u.numberFormat.decimalSeparator,thousandSymbol:u.numberFormat.thousandSeparator,autoCorrectDecimalSymbol:o.tuiEnableAutoCorrectDecimalSymbol(u.numberFormat)}),pipe:o.tuiCreateAutoCorrectedNumberPipe("always"===t?n:0,u.numberFormat.decimalSeparator,u.numberFormat.thousandSeparator,i,e,u.isIOS),guide:!1}},u}var u;return p(a,e),u=a,Object.defineProperty(a.prototype,"nativeFocusableElement",{get:function(){return!this.primitiveTextfield||this.computedDisabled?null:this.primitiveTextfield.nativeFocusableElement},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"focused",{get:function(){return!!this.primitiveTextfield&&this.primitiveTextfield.focused},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isNegativeAllowed",{get:function(){return this.min<0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"inputMode",{get:function(){return this.isIOS&&this.isNegativeAllowed?"text":"never"===this.decimal?"numeric":"decimal"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"calculatedMaxLength",{get:function(){return 18+("never"!==this.decimal&&this.nativeValue.includes(this.numberFormat.decimalSeparator)?this.precision+1:0)+this.numberFormat.thousandSeparator.repeat(5).length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"formattedValue",{get:function(){return this.getFormattedValue(this.value||0)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"computedValue",{get:function(){return this.focused?this.nativeValue:null===this.value?"":this.formattedValue},enumerable:!0,configurable:!0}),a.prototype.onZero=function(e){var t=this.nativeValue.split(this.numberFormat.decimalSeparator)[1]||"",n=this.nativeFocusableElement;t.length<this.precision||!n||!n.selectionStart||"0"!==this.nativeValue[n.selectionStart]||(e.preventDefault(),n.selectionStart++)},a.prototype.onValueChange=function(e){if(o.maskedMoneyValueIsEmpty(e))this.updateValue(null);else if(this.isNativeValueNotFinished)this.unfinishedValue=e;else{this.unfinishedValue=null;var t=this.absoluteCapInputValue(e);null===t||Number.isNaN(t)||(this.updateValue(t),t!==o.tuiMaskedNumberStringToNumber(e,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator)&&(this.nativeValue=this.formattedValue))}},a.prototype.onKeyDown=function(e){o.TUI_DECIMAL_SYMBOLS.includes(e.key)&&("never"!==this.decimal?this.nativeValue.includes(this.numberFormat.decimalSeparator)&&(e.preventDefault(),this.setCaretAfterComma()):e.preventDefault())},a.prototype.onFocused=function(e){if(this.updateFocused(e),!e){var t=this.unfinishedValue?o.tuiMaskedNumberStringToNumber(this.unfinishedValue,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator):this.nativeNumberValue;if(this.unfinishedValue=null,Number.isNaN(t))this.clear();else{var n=Math.min(this.max,Math.max(this.min,t));this.updateValue(n),this.nativeValue=this.formattedValue}}},a.prototype.onHovered=function(e){this.updateHovered(e)},a.prototype.onPressed=function(e){this.updatePressed(e)},a.prototype.getFormattedValue=function(e){var t=Math.abs(e)%1>0,n="always"===this.decimal||t&&"never"!==this.decimal?this.precision:0,i=t?o.getFractionPartPadded(e,this.precision):"";return this.focused&&"always"!==this.decimal&&(n=i.length),o.formatNumber(e,n,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator,this.numberFormat.zeroPadding)},Object.defineProperty(a.prototype,"isNativeValueNotFinished",{get:function(){var e=this.nativeNumberValue;return e<0?e>this.max:e<this.min},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeValue",{get:function(){return this.nativeFocusableElement?this.nativeFocusableElement.value:""},set:function(e){this.primitiveTextfield&&this.nativeFocusableElement&&(this.primitiveTextfield.value=e,this.nativeFocusableElement.value=e)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"nativeNumberValue",{get:function(){return o.tuiMaskedNumberStringToNumber(this.nativeValue,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator)},enumerable:!0,configurable:!0}),a.prototype.clear=function(){this.nativeValue="",this.updateValue(null)},a.prototype.absoluteCapInputValue=function(e){var t=o.tuiMaskedNumberStringToNumber(e,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator),n=t<0?Math.max(Math.max(this.min,Number.MIN_SAFE_INTEGER),t):Math.min(t,Math.min(this.max,Number.MAX_SAFE_INTEGER));return Number.isNaN(n)||n<this.min||n>this.max?null:n},a.prototype.setCaretAfterComma=function(){if(this.nativeFocusableElement){var e=this.nativeValue.length-this.precision;this.nativeFocusableElement.setSelectionRange(e,e)}},a.ctorParameters=function(){return[{type:n.NgControl,decorators:[{type:t.Optional},{type:t.Self},{type:t.Inject,args:[n.NgControl]}]},{type:t.ChangeDetectorRef,decorators:[{type:t.Inject,args:[t.ChangeDetectorRef]}]},{type:void 0,decorators:[{type:t.Inject,args:[o.TUI_NUMBER_FORMAT]}]},{type:Boolean,decorators:[{type:t.Inject,args:[i.TUI_IS_IOS]}]}]},c([t.ViewChild(o.TuiPrimitiveTextfieldComponent)],a.prototype,"primitiveTextfield",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"min",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"max",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"decimal",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"precision",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"prefix",void 0),c([t.Input(),i.tuiDefaultProp()],a.prototype,"postfix",void 0),c([t.ContentChildren(r.PolymorpheusOutletComponent)],a.prototype,"polymorpheusValueContent",void 0),c([t.HostListener("keydown.0",["$event"])],a.prototype,"onZero",null),a=u=c([t.Component({selector:"tui-input-number",template:'<tui-primitive-textfield\n    tuiValueAccessor\n    class="t-textfield"\n    [pseudoHovered]="computedHovered"\n    [pseudoFocused]="computedFocused"\n    [pseudoPressed]="computedPressed"\n    [invalid]="computedInvalid"\n    [tuiTextfieldInputMode]="inputMode"\n    [tuiTextfieldMaxLength]="calculatedMaxLength"\n    [readOnly]="readOnly"\n    [disabled]="computedDisabled"\n    [textMask]="isNegativeAllowed | tuiMapper: mask:decimal:precision:nativeFocusableElement"\n    [value]="computedValue"\n    [prefix]="prefix"\n    [postfix]="postfix"\n    [focusable]="focusable"\n    (valueChange)="onValueChange($event)"\n    (hoveredChange)="onHovered($event)"\n    (focusedChange)="onFocused($event)"\n    (pressedChange)="onPressed($event)"\n    (keydown)="onKeyDown($event)"\n>\n    <ng-content></ng-content>\n    <ng-content\n        select="input"\n        ngProjectAs="input"\n    ></ng-content>\n    <div\n        *ngIf="polymorpheusValueContent.length"\n        polymorpheus-outlet\n        class="t-value-content"\n        [content]="valueContent"\n    ></div>\n</tui-primitive-textfield>\n\n<ng-container *ngIf="polymorpheusValueContent.changes | async"></ng-container>\n\n<ng-template #valueContent>\n    <ng-content select="[polymorpheus-outlet]"></ng-content>\n</ng-template>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,providers:[{provide:i.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:t.forwardRef((function(){return u}))},{provide:i.AbstractTuiControl,useExisting:t.forwardRef((function(){return u}))}],styles:[":host{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-textfield{border-radius:inherit;text-align:inherit}.t-value-content{width:100%}"]}),m(0,t.Optional()),m(0,t.Self()),m(0,t.Inject(n.NgControl)),m(1,t.Inject(t.ChangeDetectorRef)),m(2,t.Inject(o.TUI_NUMBER_FORMAT)),m(3,t.Inject(i.TUI_IS_IOS))],a)}(i.AbstractTuiNullableControl),h=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}var i;return p(n,e),i=n,Object.defineProperty(n.prototype,"value",{get:function(){return this.host.computedValue},enumerable:!0,configurable:!0}),n.prototype.onValueChange=function(e){this.host.onValueChange(e)},n.prototype.process=function(e){this.input=e},n.prototype.ngDoCheck=function(){this.input&&(this.input.maxLength=this.host.calculatedMaxLength,this.input.inputMode="decimal")},n=i=c([t.Directive({selector:"tui-input-number",providers:[{provide:o.TUI_TEXTFIELD_HOST,useExisting:t.forwardRef((function(){return i}))}]})],n)}(o.TuiAbstractTextfieldHost),f=function(){function e(){}return e=c([t.NgModule({imports:[a.CommonModule,l.TextMaskModule,i.TuiMapperPipeModule,o.TuiPrimitiveTextfieldModule,o.TuiTextfieldControllerModule,u.TuiValueAccessorModule,r.PolymorpheusModule],declarations:[d,h],exports:[d,h,o.TuiTextfieldComponent]})],e)}();e.TuiInputNumberComponent=d,e.TuiInputNumberDirective=h,e.TuiInputNumberModule=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-input-number.umd.min.js.map