!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("@taiga-ui/cdk"),require("@taiga-ui/core"),require("@taiga-ui/kit/constants"),require("@taiga-ui/kit/tokens"),require("@taiga-ui/kit/utils/mask"),require("rxjs"),require("rxjs/operators"),require("@taiga-ui/kit/providers"),require("@taiga-ui/kit/utils/miscellaneous"),require("@angular/common"),require("@taiga-ui/kit/directives"),require("@tinkoff/ng-polymorpheus"),require("angular2-text-mask")):"function"==typeof define&&define.amd?define("@taiga-ui/kit/components/input-date-time",["exports","@angular/core","@angular/forms","@taiga-ui/cdk","@taiga-ui/core","@taiga-ui/kit/constants","@taiga-ui/kit/tokens","@taiga-ui/kit/utils/mask","rxjs","rxjs/operators","@taiga-ui/kit/providers","@taiga-ui/kit/utils/miscellaneous","@angular/common","@taiga-ui/kit/directives","@tinkoff/ng-polymorpheus","angular2-text-mask"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].kit=e["taiga-ui"].kit||{},e["taiga-ui"].kit.components=e["taiga-ui"].kit.components||{},e["taiga-ui"].kit.components["input-date-time"]={}),e.ng.core,e.ng.forms,e.cdk,e.core$1,e["taiga-ui"].kit.constants,e["taiga-ui"].kit.tokens,e["taiga-ui"].kit.utils.mask,e.rxjs,e.rxjs.operators,e["taiga-ui"].kit.providers,e["taiga-ui"].kit.utils.miscellaneous,e.ng.common,e["taiga-ui"].kit.directives,e.ngPolymorpheus,e.angular2TextMask)}(this,(function(e,t,n,i,o,a,r,u,l,s,c,p,d,f,m,h){"use strict";var g=function(e,t){return(g=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function T(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}g(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function y(e,t,n,i){var o,a=arguments.length,r=a<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,n,i);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(r=(a<3?o(r):a>3?o(t,n,r):o(t,n))||r);return a>3&&r&&Object.defineProperty(t,n,r),r}function v(e,t){return function(n,i){t(n,i,e)}}Object.create;function _(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var i,o,a=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(i=a.next()).done;)r.push(i.value)}catch(e){o={error:e}}finally{try{i&&!i.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return r}function E(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(_(arguments[t]));return e}Object.create;var b=function(e,t){return p.TuiReplayControlValueChangesFactory(e,t)},A=[{provide:i.AbstractTuiControl,useExisting:t.forwardRef((function(){return I}))},{provide:i.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:t.forwardRef((function(){return I}))},{provide:r.TUI_CALENDAR_DATA_STREAM,deps:[[new t.Optional,new t.Self,n.NgControl],[new t.Optional,t.forwardRef((function(){return r.TUI_DATE_TIME_VALUE_TRANSFORMER}))]],useFactory:b},c.LEFT_ALIGNED_DROPDOWN_CONTROLLER_PROVIDER],I=function(e){function c(t,n,o,a,r,u,c,p){var d=e.call(this,t,n,p)||this;return d.textfieldSize=o,d.dateFormat=a,d.dateSeparator=r,d.timeTexts$=u,d.dateTexts$=c,d.valueTransformer=p,d.month=null,d.min=i.TUI_FIRST_DAY,d.max=i.TUI_LAST_DAY,d.disabledItemHandler=i.ALWAYS_FALSE_HANDLER,d.defaultActiveYearMonth=i.TuiMonth.currentLocal(),d.timeMode="HH:MM",d.open=!1,d.filler$=l.combineLatest([d.dateTexts$.pipe(s.map((function(e){return i.changeDateSeparator(e[d.dateFormat],d.dateSeparator)}))),d.timeTexts$.pipe(s.pluck(d.timeMode))]).pipe(s.map((function(e){return d.getDateTimeString.apply(d,E(e))}))),d}return T(c,e),Object.defineProperty(c.prototype,"fillerLength",{get:function(){return i.DATE_FILLER_LENGTH+a.DATE_TIME_SEPARATOR.length+this.timeMode.length},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"textMaskOptions",{get:function(){return this.calculateMask(this.value[0],this.calendarMinDay,this.calendarMaxDay,this.timeMode,this.dateFormat,this.dateSeparator)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"nativeFocusableElement",{get:function(){return this.textfield?this.textfield.nativeFocusableElement:null},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"focused",{get:function(){return!!this.textfield&&this.textfield.focused},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"calendarIcon",{get:function(){return o.sizeBigger(this.textfieldSize.size)?"tuiIconCalendarLarge":"tuiIconCalendar"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"computedValue",{get:function(){var e=this.value,t=this.nativeValue,n=this.timeMode,o=_(e,2),a=o[0],r=o[1],u=t.length>i.DATE_FILLER_LENGTH;return!a||!r&&u?t:this.getDateTimeString(a,r,n)},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"calendarValue",{get:function(){return this.value[0]},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"calendarMinDay",{get:function(){return Array.isArray(this.min)?this.min[0]:this.min},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"calendarMaxDay",{get:function(){return Array.isArray(this.max)?this.max[0]:this.max},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"computedActiveYearMonth",{get:function(){return this.month||this.value[0]||this.defaultActiveYearMonth},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"nativeValue",{get:function(){return this.nativeFocusableElement?this.nativeFocusableElement.value:""},set:function(e){this.nativeFocusableElement&&(this.nativeFocusableElement.value=e)},enumerable:!0,configurable:!0}),c.prototype.onClick=function(){this.open=!this.open},c.prototype.onValueChange=function(e){if(e||this.onOpenChange(!0),e.length<i.DATE_FILLER_LENGTH)this.updateValue([null,null]);else{var t=_(e.split(a.DATE_TIME_SEPARATOR),2),n=t[0],o=t[1],r=i.TuiDay.normalizeParse(n,this.dateFormat),u=o&&o.length===this.timeMode.length?this.clampTime(i.TuiTime.fromString(o),r):null;this.open=!1,this.updateValue([r,u])}},c.prototype.onDayClick=function(e){var t=this.value[1]&&this.clampTime(this.value[1],e);this.updateValue([e,t]),this.updateNativeValue(e),this.open=!1},c.prototype.onHovered=function(e){this.updateHovered(e)},c.prototype.onMonthChange=function(e){this.month=e},c.prototype.onOpenChange=function(e){this.open=e},c.prototype.onFocused=function(e){var t=this;if(this.updateFocused(e),!(e||null===this.value[0]||null!==this.value[1]||this.nativeValue.length<=this.fillerLength+a.DATE_TIME_SEPARATOR.length||"HH:MM"===this.timeMode)){var n=_(this.nativeValue.split(a.DATE_TIME_SEPARATOR),2)[1];if(n){var o=i.TuiTime.fromString(n);this.updateValue([this.value[0],o]),setTimeout((function(){(t.nativeValue.endsWith(".")||t.nativeValue.endsWith(":"))&&(t.nativeValue=t.nativeValue.slice(0,-1))}))}}},c.prototype.setDisabledState=function(){e.prototype.setDisabledState.call(this),this.open=!1},c.prototype.writeValue=function(t){e.prototype.writeValue.call(this,t),this.nativeValue=this.value&&(this.value[0]||this.value[1])?this.computedValue:""},c.prototype.getFallbackValue=function(){return[null,null]},c.prototype.valueIdenticalComparator=function(e,t){return i.nullableSame(e[0],t[0],(function(e,t){return e.daySame(t)}))&&i.nullableSame(e[1],t[1],(function(e,t){return String(e)===String(t)}))},c.prototype.calculateMask=function(e,t,n,i,o,a){return{mask:E(u.tuiCreateDateMask(o,a),[","," "],u.tuiCreateTimeMask(i)),pipe:u.tuiCreateAutoCorrectedDateTimePipe({value:e,min:t,max:n,dateFormat:o,dateSeparator:a,timeMode:i}),guide:!1}},c.prototype.getDateTimeString=function(e,t,n){void 0===n&&(n="HH:MM");var o=e instanceof i.TuiDay?e.toString(this.dateFormat,this.dateSeparator):e,r=t instanceof i.TuiTime?t.toString(n):t||"";return""+o+a.DATE_TIME_SEPARATOR+r},c.prototype.updateNativeValue=function(e){var t=this.nativeValue.split(a.DATE_TIME_SEPARATOR)[1]||"";this.nativeValue=this.getDateTimeString(e,t)},c.prototype.clampTime=function(e,t){var n=e.toAbsoluteMilliseconds(),o=Array.isArray(this.min)&&t.daySame(this.calendarMinDay)?this.min[1].toAbsoluteMilliseconds():-1/0,a=Array.isArray(this.max)&&t.daySame(this.calendarMaxDay)?this.max[1].toAbsoluteMilliseconds():1/0;return i.TuiTime.fromAbsoluteMilliseconds(i.clamp(n,o,a))},c.ctorParameters=function(){return[{type:n.NgControl,decorators:[{type:t.Optional},{type:t.Self},{type:t.Inject,args:[n.NgControl]}]},{type:t.ChangeDetectorRef,decorators:[{type:t.Inject,args:[t.ChangeDetectorRef]}]},{type:o.TuiTextfieldSizeDirective,decorators:[{type:t.Inject,args:[o.TUI_TEXTFIELD_SIZE]}]},{type:void 0,decorators:[{type:t.Inject,args:[i.TUI_DATE_FORMAT]}]},{type:String,decorators:[{type:t.Inject,args:[i.TUI_DATE_SEPARATOR]}]},{type:l.Observable,decorators:[{type:t.Inject,args:[r.TUI_TIME_TEXTS]}]},{type:l.Observable,decorators:[{type:t.Inject,args:[r.TUI_DATE_TEXTS]}]},{type:void 0,decorators:[{type:t.Optional},{type:t.Inject,args:[r.TUI_DATE_TIME_VALUE_TRANSFORMER]}]}]},y([t.ViewChild(o.TuiPrimitiveTextfieldComponent)],c.prototype,"textfield",void 0),y([t.Input(),i.tuiDefaultProp()],c.prototype,"min",void 0),y([t.Input(),i.tuiDefaultProp()],c.prototype,"max",void 0),y([t.Input(),i.tuiDefaultProp()],c.prototype,"disabledItemHandler",void 0),y([t.Input(),i.tuiDefaultProp()],c.prototype,"defaultActiveYearMonth",void 0),y([t.Input(),i.tuiDefaultProp()],c.prototype,"timeMode",void 0),y([t.HostListener("click")],c.prototype,"onClick",null),y([i.tuiPure],c.prototype,"calculateMask",null),y([i.tuiPure],c.prototype,"getDateTimeString",null),c=y([t.Component({selector:"tui-input-date-time",template:'<tui-hosted-dropdown\n    class="t-hosted"\n    [canOpen]="interactive"\n    [content]="dropdown"\n    [open]="open && interactive"\n    (openChange)="onOpenChange($event)"\n>\n    <tui-primitive-textfield\n        automation-id="tui-input-date-time__textfield"\n        tuiValueAccessor\n        tuiTextfieldInputMode="numeric"\n        class="t-textfield"\n        [pseudoFocused]="pseudoFocused"\n        [pseudoHovered]="pseudoHovered"\n        [invalid]="computedInvalid"\n        [filler]="(filler$ | async) || \'\'"\n        [nativeId]="nativeId"\n        [readOnly]="readOnly"\n        [iconContent]="iconContent"\n        [disabled]="computedDisabled"\n        [textMask]="textMaskOptions"\n        [value]="computedValue"\n        (valueChange)="onValueChange($event)"\n        (hoveredChange)="onHovered($event)"\n        (focusedChange)="onFocused($event)"\n    >\n        <ng-content></ng-content>\n        <ng-content\n            select="input"\n            ngProjectAs="input"\n        ></ng-content>\n    </tui-primitive-textfield>\n\n    <ng-template #iconContent>\n        <tui-svg\n            [class.t-icon]="!computedDisabled"\n            [src]="calendarIcon"\n        ></tui-svg>\n    </ng-template>\n\n    <ng-template\n        #dropdown="polymorpheus"\n        [polymorpheus]="type"\n    >\n        <tui-calendar\n            tuiPreventDefault="mousedown"\n            automation-id="tui-input-date-time__calendar"\n            [min]="calendarMinDay"\n            [max]="calendarMaxDay"\n            [disabledItemHandler]="disabledItemHandler"\n            [month]="computedActiveYearMonth"\n            [value]="calendarValue"\n            (dayClick)="onDayClick($event)"\n            (monthChange)="onMonthChange($event)"\n        ></tui-calendar>\n    </ng-template>\n</tui-hosted-dropdown>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,providers:A,styles:[":host{display:block;border-radius:var(--tui-radius-m);text-align:left}.t-hosted{display:block;border-radius:inherit}.t-textfield{border-radius:inherit;text-align:inherit}.t-icon{pointer-events:auto}.t-button{display:flex;height:2.75rem;justify-content:center;box-shadow:inset 0 1px var(--tui-base-03)}"]}),v(0,t.Optional()),v(0,t.Self()),v(0,t.Inject(n.NgControl)),v(1,t.Inject(t.ChangeDetectorRef)),v(2,t.Inject(o.TUI_TEXTFIELD_SIZE)),v(3,t.Inject(i.TUI_DATE_FORMAT)),v(4,t.Inject(i.TUI_DATE_SEPARATOR)),v(5,t.Inject(r.TUI_TIME_TEXTS)),v(6,t.Inject(r.TUI_DATE_TEXTS)),v(7,t.Optional()),v(7,t.Inject(r.TUI_DATE_TIME_VALUE_TRANSFORMER))],c)}(i.AbstractTuiControl),M=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}var i;return T(n,e),i=n,Object.defineProperty(n.prototype,"value",{get:function(){return this.host.computedValue},enumerable:!0,configurable:!0}),n.prototype.onValueChange=function(e){this.host.onValueChange(e)},n.prototype.process=function(e){e.inputMode="numeric"},n=i=y([t.Directive({selector:"tui-input-date-time",providers:[{provide:o.TUI_TEXTFIELD_HOST,useExisting:t.forwardRef((function(){return i}))}]})],n)}(o.TuiAbstractTextfieldHost),D=function(){function e(){}return e=y([t.NgModule({imports:[d.CommonModule,h.TextMaskModule,m.PolymorpheusModule,i.TuiPreventDefaultModule,o.TuiCalendarModule,o.TuiSvgModule,o.TuiLinkModule,o.TuiHostedDropdownModule,o.TuiPrimitiveTextfieldModule,f.TuiValueAccessorModule,o.TuiTextfieldControllerModule],declarations:[I,M],exports:[I,M,o.TuiTextfieldComponent]})],e)}();e.TIME_STREAM_FACTORY=b,e.TUI_INPUT_DATE_TIME_PROVIDERS=A,e.TuiInputDateTimeComponent=I,e.TuiInputDateTimeDirective=M,e.TuiInputDateTimeModule=D,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-kit-components-input-date-time.umd.min.js.map