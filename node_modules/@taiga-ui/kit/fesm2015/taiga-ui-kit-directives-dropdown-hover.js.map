{"version":3,"file":"taiga-ui-kit-directives-dropdown-hover.js","sources":["ng://@taiga-ui/kit/directives/dropdown-hover/dropdown-hover.directive.ts","ng://@taiga-ui/kit/directives/dropdown-hover/dropdown-hover.module.ts","ng://@taiga-ui/kit/directives/dropdown-hover/taiga-ui-kit-directives-dropdown-hover.ts"],"sourcesContent":["import {Directive, ElementRef, HostListener, Inject} from '@angular/core';\nimport {\n    getClosestFocusable,\n    isNativeFocusedIn,\n    isPresent,\n    setNativeMouseFocused,\n    TuiDestroyService,\n    typedFromEvent,\n} from '@taiga-ui/cdk';\nimport {TuiHostedDropdownComponent} from '@taiga-ui/core';\nimport {merge, Observable, of, timer} from 'rxjs';\nimport {\n    debounce,\n    debounceTime,\n    distinctUntilChanged,\n    filter,\n    map,\n    mapTo,\n    share,\n    switchMap,\n    takeUntil,\n    tap,\n} from 'rxjs/operators';\n\n@Directive({\n    selector: 'tui-hosted-dropdown[tuiDropdownHover]',\n    providers: [TuiDestroyService],\n})\nexport class TuiDropdownHoverDirective {\n    constructor(\n        @Inject(TuiDestroyService) destroy$: Observable<void>,\n        @Inject(ElementRef) {nativeElement}: ElementRef<HTMLElement>,\n        @Inject(TuiHostedDropdownComponent)\n        private readonly dropdown: TuiHostedDropdownComponent,\n    ) {\n        const dropdown$ = dropdown.openChange.pipe(\n            // Give change detection time to open dropdown\n            debounceTime(0),\n            map(() => dropdown.dropdown),\n            filter(isPresent),\n            share(),\n        );\n\n        const open$ = merge(\n            typedFromEvent(nativeElement, 'mouseenter'),\n            typedFromEvent(nativeElement, 'click').pipe(\n                tap(e => e.stopImmediatePropagation()),\n            ),\n            dropdown$.pipe(\n                switchMap(element =>\n                    merge(\n                        typedFromEvent(element, 'focusin'),\n                        typedFromEvent(element, 'mouseenter'),\n                    ),\n                ),\n            ),\n        ).pipe(mapTo(true));\n\n        const close$ = merge(\n            typedFromEvent(nativeElement, 'mouseleave'),\n            dropdown$.pipe(\n                switchMap(element =>\n                    typedFromEvent(element, 'mouseleave').pipe(\n                        filter(() => !isNativeFocusedIn(element)),\n                    ),\n                ),\n            ),\n        ).pipe(mapTo(false));\n\n        merge(open$, close$)\n            .pipe(\n                debounce(value => (value ? of(value) : timer(300))),\n                distinctUntilChanged(),\n                takeUntil(destroy$),\n            )\n            .subscribe(open => {\n                dropdown.updateOpen(open);\n            });\n    }\n\n    @HostListener('mouseenter')\n    onMouseEnter(): void {\n        const {host} = this.dropdown;\n\n        if (isNativeFocusedIn(host)) {\n            return;\n        }\n\n        const focusable = getClosestFocusable(host, false, host, false);\n\n        if (focusable) {\n            setNativeMouseFocused(focusable);\n        }\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiDropdownHoverDirective} from './dropdown-hover.directive';\n\n@NgModule({\n    declarations: [TuiDropdownHoverDirective],\n    exports: [TuiDropdownHoverDirective],\n})\nexport class TuiDropdownHoverModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;IA4Ba,yBAAyB,GAAtC,MAAa,yBAAyB;IAClC,YAC+B,QAA0B,EACjC,EAAC,aAAa,EAA0B,EAE3C,QAAoC;QAApC,aAAQ,GAAR,QAAQ,CAA4B;QAErD,MAAM,SAAS,GAAG,QAAQ,CAAC,UAAU,CAAC,IAAI;;QAEtC,YAAY,CAAC,CAAC,CAAC,EACf,GAAG,CAAC,MAAM,QAAQ,CAAC,QAAQ,CAAC,EAC5B,MAAM,CAAC,SAAS,CAAC,EACjB,KAAK,EAAE,CACV,CAAC;QAEF,MAAM,KAAK,GAAG,KAAK,CACf,cAAc,CAAC,aAAa,EAAE,YAAY,CAAC,EAC3C,cAAc,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC,IAAI,CACvC,GAAG,CAAC,CAAC,IAAI,CAAC,CAAC,wBAAwB,EAAE,CAAC,CACzC,EACD,SAAS,CAAC,IAAI,CACV,SAAS,CAAC,OAAO,IACb,KAAK,CACD,cAAc,CAAC,OAAO,EAAE,SAAS,CAAC,EAClC,cAAc,CAAC,OAAO,EAAE,YAAY,CAAC,CACxC,CACJ,CACJ,CACJ,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC,CAAC;QAEpB,MAAM,MAAM,GAAG,KAAK,CAChB,cAAc,CAAC,aAAa,EAAE,YAAY,CAAC,EAC3C,SAAS,CAAC,IAAI,CACV,SAAS,CAAC,OAAO,IACb,cAAc,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC,IAAI,CACtC,MAAM,CAAC,MAAM,CAAC,iBAAiB,CAAC,OAAO,CAAC,CAAC,CAC5C,CACJ,CACJ,CACJ,CAAC,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,CAAC;QAErB,KAAK,CAAC,KAAK,EAAE,MAAM,CAAC;aACf,IAAI,CACD,QAAQ,CAAC,KAAK,KAAK,KAAK,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,EACnD,oBAAoB,EAAE,EACtB,SAAS,CAAC,QAAQ,CAAC,CACtB;aACA,SAAS,CAAC,IAAI;YACX,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;SAC7B,CAAC,CAAC;KACV;IAGD,YAAY;QACR,MAAM,EAAC,IAAI,EAAC,GAAG,IAAI,CAAC,QAAQ,CAAC;QAE7B,IAAI,iBAAiB,CAAC,IAAI,CAAC,EAAE;YACzB,OAAO;SACV;QAED,MAAM,SAAS,GAAG,mBAAmB,CAAC,IAAI,EAAE,KAAK,EAAE,IAAI,EAAE,KAAK,CAAC,CAAC;QAEhE,IAAI,SAAS,EAAE;YACX,qBAAqB,CAAC,SAAS,CAAC,CAAC;SACpC;KACJ;EACJ;;YAhE4C,UAAU,uBAA9C,MAAM,SAAC,iBAAiB;YACY,UAAU,uBAA9C,MAAM,SAAC,UAAU;YAES,0BAA0B,uBADpD,MAAM,SAAC,0BAA0B;;AAiDtC;IADC,YAAY,CAAC,YAAY,CAAC;6DAa1B;AAjEQ,yBAAyB;IAJrC,SAAS,CAAC;QACP,QAAQ,EAAE,uCAAuC;QACjD,SAAS,EAAE,CAAC,iBAAiB,CAAC;KACjC,CAAC;IAGO,WAAA,MAAM,CAAC,iBAAiB,CAAC,CAAA;IACzB,WAAA,MAAM,CAAC,UAAU,CAAC,CAAA;IAClB,WAAA,MAAM,CAAC,0BAA0B,CAAC,CAAA;GAJ9B,yBAAyB,CAkErC;;ICtFY,sBAAsB,GAAnC,MAAa,sBAAsB;EAAG;AAAzB,sBAAsB;IAJlC,QAAQ,CAAC;QACN,YAAY,EAAE,CAAC,yBAAyB,CAAC;QACzC,OAAO,EAAE,CAAC,yBAAyB,CAAC;KACvC,CAAC;GACW,sBAAsB,CAAG;;ACRtC;;;;;;"}