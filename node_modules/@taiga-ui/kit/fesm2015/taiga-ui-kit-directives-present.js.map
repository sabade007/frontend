{"version":3,"file":"taiga-ui-kit-directives-present.js","sources":["ng://@taiga-ui/kit/directives/present/present.directive.ts","ng://@taiga-ui/kit/directives/present/present.module.ts","ng://@taiga-ui/kit/directives/present/taiga-ui-kit-directives-present.ts"],"sourcesContent":["import {\n    Directive,\n    ElementRef,\n    HostListener,\n    Inject,\n    OnDestroy,\n    Output,\n} from '@angular/core';\nimport {USER_AGENT} from '@ng-web-apis/common';\nimport {isCurrentTarget, isFirefox} from '@taiga-ui/cdk';\nimport {BehaviorSubject} from 'rxjs';\nimport {distinctUntilChanged, skip} from 'rxjs/operators';\n\n@Directive({\n    selector: '[tuiPresentChange]',\n    host: {\n        '[style.animation]': '\"tuiPresent 1s infinite\"',\n    },\n})\nexport class TuiPresentDirective implements OnDestroy {\n    private readonly visibility$ = new BehaviorSubject(false);\n\n    @Output()\n    readonly tuiPresentChange = this.visibility$.pipe(distinctUntilChanged(), skip(1));\n\n    constructor(\n        @Inject(ElementRef) {nativeElement}: ElementRef<HTMLElement>,\n        @Inject(USER_AGENT) userAgent: string,\n    ) {\n        if (isFirefox(userAgent)) {\n            return;\n        }\n\n        const observer = new MutationObserver(() => {\n            if (\n                !nativeElement.offsetParent &&\n                nativeElement.offsetWidth === 0 &&\n                nativeElement.offsetHeight === 0\n            ) {\n                this.visibility$.next(false);\n            }\n        });\n\n        observer.observe(nativeElement, {\n            attributes: true,\n            attributeFilter: ['style', 'class'],\n        });\n    }\n\n    /**\n     * Someday animationcancel would work and mutation observer would not be needed:\n     * https://drafts.csswg.org/css-animations/#eventdef-animationevent-animationcancel\n     * It would also trigger on CSS like display: none on parent nodes which is awesome\n     * but currently only works in Firefox\n     * ___\n     * TODO: remove MutationObserver when we bump versions of supported browsers:\n     *** Safari 12+\n     *** Chrome 83+\n     * See: {@link https://caniuse.com/mdn-api_window_animationcancel_event}\n     */\n    @HostListener('animationcancel', ['$event', 'false'])\n    @HostListener('animationstart', ['$event', 'true'])\n    onAnimation(event: Event, visibility: boolean): void {\n        if (isCurrentTarget(event)) {\n            this.visibility$.next(visibility);\n        }\n    }\n\n    ngOnDestroy(): void {\n        this.visibility$.next(false);\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiPresentDirective} from './present.directive';\n\n@NgModule({\n    declarations: [TuiPresentDirective],\n    exports: [TuiPresentDirective],\n})\nexport class TuiPresentModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;IAmBa,mBAAmB,GAAhC,MAAa,mBAAmB;IAM5B,YACwB,EAAC,aAAa,EAA0B,EACxC,SAAiB;QAPxB,gBAAW,GAAG,IAAI,eAAe,CAAC,KAAK,CAAC,CAAC;QAGjD,qBAAgB,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,oBAAoB,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC,CAAC,CAAC;QAM/E,IAAI,SAAS,CAAC,SAAS,CAAC,EAAE;YACtB,OAAO;SACV;QAED,MAAM,QAAQ,GAAG,IAAI,gBAAgB,CAAC;YAClC,IACI,CAAC,aAAa,CAAC,YAAY;gBAC3B,aAAa,CAAC,WAAW,KAAK,CAAC;gBAC/B,aAAa,CAAC,YAAY,KAAK,CAAC,EAClC;gBACE,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;aAChC;SACJ,CAAC,CAAC;QAEH,QAAQ,CAAC,OAAO,CAAC,aAAa,EAAE;YAC5B,UAAU,EAAE,IAAI;YAChB,eAAe,EAAE,CAAC,OAAO,EAAE,OAAO,CAAC;SACtC,CAAC,CAAC;KACN;;;;;;;;;;;;IAeD,WAAW,CAAC,KAAY,EAAE,UAAmB;QACzC,IAAI,eAAe,CAAC,KAAK,CAAC,EAAE;YACxB,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,UAAU,CAAC,CAAC;SACrC;KACJ;IAED,WAAW;QACP,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC;KAChC;EACJ;;YA7C4C,UAAU,uBAA9C,MAAM,SAAC,UAAU;yCACjB,MAAM,SAAC,UAAU;;AAJtB;IADC,MAAM,EAAE;6DAC0E;AAuCnF;IAFC,YAAY,CAAC,iBAAiB,EAAE,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;IACpD,YAAY,CAAC,gBAAgB,EAAE,CAAC,QAAQ,EAAE,MAAM,CAAC,CAAC;sDAKlD;AA/CQ,mBAAmB;IAN/B,SAAS,CAAC;QACP,QAAQ,EAAE,oBAAoB;QAC9B,IAAI,EAAE;YACF,mBAAmB,EAAE,0BAA0B;SAClD;KACJ,CAAC;IAQO,WAAA,MAAM,CAAC,UAAU,CAAC,CAAA;IAClB,WAAA,MAAM,CAAC,UAAU,CAAC,CAAA;GARd,mBAAmB,CAoD/B;;IC/DY,gBAAgB,GAA7B,MAAa,gBAAgB;EAAG;AAAnB,gBAAgB;IAJ5B,QAAQ,CAAC;QACN,YAAY,EAAE,CAAC,mBAAmB,CAAC;QACnC,OAAO,EAAE,CAAC,mBAAmB,CAAC;KACjC,CAAC;GACW,gBAAgB,CAAG;;ACRhC;;;;;;"}