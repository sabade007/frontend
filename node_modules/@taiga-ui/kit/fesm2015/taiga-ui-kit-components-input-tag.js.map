{"version":3,"file":"taiga-ui-kit-components-input-tag.js","sources":["ng://@taiga-ui/kit/components/input-tag/input-tag-options.ts","ng://@taiga-ui/kit/components/input-tag/input-tag.component.ts","ng://@taiga-ui/kit/components/input-tag/input-tag.module.ts","ng://@taiga-ui/kit/components/input-tag/taiga-ui-kit-components-input-tag.ts"],"sourcesContent":["import {InjectionToken} from '@angular/core';\n\nexport interface TuiInputTagOptions {\n    readonly separator: RegExp | string;\n    readonly uniqueTags: boolean;\n}\n\nexport const TUI_INPUT_TAG_DEFAULT_OPTIONS: TuiInputTagOptions = {\n    separator: `,`,\n    uniqueTags: true,\n};\n\nexport const TUI_INPUT_TAG_OPTIONS = new InjectionToken<TuiInputTagOptions>(\n    `Default parameters for input-tag`,\n    {\n        factory: () => TUI_INPUT_TAG_DEFAULT_OPTIONS,\n    },\n);\n","import {\n    ChangeDetectionStrategy,\n    ChangeDetectorRef,\n    Component,\n    ContentChild,\n    ElementRef,\n    EventEmitter,\n    forwardRef,\n    HostBinding,\n    Inject,\n    Input,\n    Optional,\n    Output,\n    QueryList,\n    Self,\n    TemplateRef,\n    ViewChild,\n    ViewChildren,\n} from '@angular/core';\nimport {NgControl} from '@angular/forms';\nimport {\n    AbstractTuiMultipleControl,\n    ALWAYS_FALSE_HANDLER,\n    ALWAYS_TRUE_HANDLER,\n    EMPTY_QUERY,\n    getActualTarget,\n    isNativeFocusedIn,\n    preventDefault,\n    setNativeFocused,\n    TUI_FOCUSABLE_ITEM_ACCESSOR,\n    TuiActiveZoneDirective,\n    TuiBooleanHandler,\n    TuiContextWithImplicit,\n    tuiDefaultProp,\n    TuiFocusableElementAccessor,\n    TuiScrollService,\n    typedFromEvent,\n} from '@taiga-ui/cdk';\nimport {\n    HINT_CONTROLLER_PROVIDER,\n    MODE_PROVIDER,\n    TEXTFIELD_CONTROLLER_PROVIDER,\n    TUI_DATA_LIST_HOST,\n    TUI_HINT_WATCHED_CONTROLLER,\n    TUI_MODE,\n    TUI_TEXTFIELD_APPEARANCE,\n    TUI_TEXTFIELD_WATCHED_CONTROLLER,\n    TuiBrightness,\n    TuiDataListDirective,\n    TuiDataListHost,\n    TuiHintControllerDirective,\n    TuiHorizontalDirection,\n    TuiHostedDropdownComponent,\n    TuiModeDirective,\n    TuiScrollbarComponent,\n    TuiSizeL,\n    TuiSizeS,\n    TuiTextfieldController,\n} from '@taiga-ui/core';\nimport {TuiStringifiableItem} from '@taiga-ui/kit/classes';\nimport {ALLOWED_SPACE_REGEXP} from '@taiga-ui/kit/components/tag';\nimport {FIXED_DROPDOWN_CONTROLLER_PROVIDER} from '@taiga-ui/kit/providers';\nimport {TUI_TAG_STATUS} from '@taiga-ui/kit/tokens';\nimport {TuiStatusT} from '@taiga-ui/kit/types';\nimport {PolymorpheusContent} from '@tinkoff/ng-polymorpheus';\nimport {merge, Observable, Subject} from 'rxjs';\nimport {filter, map, mapTo, switchMap, takeUntil} from 'rxjs/operators';\n\nimport {TUI_INPUT_TAG_OPTIONS, TuiInputTagOptions} from './input-tag-options';\n\nconst EVENT_Y_TO_X_COEFFICIENT = 3;\n\n@Component({\n    selector: 'tui-input-tag',\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    templateUrl: './input-tag.template.html',\n    styleUrls: ['./input-tag.style.less'],\n    providers: [\n        {\n            provide: TUI_FOCUSABLE_ITEM_ACCESSOR,\n            useExisting: forwardRef(() => TuiInputTagComponent),\n        },\n        {\n            provide: TUI_DATA_LIST_HOST,\n            useExisting: forwardRef(() => TuiInputTagComponent),\n        },\n        FIXED_DROPDOWN_CONTROLLER_PROVIDER,\n        TEXTFIELD_CONTROLLER_PROVIDER,\n        HINT_CONTROLLER_PROVIDER,\n        MODE_PROVIDER,\n    ],\n})\nexport class TuiInputTagComponent\n    extends AbstractTuiMultipleControl<string>\n    implements TuiFocusableElementAccessor, TuiDataListHost<string>\n{\n    @ViewChild(TuiHostedDropdownComponent)\n    private readonly hostedDropdown?: TuiHostedDropdownComponent;\n\n    @ViewChild('focusableElement')\n    private readonly focusableElement?: ElementRef<HTMLInputElement>;\n\n    @ViewChild('tagsContainer')\n    private readonly tagsContainer?: ElementRef<HTMLElement>;\n\n    @ViewChildren('tag', {read: ElementRef})\n    private readonly tags: QueryList<ElementRef<HTMLElement>> = EMPTY_QUERY;\n\n    @ViewChild('cleaner', {read: ElementRef})\n    private readonly cleanerSvg?: ElementRef<HTMLElement>;\n\n    @ViewChild(TuiScrollbarComponent, {read: ElementRef})\n    private readonly scrollBar?: ElementRef<HTMLElement>;\n\n    private readonly scrollToStart$ = new Subject<void>();\n    private readonly scrollToEnd$ = new Subject<void>();\n\n    // TODO: 3.0 Remove\n    @Input()\n    @tuiDefaultProp()\n    allowSpaces = true;\n\n    @Input()\n    @tuiDefaultProp()\n    separator: RegExp | string = this.options.separator;\n\n    @Input()\n    @tuiDefaultProp()\n    icon = '';\n\n    @Input()\n    @tuiDefaultProp()\n    iconAlign: TuiHorizontalDirection = 'right';\n\n    @Input()\n    @tuiDefaultProp()\n    search = '';\n\n    @Input()\n    @tuiDefaultProp()\n    editable = true;\n\n    @Input()\n    @tuiDefaultProp()\n    tagValidator:\n        | TuiBooleanHandler<string>\n        | TuiBooleanHandler<TuiStringifiableItem<unknown> | string> = ALWAYS_TRUE_HANDLER;\n\n    @Input()\n    @HostBinding('class._expandable')\n    @tuiDefaultProp()\n    expandable = true;\n\n    @Input()\n    @tuiDefaultProp()\n    inputHidden = false;\n\n    @Input()\n    @tuiDefaultProp()\n    uniqueTags = this.options.uniqueTags;\n\n    @Input()\n    @tuiDefaultProp()\n    disabledItemHandler: TuiBooleanHandler<TuiStringifiableItem<any> | string> =\n        ALWAYS_FALSE_HANDLER;\n\n    @Input('pseudoFocused')\n    set pseudoFocusedSetter(value: boolean | null) {\n        if (!value && !this.focused) {\n            this.scrollToStart$.next();\n        }\n\n        this.pseudoFocused = value;\n    }\n\n    @Output()\n    readonly searchChange = new EventEmitter<string>();\n\n    @ContentChild(TuiDataListDirective, {read: TemplateRef})\n    readonly datalist?: TemplateRef<TuiContextWithImplicit<TuiActiveZoneDirective>>;\n\n    @ViewChild('errorIcon')\n    readonly errorIconTemplate?: TemplateRef<Record<string, unknown>>;\n\n    @ViewChild(TuiScrollbarComponent)\n    set scrollerSetter(scroller: TuiScrollbarComponent | null) {\n        this.initScrollerSubscription(scroller);\n    }\n\n    status$: Observable<TuiStatusT> = this.mode$.pipe(map(() => this.status));\n\n    open = false;\n\n    constructor(\n        @Optional()\n        @Self()\n        @Inject(NgControl)\n        control: NgControl | null,\n        @Inject(ChangeDetectorRef) changeDetectorRef: ChangeDetectorRef,\n        @Inject(TuiScrollService) private readonly tuiScrollService: TuiScrollService,\n        @Inject(ElementRef) private readonly elementRef: ElementRef<HTMLElement>,\n        @Inject(TUI_TEXTFIELD_APPEARANCE) readonly appearance: string,\n        @Optional()\n        @Inject(TuiModeDirective)\n        private readonly modeDirective: TuiModeDirective | null,\n        @Inject(TUI_MODE)\n        private readonly mode$: Observable<TuiBrightness | null>,\n        @Inject(TUI_TAG_STATUS) private readonly tagStatus: TuiStatusT,\n        @Inject(TUI_HINT_WATCHED_CONTROLLER)\n        readonly hintController: TuiHintControllerDirective,\n        @Inject(TUI_TEXTFIELD_WATCHED_CONTROLLER)\n        readonly controller: TuiTextfieldController,\n        @Inject(TUI_INPUT_TAG_OPTIONS)\n        private readonly options: TuiInputTagOptions,\n        @Optional()\n        @Inject(TuiHostedDropdownComponent)\n        private readonly parentHostedDropdown?: TuiHostedDropdownComponent,\n    ) {\n        super(control, changeDetectorRef);\n    }\n\n    get nativeFocusableElement(): HTMLInputElement | null {\n        return !this.focusableElement || this.computedDisabled\n            ? null\n            : this.focusableElement.nativeElement;\n    }\n\n    get focused(): boolean {\n        return (\n            isNativeFocusedIn(this.elementRef.nativeElement) ||\n            !!this.hostedDropdown?.focused\n        );\n    }\n\n    @HostBinding('attr.data-size')\n    get size(): TuiSizeL | TuiSizeS {\n        return this.controller.size;\n    }\n\n    @HostBinding('class._label-outside')\n    get labelOutside(): boolean {\n        const {size, labelOutside} = this.controller;\n\n        return size === 's' || labelOutside;\n    }\n\n    get hasCleaner(): boolean {\n        return this.controller.cleaner && this.hasValue && this.interactive;\n    }\n\n    get hasNativeValue(): boolean {\n        return !!this.search;\n    }\n\n    get hasValue(): boolean {\n        return !!this.value.length || this.hasNativeValue;\n    }\n\n    get hasPlaceholder(): boolean {\n        return (\n            !this.labelOutside ||\n            (!this.hasValue && (!this.hasExampleText || this.inputHidden))\n        );\n    }\n\n    get placeholderRaised(): boolean {\n        return (\n            !this.labelOutside &&\n            ((this.computedFocused && !this.readOnly) || this.hasValue)\n        );\n    }\n\n    get hasExampleText(): boolean {\n        return (\n            !!this.controller.exampleText &&\n            this.computedFocused &&\n            !this.hasValue &&\n            !this.readOnly\n        );\n    }\n\n    get hasTooltip(): boolean {\n        return !!this.hintController.content && !this.disabled;\n    }\n\n    get iconAlignLeft(): boolean {\n        return !!this.icon && this.iconAlign === 'left';\n    }\n\n    get iconAlignRight(): boolean {\n        return !!this.icon && this.iconAlign === 'right';\n    }\n\n    get hasRightIcons(): boolean {\n        return this.hasCleaner || this.hasTooltip || this.iconAlignRight;\n    }\n\n    get status(): TuiStatusT {\n        return this.modeDirective?.mode ? 'default' : this.tagStatus;\n    }\n\n    get canOpen(): boolean {\n        return this.interactive && !!this.datalist;\n    }\n\n    getLeftContent(tag: string): PolymorpheusContent {\n        return !this.tagValidator(tag) && this.errorIconTemplate\n            ? this.errorIconTemplate\n            : '';\n    }\n\n    onCleanerClick(): void {\n        this.updateSearch('');\n        this.clear();\n        this.focusInput();\n        this.parentHostedDropdown?.updateOpen(true);\n    }\n\n    onActiveZone(active: boolean): void {\n        this.open = false;\n        this.addTag();\n        this.updateFocused(active);\n\n        if (!this.computedFocused) {\n            this.scrollToStart$.next();\n        }\n    }\n\n    onMouseDown(event: MouseEvent): void {\n        const actualTarget = getActualTarget(event);\n\n        if (\n            !this.focusableElement ||\n            actualTarget === this.focusableElement.nativeElement ||\n            // TODO: iframe warning\n            !(event.target instanceof Element) ||\n            this.cleanerSvg?.nativeElement.contains(event.target) ||\n            (this.tagsContainer &&\n                actualTarget !== this.tagsContainer.nativeElement &&\n                this.tagsContainer.nativeElement.contains(actualTarget))\n        ) {\n            return;\n        }\n\n        event.preventDefault();\n        this.focusInput();\n    }\n\n    onFieldKeyDownBackspace(event: Event): void {\n        if (!this.labelOutside && !this.hasNativeValue && this.value.length) {\n            this.deleteLastEnabledItem();\n        } else {\n            this.onFieldKeyDownArrowLeft(event);\n        }\n    }\n\n    onFieldKeyDownArrowLeft(event: Event): void {\n        if (!this.labelOutside || this.hasNativeValue || !this.value.length) {\n            return;\n        }\n\n        event.preventDefault();\n        setNativeFocused(this.tags.last.nativeElement);\n    }\n\n    onFieldKeyDownEnter(): void {\n        this.addTag();\n        this.scrollToEnd$.next();\n    }\n\n    onTagKeyDownArrowLeft(currentIndex: number): void {\n        if (currentIndex > 0) {\n            this.onScrollKeyDown(currentIndex, -1);\n        }\n    }\n\n    onTagKeyDownArrowRight(currentIndex: number): void {\n        if (currentIndex === this.value.length - 1) {\n            this.focusInput();\n        } else {\n            this.onScrollKeyDown(currentIndex, 1);\n        }\n    }\n\n    onTagEdited(value: string, index: number): void {\n        this.focusInput();\n        this.updateValue(\n            this.value\n                .map((tag, tagIndex) =>\n                    tagIndex !== index\n                        ? tag\n                        : value\n                              .split(this.separator)\n                              .map(tag => tag.trim())\n                              .filter(Boolean),\n                )\n                .reduce<string[]>(\n                    (result, item: string[] | string) => result.concat(item),\n                    [],\n                ),\n        );\n    }\n\n    handleOption(item: string): void {\n        this.focusInput();\n        this.updateSearch('');\n        this.updateValue(this.value.concat(item));\n        this.open = false;\n        this.scrollToEnd$.next();\n    }\n\n    onInput(value: string): void {\n        const array = this.allowSpaces\n            ? value.split(this.separator)\n            : value.split(ALLOWED_SPACE_REGEXP);\n        const tags = array\n            .map(item => item.trim())\n            .filter((item, index, {length}) => item.length > 0 && index !== length - 1);\n        const validated = tags.filter(tag => !this.disabledItemHandler(tag));\n\n        if (array.length > 1) {\n            this.updateSearch(array[array.length - 1].trim());\n            this.updateValue([...this.value, ...validated]);\n        } else {\n            this.updateSearch(value);\n        }\n\n        this.open = this.hasNativeValue;\n    }\n\n    onHoveredChange(hovered: boolean): void {\n        this.updateHovered(hovered);\n    }\n\n    setDisabledState(): void {\n        super.setDisabledState();\n        this.open = false;\n    }\n\n    trackByFn(_: number, tag: string): string {\n        // Actually tag has TuiStringifiableItem type not string\n        return tag.toString();\n    }\n\n    protected updateValue(value: string[]): void {\n        const seen = new Set();\n\n        super.updateValue(\n            value\n                .reverse()\n                .filter(\n                    item =>\n                        !this.uniqueTags || (!!item && !seen.has(item) && seen.add(item)),\n                )\n                .reverse(),\n        );\n    }\n\n    private onScrollKeyDown(currentIndex: number, flag: number): void {\n        const tag = this.tags.find((_item, index) => index === currentIndex + flag);\n\n        if (!tag || !this.scrollBar) {\n            return;\n        }\n\n        setNativeFocused(tag.nativeElement);\n\n        if (\n            flag * this.scrollBar.nativeElement.clientWidth -\n                flag * tag.nativeElement.offsetLeft -\n                tag.nativeElement.clientWidth <\n            0\n        ) {\n            this.scrollBar.nativeElement.scrollLeft +=\n                flag * tag.nativeElement.clientWidth;\n        }\n    }\n\n    private initScrollerSubscription(scroller: TuiScrollbarComponent | null): void {\n        if (!scroller?.browserScrollRef) {\n            return;\n        }\n\n        const {nativeElement} = scroller.browserScrollRef;\n\n        const wheel$ = typedFromEvent(nativeElement, 'wheel', {passive: false}).pipe(\n            filter(event => event.deltaX === 0 && this.shouldScroll(nativeElement)),\n            preventDefault(),\n            map(({deltaY}) =>\n                Math.max(nativeElement.scrollLeft + deltaY * EVENT_Y_TO_X_COEFFICIENT, 0),\n            ),\n        );\n        const start$ = this.scrollToStart$.pipe(mapTo(0));\n        const end$ = this.scrollToEnd$.pipe(map(() => nativeElement.scrollWidth));\n\n        merge(wheel$, start$, end$)\n            .pipe(\n                switchMap(left => this.tuiScrollService.scroll$(nativeElement, 0, left)),\n                takeUntil(this.destroy$),\n            )\n            .subscribe();\n    }\n\n    private updateSearch(value: string): void {\n        if (this.focusableElement) {\n            this.focusableElement.nativeElement.value = value;\n        }\n\n        this.search = value;\n        this.searchChange.emit(value);\n    }\n\n    private shouldScroll({scrollWidth, offsetWidth}: HTMLElement): boolean {\n        return scrollWidth > offsetWidth;\n    }\n\n    private addTag(): void {\n        const inputValue = this.search.trim();\n\n        if (!inputValue || this.disabledItemHandler(inputValue)) {\n            return;\n        }\n\n        this.updateSearch('');\n        this.updateValue(this.value.concat(inputValue));\n    }\n\n    private deleteLastEnabledItem(): void {\n        for (let index = this.value.length - 1; index >= 0; index--) {\n            if (!this.disabledItemHandler(this.value[index])) {\n                this.updateValue([\n                    ...this.value.slice(0, index),\n                    ...this.value.slice(index + 1, this.value.length),\n                ]);\n\n                break;\n            }\n        }\n    }\n\n    private focusInput(preventScroll: boolean = false): void {\n        if (this.nativeFocusableElement) {\n            setNativeFocused(this.nativeFocusableElement, true, preventScroll);\n        }\n    }\n}\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {FormsModule} from '@angular/forms';\nimport {\n    TuiActiveZoneModule,\n    TuiFocusableModule,\n    TuiHoveredModule,\n    TuiScrollService,\n} from '@taiga-ui/cdk';\nimport {\n    TuiHostedDropdownModule,\n    TuiScrollbarModule,\n    TuiSvgModule,\n    TuiTooltipModule,\n    TuiWrapperModule,\n} from '@taiga-ui/core';\nimport {TuiTagModule} from '@taiga-ui/kit/components/tag';\nimport {PolymorpheusModule} from '@tinkoff/ng-polymorpheus';\n\nimport {TuiInputTagComponent} from './input-tag.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        PolymorpheusModule,\n        TuiFocusableModule,\n        TuiHoveredModule,\n        TuiActiveZoneModule,\n        TuiSvgModule,\n        TuiScrollbarModule,\n        TuiTooltipModule,\n        TuiHostedDropdownModule,\n        TuiTagModule,\n        TuiWrapperModule,\n    ],\n    providers: [TuiScrollService],\n    declarations: [TuiInputTagComponent],\n    exports: [TuiInputTagComponent],\n})\nexport class TuiInputTagModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}