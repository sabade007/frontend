import { __decorate, __param } from "tslib";
import { ChangeDetectionStrategy, Component, Inject, Input, Optional, ViewChild, } from '@angular/core';
import { Subject } from 'rxjs';
import { distinctUntilChanged, map, startWith } from 'rxjs/operators';
import { TuiTreeChildrenDirective } from '../../directives/tree-children.directive';
import { TUI_TREE_NODE } from '../../misc/tree.tokens';
import { TuiTreeItemComponent } from '../tree-item/tree-item.component';
var TuiTreeComponent = /** @class */ (function () {
    function TuiTreeComponent(directive) {
        var _this = this;
        this.directive = directive;
        this.check$ = new Subject();
        this.children$ = this.check$.pipe(startWith(null), map(function () { return _this.handler(_this.value); }), distinctUntilChanged());
        this.content = function (_a) {
            var $implicit = _a.$implicit;
            return String($implicit);
        };
    }
    TuiTreeComponent_1 = TuiTreeComponent;
    TuiTreeComponent.prototype.ngDoCheck = function () {
        var _a, _b;
        this.check$.next();
        (_a = this.item) === null || _a === void 0 ? void 0 : _a.ngDoCheck();
        (_b = this.child) === null || _b === void 0 ? void 0 : _b.ngDoCheck();
    };
    Object.defineProperty(TuiTreeComponent.prototype, "handler", {
        get: function () {
            var _a, _b;
            return (_b = (_a = this.directive) === null || _a === void 0 ? void 0 : _a.childrenHandler) !== null && _b !== void 0 ? _b : TuiTreeChildrenDirective.defaultHandler;
        },
        enumerable: true,
        configurable: true
    });
    var TuiTreeComponent_1;
    TuiTreeComponent.ctorParameters = function () { return [
        { type: TuiTreeChildrenDirective, decorators: [{ type: Optional }, { type: Inject, args: [TuiTreeChildrenDirective,] }] }
    ]; };
    __decorate([
        Input()
    ], TuiTreeComponent.prototype, "value", void 0);
    __decorate([
        ViewChild(TuiTreeItemComponent)
    ], TuiTreeComponent.prototype, "item", void 0);
    __decorate([
        ViewChild(TuiTreeComponent_1)
    ], TuiTreeComponent.prototype, "child", void 0);
    __decorate([
        Input()
    ], TuiTreeComponent.prototype, "content", void 0);
    TuiTreeComponent = TuiTreeComponent_1 = __decorate([
        Component({
            selector: 'tui-tree[value]',
            template: "<tui-tree-item\n    *tuiLet=\"children$ | async as children\"\n    #view\n    [tuiTreeNode]=\"value\"\n>\n    <div\n        *ngIf=\"$any(value) !== children\"\n        polymorpheus-outlet\n        [content]=\"content\"\n        [context]=\"{$implicit: value, node: view}\"\n    ></div>\n    <tui-tree\n        *ngFor=\"let child of children\"\n        [value]=\"child\"\n        [content]=\"content\"\n    ></tui-tree>\n</tui-tree-item>\n",
            changeDetection: ChangeDetectionStrategy.OnPush,
            providers: [
                {
                    provide: TUI_TREE_NODE,
                    useExisting: TuiTreeComponent_1,
                },
            ],
            host: {
                role: 'tree',
            },
            styles: [":host{position:relative;display:block}"]
        }),
        __param(0, Optional()),
        __param(0, Inject(TuiTreeChildrenDirective))
    ], TuiTreeComponent);
    return TuiTreeComponent;
}());
export { TuiTreeComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJlZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGFpZ2EtdWkva2l0L2NvbXBvbmVudHMvdHJlZS8iLCJzb3VyY2VzIjpbImNvbXBvbmVudHMvdHJlZS90cmVlLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUNILHVCQUF1QixFQUN2QixTQUFTLEVBRVQsTUFBTSxFQUNOLEtBQUssRUFDTCxRQUFRLEVBQ1IsU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBR3ZCLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxNQUFNLENBQUM7QUFDN0IsT0FBTyxFQUFDLG9CQUFvQixFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUVwRSxPQUFPLEVBQUMsd0JBQXdCLEVBQUMsTUFBTSwwQ0FBMEMsQ0FBQztBQUVsRixPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sd0JBQXdCLENBQUM7QUFDckQsT0FBTyxFQUFDLG9CQUFvQixFQUFDLE1BQU0sa0NBQWtDLENBQUM7QUFpQnRFO0lBa0JJLDBCQUdhLFNBQTZDO1FBSDFELGlCQUlJO1FBRFMsY0FBUyxHQUFULFNBQVMsQ0FBb0M7UUFwQnpDLFdBQU0sR0FBRyxJQUFJLE9BQU8sRUFBUSxDQUFDO1FBV3JDLGNBQVMsR0FBRyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDakMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUNmLEdBQUcsQ0FBQyxjQUFNLE9BQUEsS0FBSSxDQUFDLE9BQU8sQ0FBQyxLQUFJLENBQUMsS0FBSyxDQUFDLEVBQXhCLENBQXdCLENBQUMsRUFDbkMsb0JBQW9CLEVBQUUsQ0FDekIsQ0FBQztRQVNGLFlBQU8sR0FBMkMsVUFBQyxFQUFXO2dCQUFWLHdCQUFTO1lBQU0sT0FBQSxNQUFNLENBQUMsU0FBUyxDQUFDO1FBQWpCLENBQWlCLENBQUM7SUFIbEYsQ0FBQzt5QkF0QkssZ0JBQWdCO0lBMkJ6QixvQ0FBUyxHQUFUOztRQUNJLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbkIsTUFBQSxJQUFJLENBQUMsSUFBSSwwQ0FBRSxTQUFTLEdBQUc7UUFDdkIsTUFBQSxJQUFJLENBQUMsS0FBSywwQ0FBRSxTQUFTLEdBQUc7SUFDNUIsQ0FBQztJQUVELHNCQUFZLHFDQUFPO2FBQW5COztZQUNJLG1CQUFPLElBQUksQ0FBQyxTQUFTLDBDQUFFLGVBQWUsbUNBQUksd0JBQXdCLENBQUMsY0FBYyxDQUFDO1FBQ3RGLENBQUM7OztPQUFBOzs7Z0JBZHVCLHdCQUF3Qix1QkFGM0MsUUFBUSxZQUNSLE1BQU0sU0FBQyx3QkFBd0I7O0lBaEJwQztRQURDLEtBQUssRUFBRTttREFDRTtJQUdWO1FBREMsU0FBUyxDQUFDLG9CQUFvQixDQUFDO2tEQUNLO0lBR3JDO1FBREMsU0FBUyxDQUFDLGtCQUFnQixDQUFDO21EQUNTO0lBZXJDO1FBREMsS0FBSyxFQUFFO3FEQUM2RTtJQXpCNUUsZ0JBQWdCO1FBZjVCLFNBQVMsQ0FBQztZQUNQLFFBQVEsRUFBRSxpQkFBaUI7WUFDM0Isa2NBQWlDO1lBRWpDLGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxNQUFNO1lBQy9DLFNBQVMsRUFBRTtnQkFDUDtvQkFDSSxPQUFPLEVBQUUsYUFBYTtvQkFDdEIsV0FBVyxFQUFFLGtCQUFnQjtpQkFDaEM7YUFDSjtZQUNELElBQUksRUFBRTtnQkFDRixJQUFJLEVBQUUsTUFBTTthQUNmOztTQUNKLENBQUM7UUFvQk8sV0FBQSxRQUFRLEVBQUUsQ0FBQTtRQUNWLFdBQUEsTUFBTSxDQUFDLHdCQUF3QixDQUFDLENBQUE7T0FwQjVCLGdCQUFnQixDQW9DNUI7SUFBRCx1QkFBQztDQUFBLEFBcENELElBb0NDO1NBcENZLGdCQUFnQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG4gICAgQ29tcG9uZW50LFxuICAgIERvQ2hlY2ssXG4gICAgSW5qZWN0LFxuICAgIElucHV0LFxuICAgIE9wdGlvbmFsLFxuICAgIFZpZXdDaGlsZCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1R1aUhhbmRsZXJ9IGZyb20gJ0B0YWlnYS11aS9jZGsnO1xuaW1wb3J0IHtQb2x5bW9ycGhldXNDb250ZW50fSBmcm9tICdAdGlua29mZi9uZy1wb2x5bW9ycGhldXMnO1xuaW1wb3J0IHtTdWJqZWN0fSBmcm9tICdyeGpzJztcbmltcG9ydCB7ZGlzdGluY3RVbnRpbENoYW5nZWQsIG1hcCwgc3RhcnRXaXRofSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7VHVpVHJlZUNoaWxkcmVuRGlyZWN0aXZlfSBmcm9tICcuLi8uLi9kaXJlY3RpdmVzL3RyZWUtY2hpbGRyZW4uZGlyZWN0aXZlJztcbmltcG9ydCB7VHVpVHJlZUNvbnRleHR9IGZyb20gJy4uLy4uL21pc2MvdHJlZS5pbnRlcmZhY2VzJztcbmltcG9ydCB7VFVJX1RSRUVfTk9ERX0gZnJvbSAnLi4vLi4vbWlzYy90cmVlLnRva2Vucyc7XG5pbXBvcnQge1R1aVRyZWVJdGVtQ29tcG9uZW50fSBmcm9tICcuLi90cmVlLWl0ZW0vdHJlZS1pdGVtLmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAndHVpLXRyZWVbdmFsdWVdJyxcbiAgICB0ZW1wbGF0ZVVybDogJ3RyZWUudGVtcGxhdGUuaHRtbCcsXG4gICAgc3R5bGVVcmxzOiBbJ3RyZWUuc3R5bGUubGVzcyddLFxuICAgIGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuICAgIHByb3ZpZGVyczogW1xuICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlOiBUVUlfVFJFRV9OT0RFLFxuICAgICAgICAgICAgdXNlRXhpc3Rpbmc6IFR1aVRyZWVDb21wb25lbnQsXG4gICAgICAgIH0sXG4gICAgXSxcbiAgICBob3N0OiB7XG4gICAgICAgIHJvbGU6ICd0cmVlJyxcbiAgICB9LFxufSlcbmV4cG9ydCBjbGFzcyBUdWlUcmVlQ29tcG9uZW50PFQ+IGltcGxlbWVudHMgRG9DaGVjayB7XG4gICAgcHJpdmF0ZSByZWFkb25seSBjaGVjayQgPSBuZXcgU3ViamVjdDx2b2lkPigpO1xuXG4gICAgQElucHV0KClcbiAgICB2YWx1ZSE6IFQ7XG5cbiAgICBAVmlld0NoaWxkKFR1aVRyZWVJdGVtQ29tcG9uZW50KVxuICAgIHJlYWRvbmx5IGl0ZW0/OiBUdWlUcmVlSXRlbUNvbXBvbmVudDtcblxuICAgIEBWaWV3Q2hpbGQoVHVpVHJlZUNvbXBvbmVudClcbiAgICByZWFkb25seSBjaGlsZD86IFR1aVRyZWVDb21wb25lbnQ8VD47XG5cbiAgICByZWFkb25seSBjaGlsZHJlbiQgPSB0aGlzLmNoZWNrJC5waXBlKFxuICAgICAgICBzdGFydFdpdGgobnVsbCksXG4gICAgICAgIG1hcCgoKSA9PiB0aGlzLmhhbmRsZXIodGhpcy52YWx1ZSkpLFxuICAgICAgICBkaXN0aW5jdFVudGlsQ2hhbmdlZCgpLFxuICAgICk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgQE9wdGlvbmFsKClcbiAgICAgICAgQEluamVjdChUdWlUcmVlQ2hpbGRyZW5EaXJlY3RpdmUpXG4gICAgICAgIHJlYWRvbmx5IGRpcmVjdGl2ZTogVHVpVHJlZUNoaWxkcmVuRGlyZWN0aXZlPFQ+IHwgbnVsbCxcbiAgICApIHt9XG5cbiAgICBASW5wdXQoKVxuICAgIGNvbnRlbnQ6IFBvbHltb3JwaGV1c0NvbnRlbnQ8VHVpVHJlZUNvbnRleHQ8VD4+ID0gKHskaW1wbGljaXR9KSA9PiBTdHJpbmcoJGltcGxpY2l0KTtcblxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jaGVjayQubmV4dCgpO1xuICAgICAgICB0aGlzLml0ZW0/Lm5nRG9DaGVjaygpO1xuICAgICAgICB0aGlzLmNoaWxkPy5uZ0RvQ2hlY2soKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldCBoYW5kbGVyKCk6IFR1aUhhbmRsZXI8VCwgcmVhZG9ubHkgVFtdPiB7XG4gICAgICAgIHJldHVybiB0aGlzLmRpcmVjdGl2ZT8uY2hpbGRyZW5IYW5kbGVyID8/IFR1aVRyZWVDaGlsZHJlbkRpcmVjdGl2ZS5kZWZhdWx0SGFuZGxlcjtcbiAgICB9XG59XG4iXX0=