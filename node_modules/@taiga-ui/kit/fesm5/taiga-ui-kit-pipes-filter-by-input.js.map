{"version":3,"file":"taiga-ui-kit-pipes-filter-by-input.js","sources":["ng://@taiga-ui/kit/pipes/filter-by-input/filter-by-input.base.ts","ng://@taiga-ui/kit/pipes/filter-by-input/filter-by-input.pipe.ts","ng://@taiga-ui/kit/pipes/filter-by-input/filter-by-input-with.pipe.ts","ng://@taiga-ui/kit/pipes/filter-by-input/filter-by-input.module.ts","ng://@taiga-ui/kit/pipes/filter-by-input/taiga-ui-kit-pipes-filter-by-input.ts"],"sourcesContent":["/* eslint-disable @typescript-eslint/naming-convention */\nimport {\n    isPresent,\n    TuiFocusableElementAccessor,\n    tuiPure,\n    TuiStringHandler,\n    TuiStringMatcher,\n} from '@taiga-ui/cdk';\nimport {isFlat} from '@taiga-ui/kit/utils';\n\nexport type ArrayElement<A> = A extends ReadonlyArray<infer T>\n    ? A extends ReadonlyArray<ReadonlyArray<infer G>>\n        ? G\n        : T\n    : never;\n\n/**\n * @deprecated\n * TODO: 3.0 replace with {@link AbstractTuiFilterByInput}\n */\nexport abstract class TuiFilterByInputBase {\n    protected abstract readonly accessor: TuiFocusableElementAccessor;\n\n    protected get query(): string {\n        return this.accessor.nativeFocusableElement\n            ? (this.accessor.nativeFocusableElement as HTMLInputElement).value || ``\n            : ``;\n    }\n\n    @tuiPure\n    protected filter<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        if (!items) {\n            return null;\n        }\n\n        return isFlat(items)\n            ? this.filterFlat(items, matcher, stringify, query)\n            : this.filter2d(items, matcher, stringify, query);\n    }\n\n    private filterFlat<T>(\n        items: readonly T[],\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): readonly T[] {\n        const match = this.getMatch(items, stringify, query);\n\n        return isPresent(match)\n            ? items\n            : items.filter(item => matcher(item, query, stringify));\n    }\n\n    private filter2d<T>(\n        items: ReadonlyArray<readonly T[]>,\n        matcher: TuiStringMatcher<T>,\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): ReadonlyArray<readonly T[]> {\n        const match = items.find(item =>\n            isPresent(this.getMatch(item, stringify, query)),\n        );\n\n        return isPresent(match)\n            ? items\n            : items.map(inner => this.filterFlat(inner, matcher, stringify, query));\n    }\n\n    private getMatch<T>(\n        items: readonly T[],\n        stringify: TuiStringHandler<T>,\n        query: string,\n    ): T | undefined {\n        return items.find(\n            item => stringify(item).toLocaleLowerCase() === query.toLocaleLowerCase(),\n        );\n    }\n}\n\nexport abstract class AbstractTuiFilterByInput extends TuiFilterByInputBase {}\n","import {Inject, Pipe, PipeTransform} from '@angular/core';\nimport {\n    TUI_DEFAULT_MATCHER,\n    TUI_DEFAULT_STRINGIFY,\n    TUI_FOCUSABLE_ITEM_ACCESSOR,\n    TuiFocusableElementAccessor,\n    TuiStringMatcher,\n} from '@taiga-ui/cdk';\n\nimport {AbstractTuiFilterByInput, ArrayElement} from './filter-by-input.base';\n\n@Pipe({\n    name: `tuiFilterByInput`,\n    pure: false,\n})\nexport class TuiFilterByInputPipe\n    extends AbstractTuiFilterByInput\n    implements PipeTransform\n{\n    constructor(\n        @Inject(TUI_FOCUSABLE_ITEM_ACCESSOR)\n        protected readonly accessor: TuiFocusableElementAccessor,\n    ) {\n        super();\n    }\n\n    transform<T>(items: T, matcher?: TuiStringMatcher<ArrayElement<T>>): T;\n    transform<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        matcher: TuiStringMatcher<T> = TUI_DEFAULT_MATCHER,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        return this.filter(items, matcher, TUI_DEFAULT_STRINGIFY, this.query);\n    }\n}\n","import {Inject, Pipe, PipeTransform} from '@angular/core';\nimport {\n    TUI_DEFAULT_MATCHER,\n    TUI_FOCUSABLE_ITEM_ACCESSOR,\n    TuiFocusableElementAccessor,\n    TuiStringHandler,\n} from '@taiga-ui/cdk';\n\nimport {AbstractTuiFilterByInput, ArrayElement} from './filter-by-input.base';\n\n@Pipe({\n    name: `tuiFilterByInputWith`,\n    pure: false,\n})\nexport class TuiFilterByInputWithPipe\n    extends AbstractTuiFilterByInput\n    implements PipeTransform\n{\n    constructor(\n        @Inject(TUI_FOCUSABLE_ITEM_ACCESSOR)\n        protected readonly accessor: TuiFocusableElementAccessor,\n    ) {\n        super();\n    }\n\n    transform<T>(items: T, matcher?: TuiStringHandler<ArrayElement<T>>): T;\n    transform<T>(\n        items: ReadonlyArray<readonly T[]> | readonly T[] | null,\n        stringify: TuiStringHandler<T>,\n    ): ReadonlyArray<readonly T[]> | readonly T[] | null {\n        return this.filter(items, TUI_DEFAULT_MATCHER, stringify, this.query);\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiFilterByInputPipe} from './filter-by-input.pipe';\nimport {TuiFilterByInputWithPipe} from './filter-by-input-with.pipe';\n\n@NgModule({\n    declarations: [TuiFilterByInputPipe, TuiFilterByInputWithPipe],\n    exports: [TuiFilterByInputPipe, TuiFilterByInputWithPipe],\n})\nexport class TuiFilterByInputPipeModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}