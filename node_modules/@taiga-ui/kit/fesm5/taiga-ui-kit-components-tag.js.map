{"version":3,"file":"taiga-ui-kit-components-tag.js","sources":["ng://@taiga-ui/kit/components/tag/tag-options.ts","ng://@taiga-ui/kit/components/tag/tag.component.ts","ng://@taiga-ui/kit/components/tag/tag.module.ts","ng://@taiga-ui/kit/components/tag/taiga-ui-kit-components-tag.ts"],"sourcesContent":["import {InjectionToken, ValueProvider} from '@angular/core';\nimport {TuiSizeL, TuiSizeS} from '@taiga-ui/core/types';\nimport {TuiStatusT} from '@taiga-ui/kit/types';\n\nexport interface TuiTagOptions {\n    readonly size: TuiSizeL | TuiSizeS;\n    readonly status: TuiStatusT;\n    readonly autoColor: boolean;\n}\n\n/** Default values for the tag options. */\nexport const TUI_TAG_DEFAULT_OPTIONS: TuiTagOptions = {\n    size: `m`,\n    status: `default`,\n    autoColor: false,\n};\n\nexport const TUI_TAG_OPTIONS = new InjectionToken<TuiTagOptions>(\n    `Default parameters for tag component`,\n    {\n        factory: () => TUI_TAG_DEFAULT_OPTIONS,\n    },\n);\n\nexport const tuiTagOptionsProvider: (options: Partial<TuiTagOptions>) => ValueProvider = (\n    options: Partial<TuiTagOptions>,\n) => ({\n    provide: TUI_TAG_OPTIONS,\n    useValue: {...TUI_TAG_DEFAULT_OPTIONS, ...options},\n});\n","import {\n    ChangeDetectionStrategy,\n    Component,\n    ElementRef,\n    EventEmitter,\n    HostBinding,\n    HostListener,\n    Inject,\n    Input,\n    Output,\n    ViewChild,\n} from '@angular/core';\nimport {setNativeFocused, tuiDefaultProp} from '@taiga-ui/cdk';\nimport {\n    MODE_PROVIDER,\n    sizeBigger,\n    TUI_MODE,\n    TuiBrightness,\n    TuiSizeL,\n    TuiSizeS,\n    TuiSizeXS,\n} from '@taiga-ui/core';\nimport {TuiStatusT} from '@taiga-ui/kit/types';\nimport {stringHashToHsl} from '@taiga-ui/kit/utils/format';\nimport {PolymorpheusContent} from '@tinkoff/ng-polymorpheus';\nimport {Observable} from 'rxjs';\n\nimport {TUI_TAG_OPTIONS, TuiTagOptions} from './tag-options';\n\nexport const ALLOWED_SPACE_REGEXP = new RegExp(',|[\\\\s]');\n\n@Component({\n    selector: 'tui-tag, a[tuiTag]',\n    templateUrl: './tag.template.html',\n    styleUrls: ['./tag.style.less'],\n    changeDetection: ChangeDetectionStrategy.OnPush,\n    providers: [MODE_PROVIDER],\n    host: {\n        '($.data-mode.attr)': 'mode$',\n    },\n})\nexport class TuiTagComponent {\n    // TODO: Possibly implement standard focus mechanisms and outline\n    @Input()\n    @tuiDefaultProp()\n    value = '';\n\n    @Input()\n    @tuiDefaultProp()\n    editable = false;\n\n    // TODO: 3.0: Remove\n    @Input()\n    @tuiDefaultProp()\n    allowSpaces = true;\n\n    @Input()\n    @tuiDefaultProp()\n    separator: RegExp | string = ',';\n\n    @Input()\n    @tuiDefaultProp()\n    maxLength: number | null = null;\n\n    @Input()\n    @HostBinding('attr.data-size')\n    @tuiDefaultProp()\n    size: TuiSizeL | TuiSizeS = this.options.size;\n\n    @Input()\n    @tuiDefaultProp()\n    showLoader = false;\n\n    @Input()\n    @HostBinding('attr.data-tui-host-status')\n    @tuiDefaultProp()\n    status: TuiStatusT = this.options.status;\n\n    @Input()\n    @HostBinding('class._hoverable')\n    @tuiDefaultProp()\n    hoverable = false;\n\n    @Input()\n    @tuiDefaultProp()\n    removable = false;\n\n    @Input()\n    @HostBinding('class._disabled')\n    @tuiDefaultProp()\n    disabled = false;\n\n    @Input()\n    @HostBinding('class._autocolor')\n    @tuiDefaultProp()\n    autoColor: boolean = this.options.autoColor;\n\n    // TODO: 3.0 Remove null\n    @Input()\n    @tuiDefaultProp()\n    leftContent: PolymorpheusContent | null = null;\n\n    @Output()\n    readonly edited = new EventEmitter<string>();\n\n    @HostBinding('class._editing')\n    editing = false;\n\n    editedText: string | null = null;\n\n    @ViewChild('input', {read: ElementRef})\n    set input(input: ElementRef<HTMLInputElement>) {\n        if (input) {\n            setNativeFocused(input.nativeElement);\n        }\n    }\n\n    constructor(\n        @Inject(ElementRef) private readonly elementRef: ElementRef<HTMLElement>,\n        @Inject(TUI_MODE) readonly mode$: Observable<TuiBrightness | null>,\n        @Inject(TUI_TAG_OPTIONS) private readonly options: TuiTagOptions,\n    ) {}\n\n    get backgroundColor(): string | null {\n        return this.autoColor ? stringHashToHsl(this.value) : null;\n    }\n\n    get canRemove(): boolean {\n        return this.removable && !this.disabled && !this.showLoader;\n    }\n\n    get displayText(): string {\n        return this.editedText === null ? this.value : this.editedText;\n    }\n\n    get loaderSize(): TuiSizeXS {\n        return sizeBigger(this.size) ? 's' : 'xs';\n    }\n\n    @HostBinding('class._has-icon')\n    get hasIcon(): boolean {\n        return this.showLoader || this.removable;\n    }\n\n    @HostListener('keydown.enter', ['$event'])\n    edit(event: Event): void {\n        if (!this.canEdit) {\n            return;\n        }\n\n        event.preventDefault();\n        this.editing = true;\n        this.editedText = this.value;\n    }\n\n    @HostListener('keydown.delete', ['$event'])\n    @HostListener('keydown.backspace', ['$event'])\n    remove(event: Event): void {\n        if (!this.canRemove) {\n            return;\n        }\n\n        event.preventDefault();\n        event.stopPropagation();\n        this.edited.emit('');\n    }\n\n    onInput(value: string): void {\n        const newTags = this.allowSpaces\n            ? value.split(this.separator)\n            : value.split(ALLOWED_SPACE_REGEXP);\n\n        if (newTags.length > 1) {\n            this.save(String(newTags));\n\n            return;\n        }\n\n        this.editedText = value;\n    }\n\n    onKeyDown(event: KeyboardEvent): void {\n        event.stopPropagation();\n\n        switch (event.key.toLowerCase()) {\n            case 'enter':\n                event.preventDefault();\n                this.save(this.editedText || '');\n                break;\n            case 'escape':\n            case 'esc':\n                event.preventDefault();\n                this.stopEditing();\n                setNativeFocused(this.elementRef.nativeElement);\n                break;\n            default:\n                break;\n        }\n    }\n\n    onBlur(): void {\n        if (this.editedText !== null) {\n            this.save(this.editedText);\n        }\n    }\n\n    private get canEdit(): boolean {\n        return this.editable && !this.disabled && !this.showLoader;\n    }\n\n    private stopEditing(): void {\n        this.editing = false;\n        this.editedText = null;\n    }\n\n    private save(value: string): void {\n        this.stopEditing();\n        this.edited.emit(value.trim());\n    }\n}\n","import {CommonModule} from '@angular/common';\nimport {NgModule} from '@angular/core';\nimport {FormsModule} from '@angular/forms';\nimport {TuiPreventDefaultModule} from '@taiga-ui/cdk';\nimport {TuiLoaderModule, TuiSvgModule} from '@taiga-ui/core';\nimport {PolymorpheusModule} from '@tinkoff/ng-polymorpheus';\n\nimport {TuiTagComponent} from './tag.component';\n\n@NgModule({\n    imports: [\n        CommonModule,\n        FormsModule,\n        TuiPreventDefaultModule,\n        TuiSvgModule,\n        TuiLoaderModule,\n        PolymorpheusModule,\n    ],\n    declarations: [TuiTagComponent],\n    exports: [TuiTagComponent],\n})\nexport class TuiTagModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}