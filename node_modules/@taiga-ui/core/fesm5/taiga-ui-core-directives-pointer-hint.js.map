{"version":3,"file":"taiga-ui-core-directives-pointer-hint.js","sources":["ng://@taiga-ui/core/directives/pointer-hint/pointer-hint-options.ts","ng://@taiga-ui/core/directives/pointer-hint/pointer-hint.directive.ts","ng://@taiga-ui/core/directives/pointer-hint/pointer-hint.module.ts","ng://@taiga-ui/core/directives/pointer-hint/taiga-ui-core-directives-pointer-hint.ts"],"sourcesContent":["import {InjectionToken, ValueProvider} from '@angular/core';\nimport {\n    TUI_ABSTRACT_HINT_DEFAULT_OPTIONS,\n    TuiAbstractHintOptions,\n} from '@taiga-ui/core/abstract';\n\nexport interface TuiPointerHintOptions extends TuiAbstractHintOptions {\n    readonly tuiHintShowDelay: number;\n    readonly tuiHintHideDelay: number;\n}\n\n/** Default values for pointer hint options */\nexport const TUI_POINTER_HINT_DEFAULT_OPTIONS: TuiPointerHintOptions = {\n    ...TUI_ABSTRACT_HINT_DEFAULT_OPTIONS,\n    tuiHintShowDelay: 0,\n    tuiHintHideDelay: 0,\n};\n\nexport const TUI_POINTER_HINT_OPTIONS = new InjectionToken<TuiPointerHintOptions>(\n    `Default parameters for pointer hint directive`,\n    {\n        factory: () => TUI_POINTER_HINT_DEFAULT_OPTIONS,\n    },\n);\n\nexport const tuiPointerHintOptionsProvider: (\n    options: Partial<TuiPointerHintOptions>,\n) => ValueProvider = (options: Partial<TuiPointerHintOptions>) => ({\n    provide: TUI_POINTER_HINT_OPTIONS,\n    useValue: {...TUI_POINTER_HINT_DEFAULT_OPTIONS, ...options},\n});\n","import {Directive, ElementRef, Inject, Input} from '@angular/core';\nimport {\n    tuiDefaultProp,\n    TuiDestroyService,\n    TuiHoveredService,\n    tuiRequiredSetter,\n    typedFromEvent,\n} from '@taiga-ui/cdk';\nimport {AbstractTuiHint} from '@taiga-ui/core/abstract';\nimport {TuiHintService} from '@taiga-ui/core/services';\nimport {PolymorpheusContent} from '@tinkoff/ng-polymorpheus';\nimport {Observable, of} from 'rxjs';\nimport {\n    delay,\n    distinctUntilChanged,\n    filter,\n    startWith,\n    switchMap,\n    takeUntil,\n} from 'rxjs/operators';\n\nimport {TUI_POINTER_HINT_OPTIONS, TuiPointerHintOptions} from './pointer-hint-options';\n\n@Directive({\n    selector: '[tuiPointerHint]:not(ng-container)',\n    providers: [TuiDestroyService],\n})\nexport class TuiPointerHintDirective extends AbstractTuiHint {\n    private currentMouseRect = this.mousePositionToClientRect();\n\n    @Input()\n    @tuiDefaultProp()\n    tuiHintShowDelay: TuiPointerHintOptions['tuiHintShowDelay'] =\n        this.options.tuiHintShowDelay;\n\n    @Input()\n    @tuiDefaultProp()\n    tuiHintHideDelay: TuiPointerHintOptions['tuiHintHideDelay'] =\n        this.options.tuiHintHideDelay;\n\n    // TODO: 3.0 Remove null\n    @Input()\n    @tuiRequiredSetter()\n    set tuiPointerHint(value: PolymorpheusContent | null) {\n        if (!value) {\n            this.hideTooltip();\n            this.content = '';\n\n            return;\n        }\n\n        this.content = value;\n    }\n\n    content: PolymorpheusContent = '';\n\n    constructor(\n        @Inject(ElementRef) elementRef: ElementRef<HTMLElement>,\n        @Inject(TuiHintService) hintService: TuiHintService,\n        @Inject(TuiDestroyService)\n        private readonly destroy$: TuiDestroyService,\n        @Inject(TuiHoveredService) hoveredService: TuiHoveredService,\n        @Inject(TUI_POINTER_HINT_OPTIONS)\n        protected readonly options: TuiPointerHintOptions,\n    ) {\n        super(elementRef, hintService, null, options);\n\n        const hint$ = hoveredService.createHovered$(this.elementRef.nativeElement).pipe(\n            filter(() => !!this.content),\n            startWith(false),\n            distinctUntilChanged(),\n        );\n\n        hint$\n            .pipe(\n                switchMap(visible =>\n                    of(visible).pipe(\n                        delay(visible ? this.tuiHintShowDelay : this.tuiHintHideDelay),\n                    ),\n                ),\n                takeUntil(destroy$),\n            )\n            .subscribe({\n                next: visible => {\n                    if (visible) {\n                        this.showTooltip();\n                    } else {\n                        this.hideTooltip();\n                    }\n                },\n                complete: () => {\n                    this.hideTooltip();\n                },\n            });\n\n        this.initMouseMoveSubscription();\n    }\n\n    getElementClientRect(): ClientRect {\n        return this.currentMouseRect;\n    }\n\n    private initMouseMoveSubscription(): void {\n        const mouseMove$: Observable<MouseEvent> = typedFromEvent(\n            this.elementRef.nativeElement,\n            'mousemove',\n        );\n\n        mouseMove$.pipe(takeUntil(this.destroy$)).subscribe(({clientX, clientY}) => {\n            this.currentMouseRect = this.mousePositionToClientRect(clientX, clientY);\n        });\n    }\n\n    private mousePositionToClientRect(x: number = 0, y: number = 0): ClientRect {\n        return {\n            left: x,\n            right: x,\n            top: y,\n            bottom: y,\n            width: 0,\n            height: 0,\n        };\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiPointerHintDirective} from './pointer-hint.directive';\n\n@NgModule({\n    declarations: [TuiPointerHintDirective],\n    exports: [TuiPointerHintDirective],\n})\nexport class TuiPointerHintModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}