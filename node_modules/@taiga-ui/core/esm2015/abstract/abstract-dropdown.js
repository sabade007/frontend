import { __decorate } from "tslib";
import { AfterViewChecked, ComponentFactoryResolver, ComponentRef, Directive, ElementRef, Injector, Input, OnDestroy, } from '@angular/core';
import { TuiActiveZoneDirective, tuiDefaultProp, TuiNativeFocusableElement, TuiPortalService, tuiPure, } from '@taiga-ui/cdk';
import { TuiDropdownBoxComponent } from '@taiga-ui/core/components/dropdown-box';
import { DEFAULT_MAX_HEIGHT, DEFAULT_MIN_HEIGHT } from '@taiga-ui/core/constants';
import { checkFixedPosition } from '@taiga-ui/core/utils/dom';
// @bad TODO: Possibly refactor to make more abstract
let AbstractTuiDropdown = class AbstractTuiDropdown {
    constructor(componentFactoryResolver, injector, portalService, elementRef, activeZone) {
        this.componentFactoryResolver = componentFactoryResolver;
        this.injector = injector;
        this.portalService = portalService;
        this.elementRef = elementRef;
        this.activeZone = activeZone;
        this.content = ``;
        this.tuiDropdownHost = null;
        this.minHeight = DEFAULT_MIN_HEIGHT;
        this.maxHeight = DEFAULT_MAX_HEIGHT;
        this.align = `left`;
        this.direction = null;
        this.sided = false;
        this.limitMinWidth = `min`;
        this.dropdownBoxRef = null;
    }
    ngOnDestroy() {
        this.closeDropdownBox();
    }
    ngAfterViewChecked() {
        // @awful TODO: This is probably wrong to call both but in TuiHostedDropdown some changes do not propagate otherwise
        if (this.dropdownBoxRef !== null) {
            this.dropdownBoxRef.changeDetectorRef.detectChanges();
            this.dropdownBoxRef.changeDetectorRef.markForCheck();
        }
    }
    get clientRect() {
        return this.elementRef.nativeElement.getBoundingClientRect();
    }
    get host() {
        return this.tuiDropdownHost || this.elementRef.nativeElement;
    }
    get fixed() {
        return checkFixedPosition(this.elementRef.nativeElement);
    }
    toggleDropdown(value) {
        if (value) {
            this.openDropdownBox();
        }
        else {
            this.closeDropdownBox();
        }
    }
    openDropdownBox() {
        if (this.dropdownBoxRef !== null) {
            return;
        }
        const componentFactory = this.componentFactoryResolver.resolveComponentFactory(TuiDropdownBoxComponent);
        this.dropdownBoxRef = this.portalService.add(componentFactory, this.injector);
        this.dropdownBoxRef.changeDetectorRef.detectChanges();
    }
    closeDropdownBox() {
        if (this.dropdownBoxRef === null) {
            return;
        }
        this.portalService.remove(this.dropdownBoxRef);
        this.dropdownBoxRef = null;
    }
};
AbstractTuiDropdown.ctorParameters = () => [
    { type: ComponentFactoryResolver },
    { type: Injector },
    { type: TuiPortalService },
    { type: ElementRef },
    { type: TuiActiveZoneDirective }
];
__decorate([
    Input(`tuiDropdownContent`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "content", void 0);
__decorate([
    Input(`tuiDropdownHost`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "tuiDropdownHost", void 0);
__decorate([
    Input(`tuiDropdownMinHeight`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "minHeight", void 0);
__decorate([
    Input(`tuiDropdownMaxHeight`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "maxHeight", void 0);
__decorate([
    Input(`tuiDropdownAlign`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "align", void 0);
__decorate([
    Input(`tuiDropdownDirection`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "direction", void 0);
__decorate([
    Input(`tuiDropdownSided`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "sided", void 0);
__decorate([
    Input(`tuiDropdownLimitWidth`),
    tuiDefaultProp()
], AbstractTuiDropdown.prototype, "limitMinWidth", void 0);
__decorate([
    tuiPure
], AbstractTuiDropdown.prototype, "fixed", null);
__decorate([
    tuiPure
], AbstractTuiDropdown.prototype, "toggleDropdown", null);
AbstractTuiDropdown = __decorate([
    Directive()
], AbstractTuiDropdown);
export { AbstractTuiDropdown };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYWJzdHJhY3QtZHJvcGRvd24uanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGFpZ2EtdWkvY29yZS9hYnN0cmFjdC8iLCJzb3VyY2VzIjpbImFic3RyYWN0LWRyb3Bkb3duLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQ0gsZ0JBQWdCLEVBQ2hCLHdCQUF3QixFQUN4QixZQUFZLEVBQ1osU0FBUyxFQUNULFVBQVUsRUFDVixRQUFRLEVBQ1IsS0FBSyxFQUNMLFNBQVMsR0FDWixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQ0gsc0JBQXNCLEVBQ3RCLGNBQWMsRUFDZCx5QkFBeUIsRUFDekIsZ0JBQWdCLEVBQ2hCLE9BQU8sR0FDVixNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUMsdUJBQXVCLEVBQUMsTUFBTSx3Q0FBd0MsQ0FBQztBQUMvRSxPQUFPLEVBQUMsa0JBQWtCLEVBQUUsa0JBQWtCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQU9oRixPQUFPLEVBQUMsa0JBQWtCLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUk1RCxxREFBcUQ7QUFFckQsSUFBc0IsbUJBQW1CLEdBQXpDLE1BQXNCLG1CQUFtQjtJQXVDckMsWUFDcUIsd0JBQWtELEVBQ2xELFFBQWtCLEVBQ2xCLGFBQStCLEVBQzdCLFVBQW1DLEVBQzdDLFVBQXlDO1FBSmpDLDZCQUF3QixHQUF4Qix3QkFBd0IsQ0FBMEI7UUFDbEQsYUFBUSxHQUFSLFFBQVEsQ0FBVTtRQUNsQixrQkFBYSxHQUFiLGFBQWEsQ0FBa0I7UUFDN0IsZUFBVSxHQUFWLFVBQVUsQ0FBeUI7UUFDN0MsZUFBVSxHQUFWLFVBQVUsQ0FBK0I7UUFyQ3RELFlBQU8sR0FBd0IsRUFBRSxDQUFDO1FBSWxDLG9CQUFlLEdBQW1ELElBQUksQ0FBQztRQUl2RSxjQUFTLEdBQUcsa0JBQWtCLENBQUM7UUFJL0IsY0FBUyxHQUFHLGtCQUFrQixDQUFDO1FBSS9CLFVBQUssR0FBMkIsTUFBTSxDQUFDO1FBSXZDLGNBQVMsR0FBZ0MsSUFBSSxDQUFDO1FBSTlDLFVBQUssR0FBRyxLQUFLLENBQUM7UUFJZCxrQkFBYSxHQUFzQixLQUFLLENBQUM7UUFFekMsbUJBQWMsR0FBaUQsSUFBSSxDQUFDO0lBUWpFLENBQUM7SUFFSixXQUFXO1FBQ1AsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7SUFDNUIsQ0FBQztJQUVELGtCQUFrQjtRQUNkLG9IQUFvSDtRQUNwSCxJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxFQUFFO1lBQzlCLElBQUksQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUMsYUFBYSxFQUFFLENBQUM7WUFDdEQsSUFBSSxDQUFDLGNBQWMsQ0FBQyxpQkFBaUIsQ0FBQyxZQUFZLEVBQUUsQ0FBQztTQUN4RDtJQUNMLENBQUM7SUFFRCxJQUFJLFVBQVU7UUFDVixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsYUFBYSxDQUFDLHFCQUFxQixFQUFFLENBQUM7SUFDakUsQ0FBQztJQUVELElBQUksSUFBSTtRQUNKLE9BQU8sSUFBSSxDQUFDLGVBQWUsSUFBSSxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQztJQUNqRSxDQUFDO0lBR0QsSUFBSSxLQUFLO1FBQ0wsT0FBTyxrQkFBa0IsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0lBQzdELENBQUM7SUFHUyxjQUFjLENBQUMsS0FBYztRQUNuQyxJQUFJLEtBQUssRUFBRTtZQUNQLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQztTQUMxQjthQUFNO1lBQ0gsSUFBSSxDQUFDLGdCQUFnQixFQUFFLENBQUM7U0FDM0I7SUFDTCxDQUFDO0lBRVMsZUFBZTtRQUNyQixJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxFQUFFO1lBQzlCLE9BQU87U0FDVjtRQUVELE1BQU0sZ0JBQWdCLEdBQUcsSUFBSSxDQUFDLHdCQUF3QixDQUFDLHVCQUF1QixDQUMxRSx1QkFBdUIsQ0FDMUIsQ0FBQztRQUVGLElBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxDQUFDLGFBQWEsQ0FBQyxHQUFHLENBQUMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzlFLElBQUksQ0FBQyxjQUFjLENBQUMsaUJBQWlCLENBQUMsYUFBYSxFQUFFLENBQUM7SUFDMUQsQ0FBQztJQUVTLGdCQUFnQjtRQUN0QixJQUFJLElBQUksQ0FBQyxjQUFjLEtBQUssSUFBSSxFQUFFO1lBQzlCLE9BQU87U0FDVjtRQUVELElBQUksQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsQ0FBQztRQUMvQyxJQUFJLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztJQUMvQixDQUFDO0NBQ0osQ0FBQTs7WUE5RGtELHdCQUF3QjtZQUN4QyxRQUFRO1lBQ0gsZ0JBQWdCO1lBQ2pCLFVBQVU7WUFDcEIsc0JBQXNCOztBQXJDL0M7SUFGQyxLQUFLLENBQUMsb0JBQW9CLENBQUM7SUFDM0IsY0FBYyxFQUFFO29EQUNpQjtBQUlsQztJQUZDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQztJQUN4QixjQUFjLEVBQUU7NERBQ3NEO0FBSXZFO0lBRkMsS0FBSyxDQUFDLHNCQUFzQixDQUFDO0lBQzdCLGNBQWMsRUFBRTtzREFDYztBQUkvQjtJQUZDLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQztJQUM3QixjQUFjLEVBQUU7c0RBQ2M7QUFJL0I7SUFGQyxLQUFLLENBQUMsa0JBQWtCLENBQUM7SUFDekIsY0FBYyxFQUFFO2tEQUNzQjtBQUl2QztJQUZDLEtBQUssQ0FBQyxzQkFBc0IsQ0FBQztJQUM3QixjQUFjLEVBQUU7c0RBQzZCO0FBSTlDO0lBRkMsS0FBSyxDQUFDLGtCQUFrQixDQUFDO0lBQ3pCLGNBQWMsRUFBRTtrREFDSDtBQUlkO0lBRkMsS0FBSyxDQUFDLHVCQUF1QixDQUFDO0lBQzlCLGNBQWMsRUFBRTswREFDd0I7QUFpQ3pDO0lBREMsT0FBTztnREFHUDtBQUdEO0lBREMsT0FBTzt5REFPUDtBQS9FaUIsbUJBQW1CO0lBRHhDLFNBQVMsRUFBRTtHQUNVLG1CQUFtQixDQXNHeEM7U0F0R3FCLG1CQUFtQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gICAgQWZ0ZXJWaWV3Q2hlY2tlZCxcbiAgICBDb21wb25lbnRGYWN0b3J5UmVzb2x2ZXIsXG4gICAgQ29tcG9uZW50UmVmLFxuICAgIERpcmVjdGl2ZSxcbiAgICBFbGVtZW50UmVmLFxuICAgIEluamVjdG9yLFxuICAgIElucHV0LFxuICAgIE9uRGVzdHJveSxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge1xuICAgIFR1aUFjdGl2ZVpvbmVEaXJlY3RpdmUsXG4gICAgdHVpRGVmYXVsdFByb3AsXG4gICAgVHVpTmF0aXZlRm9jdXNhYmxlRWxlbWVudCxcbiAgICBUdWlQb3J0YWxTZXJ2aWNlLFxuICAgIHR1aVB1cmUsXG59IGZyb20gJ0B0YWlnYS11aS9jZGsnO1xuaW1wb3J0IHtUdWlEcm9wZG93bkJveENvbXBvbmVudH0gZnJvbSAnQHRhaWdhLXVpL2NvcmUvY29tcG9uZW50cy9kcm9wZG93bi1ib3gnO1xuaW1wb3J0IHtERUZBVUxUX01BWF9IRUlHSFQsIERFRkFVTFRfTUlOX0hFSUdIVH0gZnJvbSAnQHRhaWdhLXVpL2NvcmUvY29uc3RhbnRzJztcbmltcG9ydCB7VHVpRHJvcGRvd259IGZyb20gJ0B0YWlnYS11aS9jb3JlL2ludGVyZmFjZXMnO1xuaW1wb3J0IHtcbiAgICBUdWlEcm9wZG93bldpZHRoVCxcbiAgICBUdWlIb3Jpem9udGFsRGlyZWN0aW9uLFxuICAgIFR1aVZlcnRpY2FsRGlyZWN0aW9uLFxufSBmcm9tICdAdGFpZ2EtdWkvY29yZS90eXBlcyc7XG5pbXBvcnQge2NoZWNrRml4ZWRQb3NpdGlvbn0gZnJvbSAnQHRhaWdhLXVpL2NvcmUvdXRpbHMvZG9tJztcbmltcG9ydCB7UG9seW1vcnBoZXVzQ29udGVudH0gZnJvbSAnQHRpbmtvZmYvbmctcG9seW1vcnBoZXVzJztcbmltcG9ydCB7T2JzZXJ2YWJsZX0gZnJvbSAncnhqcyc7XG5cbi8vIEBiYWQgVE9ETzogUG9zc2libHkgcmVmYWN0b3IgdG8gbWFrZSBtb3JlIGFic3RyYWN0XG5ARGlyZWN0aXZlKClcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBBYnN0cmFjdFR1aURyb3Bkb3duXG4gICAgaW1wbGVtZW50cyBUdWlEcm9wZG93biwgQWZ0ZXJWaWV3Q2hlY2tlZCwgT25EZXN0cm95XG57XG4gICAgYWJzdHJhY3QgcmVmcmVzaCQ6IE9ic2VydmFibGU8dW5rbm93bj47XG5cbiAgICBASW5wdXQoYHR1aURyb3Bkb3duQ29udGVudGApXG4gICAgQHR1aURlZmF1bHRQcm9wKClcbiAgICBjb250ZW50OiBQb2x5bW9ycGhldXNDb250ZW50ID0gYGA7XG5cbiAgICBASW5wdXQoYHR1aURyb3Bkb3duSG9zdGApXG4gICAgQHR1aURlZmF1bHRQcm9wKClcbiAgICB0dWlEcm9wZG93bkhvc3Q6IEhUTUxFbGVtZW50IHwgVHVpTmF0aXZlRm9jdXNhYmxlRWxlbWVudCB8IG51bGwgPSBudWxsO1xuXG4gICAgQElucHV0KGB0dWlEcm9wZG93bk1pbkhlaWdodGApXG4gICAgQHR1aURlZmF1bHRQcm9wKClcbiAgICBtaW5IZWlnaHQgPSBERUZBVUxUX01JTl9IRUlHSFQ7XG5cbiAgICBASW5wdXQoYHR1aURyb3Bkb3duTWF4SGVpZ2h0YClcbiAgICBAdHVpRGVmYXVsdFByb3AoKVxuICAgIG1heEhlaWdodCA9IERFRkFVTFRfTUFYX0hFSUdIVDtcblxuICAgIEBJbnB1dChgdHVpRHJvcGRvd25BbGlnbmApXG4gICAgQHR1aURlZmF1bHRQcm9wKClcbiAgICBhbGlnbjogVHVpSG9yaXpvbnRhbERpcmVjdGlvbiA9IGBsZWZ0YDtcblxuICAgIEBJbnB1dChgdHVpRHJvcGRvd25EaXJlY3Rpb25gKVxuICAgIEB0dWlEZWZhdWx0UHJvcCgpXG4gICAgZGlyZWN0aW9uOiBUdWlWZXJ0aWNhbERpcmVjdGlvbiB8IG51bGwgPSBudWxsO1xuXG4gICAgQElucHV0KGB0dWlEcm9wZG93blNpZGVkYClcbiAgICBAdHVpRGVmYXVsdFByb3AoKVxuICAgIHNpZGVkID0gZmFsc2U7XG5cbiAgICBASW5wdXQoYHR1aURyb3Bkb3duTGltaXRXaWR0aGApXG4gICAgQHR1aURlZmF1bHRQcm9wKClcbiAgICBsaW1pdE1pbldpZHRoOiBUdWlEcm9wZG93bldpZHRoVCA9IGBtaW5gO1xuXG4gICAgZHJvcGRvd25Cb3hSZWY6IENvbXBvbmVudFJlZjxUdWlEcm9wZG93bkJveENvbXBvbmVudD4gfCBudWxsID0gbnVsbDtcblxuICAgIHByb3RlY3RlZCBjb25zdHJ1Y3RvcihcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBjb21wb25lbnRGYWN0b3J5UmVzb2x2ZXI6IENvbXBvbmVudEZhY3RvcnlSZXNvbHZlcixcbiAgICAgICAgcHJpdmF0ZSByZWFkb25seSBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgcG9ydGFsU2VydmljZTogVHVpUG9ydGFsU2VydmljZSxcbiAgICAgICAgcHJvdGVjdGVkIHJlYWRvbmx5IGVsZW1lbnRSZWY6IEVsZW1lbnRSZWY8SFRNTEVsZW1lbnQ+LFxuICAgICAgICByZWFkb25seSBhY3RpdmVab25lOiBUdWlBY3RpdmVab25lRGlyZWN0aXZlIHwgbnVsbCxcbiAgICApIHt9XG5cbiAgICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5jbG9zZURyb3Bkb3duQm94KCk7XG4gICAgfVxuXG4gICAgbmdBZnRlclZpZXdDaGVja2VkKCk6IHZvaWQge1xuICAgICAgICAvLyBAYXdmdWwgVE9ETzogVGhpcyBpcyBwcm9iYWJseSB3cm9uZyB0byBjYWxsIGJvdGggYnV0IGluIFR1aUhvc3RlZERyb3Bkb3duIHNvbWUgY2hhbmdlcyBkbyBub3QgcHJvcGFnYXRlIG90aGVyd2lzZVxuICAgICAgICBpZiAodGhpcy5kcm9wZG93bkJveFJlZiAhPT0gbnVsbCkge1xuICAgICAgICAgICAgdGhpcy5kcm9wZG93bkJveFJlZi5jaGFuZ2VEZXRlY3RvclJlZi5kZXRlY3RDaGFuZ2VzKCk7XG4gICAgICAgICAgICB0aGlzLmRyb3Bkb3duQm94UmVmLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZ2V0IGNsaWVudFJlY3QoKTogQ2xpZW50UmVjdCB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICB9XG5cbiAgICBnZXQgaG9zdCgpOiBIVE1MRWxlbWVudCB8IFR1aU5hdGl2ZUZvY3VzYWJsZUVsZW1lbnQge1xuICAgICAgICByZXR1cm4gdGhpcy50dWlEcm9wZG93bkhvc3QgfHwgdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQ7XG4gICAgfVxuXG4gICAgQHR1aVB1cmVcbiAgICBnZXQgZml4ZWQoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiBjaGVja0ZpeGVkUG9zaXRpb24odGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQpO1xuICAgIH1cblxuICAgIEB0dWlQdXJlXG4gICAgcHJvdGVjdGVkIHRvZ2dsZURyb3Bkb3duKHZhbHVlOiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgdGhpcy5vcGVuRHJvcGRvd25Cb3goKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2VEcm9wZG93bkJveCgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJvdGVjdGVkIG9wZW5Ecm9wZG93bkJveCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZHJvcGRvd25Cb3hSZWYgIT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGNvbXBvbmVudEZhY3RvcnkgPSB0aGlzLmNvbXBvbmVudEZhY3RvcnlSZXNvbHZlci5yZXNvbHZlQ29tcG9uZW50RmFjdG9yeShcbiAgICAgICAgICAgIFR1aURyb3Bkb3duQm94Q29tcG9uZW50LFxuICAgICAgICApO1xuXG4gICAgICAgIHRoaXMuZHJvcGRvd25Cb3hSZWYgPSB0aGlzLnBvcnRhbFNlcnZpY2UuYWRkKGNvbXBvbmVudEZhY3RvcnksIHRoaXMuaW5qZWN0b3IpO1xuICAgICAgICB0aGlzLmRyb3Bkb3duQm94UmVmLmNoYW5nZURldGVjdG9yUmVmLmRldGVjdENoYW5nZXMoKTtcbiAgICB9XG5cbiAgICBwcm90ZWN0ZWQgY2xvc2VEcm9wZG93bkJveCgpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuZHJvcGRvd25Cb3hSZWYgPT09IG51bGwpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuXG4gICAgICAgIHRoaXMucG9ydGFsU2VydmljZS5yZW1vdmUodGhpcy5kcm9wZG93bkJveFJlZik7XG4gICAgICAgIHRoaXMuZHJvcGRvd25Cb3hSZWYgPSBudWxsO1xuICAgIH1cbn1cbiJdfQ==