{"version":3,"file":"taiga-ui-core-components-dropdown-box.js","sources":["ng://@taiga-ui/core/components/dropdown-box/dropdown-box.component.ts","ng://@taiga-ui/core/components/dropdown-box/dropdown-box.module.ts","ng://@taiga-ui/core/components/dropdown-box/taiga-ui-core-components-dropdown-box.ts"],"sourcesContent":["import {AnimationOptions} from '@angular/animations';\nimport {\n    AfterViewChecked,\n    ChangeDetectionStrategy,\n    Component,\n    ElementRef,\n    HostBinding,\n    Inject,\n    NgZone,\n    ViewChild,\n} from '@angular/core';\nimport {ANIMATION_FRAME, WINDOW} from '@ng-web-apis/common';\nimport {\n    AbstractTuiPortalHostComponent,\n    getClosestFocusable,\n    inRange,\n    POLLING_TIME,\n    px,\n    TuiActiveZoneDirective,\n    tuiAssertIsHTMLElement,\n    TuiDestroyService,\n    TuiDropdownHostComponent,\n    TuiOverscrollModeT,\n    tuiPure,\n    tuiZonefree,\n} from '@taiga-ui/cdk';\nimport {tuiDropdownAnimation} from '@taiga-ui/core/animations';\nimport {DEFAULT_MARGIN, DEFAULT_MAX_WIDTH} from '@taiga-ui/core/constants';\nimport {TuiDropdownAnimation} from '@taiga-ui/core/enums';\nimport {TuiAnimationOptions, TuiDropdown} from '@taiga-ui/core/interfaces';\nimport {TUI_ANIMATION_OPTIONS, TUI_DROPDOWN_DIRECTIVE} from '@taiga-ui/core/tokens';\nimport {TuiHorizontalDirection, TuiVerticalDirection} from '@taiga-ui/core/types';\nimport {getScreenWidth, tuiGetViewportWidth} from '@taiga-ui/core/utils/dom';\nimport {fromEvent, merge, Observable} from 'rxjs';\nimport {takeUntil, throttleTime} from 'rxjs/operators';\n\n/**\n *  This component is used to show template in a portal using default style of white rounded box with a shadow\n */\n// @bad TODO: OnPush\n// Ambient type cannot be used without dynamic https://github.com/angular/angular/issues/23395\n// @dynamic\n@Component({\n    selector: 'tui-dropdown-box',\n    templateUrl: './dropdown-box.template.html',\n    styleUrls: ['./dropdown-box.style.less'],\n    changeDetection: ChangeDetectionStrategy.Default,\n    providers: [TuiDestroyService],\n    animations: [tuiDropdownAnimation],\n})\nexport class TuiDropdownBoxComponent implements AfterViewChecked {\n    private readonly animationTop = {\n        value: TuiDropdownAnimation.FadeInTop,\n        ...this.options,\n    };\n\n    private readonly animationBottom = {\n        value: TuiDropdownAnimation.FadeInBottom,\n        ...this.options,\n    };\n\n    /**\n     * Is previous position on top (to prevent jumping up and down on scroll)\n     */\n    private prevDirectionIsTop = false;\n\n    @HostBinding('@tuiDropdownAnimation')\n    dropdownAnimation!: TuiAnimationOptions;\n\n    @ViewChild('content', {read: ElementRef})\n    readonly contentElementRef?: ElementRef<HTMLElement>;\n\n    constructor(\n        @Inject(TuiDestroyService)\n        destroy$: TuiDestroyService,\n        @Inject(NgZone) ngZone: NgZone,\n        @Inject(TUI_DROPDOWN_DIRECTIVE) readonly directive: TuiDropdown,\n        @Inject(WINDOW) private readonly windowRef: Window,\n        @Inject(ElementRef) private readonly elementRef: ElementRef<HTMLElement>,\n        @Inject(AbstractTuiPortalHostComponent)\n        private readonly portalHost: TuiDropdownHostComponent,\n        @Inject(TUI_ANIMATION_OPTIONS) private readonly options: AnimationOptions,\n        @Inject(ANIMATION_FRAME) animationFrame$: Observable<number>,\n    ) {\n        merge(\n            animationFrame$.pipe(throttleTime(POLLING_TIME)),\n            this.directive.refresh$,\n            fromEvent(this.windowRef, 'resize'),\n        )\n            .pipe(tuiZonefree(ngZone), takeUntil(destroy$))\n            .subscribe(() => {\n                this.calculatePositionAndSize();\n            });\n    }\n\n    get overscroll(): TuiOverscrollModeT {\n        return this.inModal ? 'all' : 'scroll';\n    }\n\n    @tuiPure\n    getContext<T extends Record<string, any>>(\n        context?: T,\n        activeZone?: TuiActiveZoneDirective,\n    ):\n        | {activeZone?: TuiActiveZoneDirective}\n        | (T & {activeZone?: TuiActiveZoneDirective}) {\n        return {...context, activeZone};\n    }\n\n    ngAfterViewChecked(): void {\n        this.calculatePositionAndSize();\n    }\n\n    onTopFocus(): void {\n        this.moveFocusOutside(true);\n    }\n\n    onBottomFocus(): void {\n        this.moveFocusOutside(false);\n    }\n\n    @tuiPure\n    private get inModal(): boolean {\n        // @awful TODO: get rid of component tag name dependency\n        return !!this.directive.host.closest('tui-dialog-host');\n    }\n\n    @tuiPure\n    private get inOption(): boolean {\n        // @awful TODO: get rid of component tag name dependency\n        return !!this.directive.host.closest('[tuiOption]');\n    }\n\n    private calculatePositionAndSize(): void {\n        const {clientRect} = this.directive;\n        const {style} = this.elementRef.nativeElement;\n        const hostRect = this.directive.fixed\n            ? this.portalHost.fixedPositionOffset()\n            : this.portalHost.clientRect;\n\n        style.position = this.directive.fixed ? 'fixed' : 'absolute';\n\n        this.calculateVerticalPosition(style, clientRect, hostRect);\n        this.calculateHorizontalPosition(style, clientRect, hostRect);\n        this.calculateWidth(style, clientRect);\n    }\n\n    private getFinalAlign(\n        style: CSSStyleDeclaration,\n        directiveRect: ClientRect,\n    ): TuiHorizontalDirection {\n        const dropdownRect = this.elementRef.nativeElement.getBoundingClientRect();\n        const dropdownWidth = this.elementRef.nativeElement.offsetWidth;\n        const screenWidth = getScreenWidth(this.windowRef.document);\n        const isDropdownSizeHypotheticallyFitsViewport =\n            directiveRect.left + dropdownWidth < screenWidth ||\n            directiveRect.right - dropdownWidth > 0;\n        const isDropdownSizeActuallyFitsViewport =\n            dropdownRect.right <= screenWidth && dropdownRect.left >= 0;\n        let finalAlign: TuiHorizontalDirection = this.directive.align;\n\n        switch (this.directive.align) {\n            case 'left':\n                if (\n                    isDropdownSizeHypotheticallyFitsViewport &&\n                    dropdownRect.right > screenWidth\n                ) {\n                    finalAlign = 'right';\n                }\n\n                break;\n            case 'right':\n                if (isDropdownSizeHypotheticallyFitsViewport && dropdownRect.left < 0) {\n                    finalAlign = 'left';\n                }\n\n                break;\n        }\n\n        if (style.right === 'auto' && isDropdownSizeActuallyFitsViewport) {\n            finalAlign = 'left';\n        }\n\n        if (style.left === 'auto' && isDropdownSizeActuallyFitsViewport) {\n            finalAlign = 'right';\n        }\n\n        return finalAlign;\n    }\n\n    /**\n     * Calculates horizontal position\n     *\n     * @param style dropdownBox elementRef styles object\n     * @param directiveRect ClientRect of hosting directive\n     * @param hostRect ClientRect of  portal host\n     */\n    private calculateHorizontalPosition(\n        style: CSSStyleDeclaration,\n        directiveRect: ClientRect,\n        hostRect: ClientRect,\n    ): void {\n        const offset = this.directive.sided\n            ? this.elementRef.nativeElement.getBoundingClientRect().width + DEFAULT_MARGIN\n            : 0;\n        const left = Math.ceil(directiveRect.left - hostRect.left - offset);\n        const right = Math.floor(hostRect.right - directiveRect.right - offset);\n        const viewportWidth = tuiGetViewportWidth(this.windowRef);\n\n        switch (this.getFinalAlign(style, directiveRect)) {\n            case 'left':\n                if (\n                    right + DEFAULT_MARGIN > viewportWidth ||\n                    inRange(left + DEFAULT_MARGIN, 0, viewportWidth)\n                ) {\n                    style.left = px(left);\n                    style.right = 'auto';\n                } else {\n                    style.left = 'auto';\n                    style.right = px(right);\n                }\n\n                break;\n            case 'right':\n                if (\n                    inRange(right + DEFAULT_MARGIN, 0, viewportWidth) ||\n                    left + DEFAULT_MARGIN > viewportWidth\n                ) {\n                    style.left = 'auto';\n                    style.right = px(right);\n                } else {\n                    style.left = px(left);\n                    style.right = 'auto';\n                }\n\n                break;\n        }\n    }\n\n    /**\n     * Calculates vertical position and height\n     *\n     * @param style dropdownBox elementRef styles object\n     * @param directiveRect ClientRect of hosting directive\n     * @param hostRect ClientRect of  portal host\n     */\n    private calculateVerticalPosition(\n        style: CSSStyleDeclaration,\n        directiveRect: ClientRect,\n        hostRect: ClientRect,\n    ): void {\n        const windowHeight = this.windowRef.innerHeight;\n        // Maximum height of the box\n        const boxHeightLimit = Math.min(\n            this.directive.maxHeight,\n            windowHeight - DEFAULT_MARGIN * 2,\n        );\n        const offset = this.directive.sided\n            ? DEFAULT_MARGIN - directiveRect.height\n            : DEFAULT_MARGIN * 2;\n        const topAvailableHeight = directiveRect.top - offset;\n        const bottomAvailableHeight = windowHeight - directiveRect.bottom - offset;\n        const finalDirection = this.getFinalDirection(directiveRect);\n        const optionOffset = this.inOption ? DEFAULT_MARGIN * 2 : 0;\n\n        this.prevDirectionIsTop = finalDirection === 'top';\n\n        if (finalDirection === 'top') {\n            this.dropdownAnimation = this.animationBottom;\n\n            style.maxHeight = px(Math.min(boxHeightLimit, topAvailableHeight));\n            style.top = 'auto';\n            style.bottom = px(\n                hostRect.bottom -\n                    directiveRect.top -\n                    DEFAULT_MARGIN +\n                    offset -\n                    optionOffset,\n            );\n        } else {\n            this.dropdownAnimation = this.animationTop;\n\n            style.maxHeight = px(Math.min(boxHeightLimit, bottomAvailableHeight));\n            style.top = px(\n                directiveRect.bottom -\n                    hostRect.top -\n                    DEFAULT_MARGIN +\n                    offset -\n                    optionOffset,\n            );\n            style.bottom = 'auto';\n        }\n    }\n\n    private getFinalDirection(directiveRect: ClientRect): TuiVerticalDirection | null {\n        const windowHeight = this.windowRef.innerHeight;\n        const offset = this.directive.sided\n            ? DEFAULT_MARGIN - directiveRect.height\n            : DEFAULT_MARGIN * 2;\n\n        // Maximum space available on top and on the bottom in the viewport\n        const topAvailableHeight = directiveRect.top - offset;\n        const bottomAvailableHeight = windowHeight - directiveRect.bottom - offset;\n\n        let finalDirection: TuiVerticalDirection | null = null;\n\n        // Given direction is applied if we can fit the box in the limits that way\n        switch (this.directive.direction) {\n            case 'top':\n                if (topAvailableHeight >= this.directive.minHeight) {\n                    finalDirection = 'top';\n                }\n\n                break;\n            case 'bottom':\n                if (bottomAvailableHeight >= this.directive.minHeight) {\n                    finalDirection = 'bottom';\n                }\n\n                break;\n        }\n\n        // Maximum height of the box\n        const boxHeightLimit = Math.min(\n            this.directive.maxHeight,\n            windowHeight - DEFAULT_MARGIN * 2,\n        );\n\n        // Choose direction if given direction did not fit\n        if (finalDirection === null && this.contentElementRef) {\n            // Box height if it fits without scroll\n            const visualHeight = Math.min(\n                this.contentElementRef.nativeElement.getBoundingClientRect().height +\n                    (this.elementRef.nativeElement.offsetHeight -\n                        this.elementRef.nativeElement.clientHeight),\n                boxHeightLimit,\n            );\n\n            // If there is enough space to fit below without scroll,\n            // choose 'bottom', unless it was previously on the top\n            if (this.prevDirectionIsTop && topAvailableHeight >= visualHeight) {\n                finalDirection = 'top';\n            } else if (bottomAvailableHeight >= visualHeight) {\n                finalDirection = 'bottom';\n            } else {\n                // Corner case — select direction with more space\n                finalDirection =\n                    bottomAvailableHeight >= topAvailableHeight ? 'bottom' : 'top';\n            }\n        }\n\n        return finalDirection;\n    }\n\n    /**\n     * Calculates width\n     *\n     * @param style dropdownBox elementRef styles object\n     * @param directiveRect ClientRect of hosting directive\n     */\n    private calculateWidth(style: CSSStyleDeclaration, directiveRect: ClientRect): void {\n        style.width =\n            this.directive.limitMinWidth === 'fixed' && !this.directive.sided\n                ? px(directiveRect.width)\n                : '';\n\n        if (this.directive.limitMinWidth === 'min' && !this.directive.sided) {\n            style.minWidth = px(directiveRect.width);\n            style.maxWidth = px(DEFAULT_MAX_WIDTH);\n\n            return;\n        }\n\n        style.minWidth = '';\n        style.maxWidth = '';\n    }\n\n    private moveFocusOutside(previous: boolean): void {\n        const {host} = this.directive;\n        const {ownerDocument} = host;\n        const root = ownerDocument ? ownerDocument.body : host;\n\n        tuiAssertIsHTMLElement(host);\n\n        let focusable = getClosestFocusable(host, previous, root);\n\n        while (focusable !== null && host.contains(focusable)) {\n            focusable = getClosestFocusable(focusable, previous, root);\n        }\n\n        focusable?.focus();\n    }\n}\n","import {NgModule} from '@angular/core';\nimport {TuiActiveZoneModule, TuiOverscrollModule} from '@taiga-ui/cdk';\nimport {TuiScrollbarModule} from '@taiga-ui/core/components/scrollbar';\nimport {TuiModeModule} from '@taiga-ui/core/directives/mode';\nimport {PolymorpheusModule} from '@tinkoff/ng-polymorpheus';\n\nimport {TuiDropdownBoxComponent} from './dropdown-box.component';\n\n@NgModule({\n    imports: [\n        TuiActiveZoneModule,\n        PolymorpheusModule,\n        TuiOverscrollModule,\n        TuiScrollbarModule,\n        TuiModeModule,\n    ],\n    entryComponents: [TuiDropdownBoxComponent],\n    declarations: [TuiDropdownBoxComponent],\n    exports: [TuiDropdownBoxComponent],\n})\nexport class TuiDropdownBoxModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}