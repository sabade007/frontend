import { __decorate, __param } from "tslib";
import { ChangeDetectionStrategy, Component, ElementRef, HostBinding, HostListener, Inject, ViewChild, } from '@angular/core';
import { TUI_TEXTFIELD_WATCHED_CONTROLLER, TuiTextfieldController, } from '@taiga-ui/core/directives';
import { BehaviorSubject } from 'rxjs';
import { delay, distinctUntilChanged, filter, map } from 'rxjs/operators';
import { TuiPrimitiveTextfieldComponent } from '../primitive-textfield.component';
var TuiValueDecorationComponent = /** @class */ (function () {
    function TuiValueDecorationComponent(textfield, controller) {
        var _this = this;
        this.textfield = textfield;
        this.controller = controller;
        this.prefix$ = new BehaviorSubject('');
        this.pre$ = this.prefix$.pipe(delay(0), filter(function () { var _a; return !!((_a = _this.pre) === null || _a === void 0 ? void 0 : _a.nativeElement.isConnected); }), distinctUntilChanged(), map(function () { var _a; return ((_a = _this.pre) === null || _a === void 0 ? void 0 : _a.nativeElement.offsetWidth) || 0; }));
    }
    Object.defineProperty(TuiValueDecorationComponent.prototype, "isContextTable", {
        get: function () {
            return this.textfield.appearance === "table" /* Table */;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "value", {
        get: function () {
            return this.textfield.value;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "filler", {
        get: function () {
            var _a = this, focused = _a.focused, placeholder = _a.placeholder, exampleText = _a.exampleText, value = _a.value, textfield = _a.textfield;
            if (placeholder && exampleText) {
                return '';
            }
            return focused ? exampleText || textfield.filler.slice(value.length) : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "prefix", {
        get: function () {
            return this.decorationsVisible ? this.textfield.prefix : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "postfix", {
        get: function () {
            return this.decorationsVisible ? this.computedPostfix : '';
        },
        enumerable: true,
        configurable: true
    });
    TuiValueDecorationComponent.prototype.ngDoCheck = function () {
        this.prefix$.next(this.prefix);
    };
    Object.defineProperty(TuiValueDecorationComponent.prototype, "placeholder", {
        get: function () {
            var _a;
            return ((_a = this.textfield.nativeFocusableElement) === null || _a === void 0 ? void 0 : _a.placeholder) || '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "exampleText", {
        get: function () {
            var exampleText = this.controller.exampleText || this.placeholder;
            return !this.value && this.focused ? exampleText : '';
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "decorationsVisible", {
        get: function () {
            return !!this.value || this.focused;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "focused", {
        get: function () {
            return this.textfield.computedFocused && !this.textfield.readOnly;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(TuiValueDecorationComponent.prototype, "computedPostfix", {
        get: function () {
            return this.textfield.postfix && (this.filler || this.value)
                ? " " + this.textfield.postfix
                : this.textfield.postfix;
        },
        enumerable: true,
        configurable: true
    });
    TuiValueDecorationComponent.ctorParameters = function () { return [
        { type: TuiPrimitiveTextfieldComponent, decorators: [{ type: Inject, args: [TuiPrimitiveTextfieldComponent,] }] },
        { type: TuiTextfieldController, decorators: [{ type: Inject, args: [TUI_TEXTFIELD_WATCHED_CONTROLLER,] }] }
    ]; };
    __decorate([
        ViewChild('pre', { read: ElementRef, static: true })
    ], TuiValueDecorationComponent.prototype, "pre", void 0);
    __decorate([
        HostBinding('class._table')
    ], TuiValueDecorationComponent.prototype, "isContextTable", null);
    __decorate([
        HostListener('animationstart')
    ], TuiValueDecorationComponent.prototype, "ngDoCheck", null);
    TuiValueDecorationComponent = __decorate([
        Component({
            selector: 'tui-value-decoration',
            template: "<span\n    #pre\n    class=\"t-prefix t-inline\"\n    [textContent]=\"prefix\"\n></span>\n<span\n    class=\"t-ghost t-inline\"\n    [textContent]=\"value\"\n></span>\n<span\n    class=\"t-filler t-inline\"\n    [textContent]=\"filler\"\n></span>\n<span\n    class=\"t-postfix t-inline\"\n    [textContent]=\"postfix\"\n></span>\n",
            // It follows Change Detection of PrimitiveTextfield
            changeDetection: ChangeDetectionStrategy.Default,
            styles: [":host{position:absolute;display:block;height:1.25rem;line-height:1;width:100%;margin:-1.25rem 0;padding:.625rem 0;box-sizing:content-box;color:var(--tui-text-01);animation:1s tuiPresent}:host._table{position:static}:host-context(tui-textfield[data-mode=onDark]) :host{color:var(--tui-text-01-night)}:host:after{content:'';display:inline-block;vertical-align:middle;height:100%}.t-ghost{visibility:hidden;white-space:pre;text-overflow:clip}.t-postfix,.t-prefix{white-space:pre}.t-filler{overflow:hidden;color:var(--tui-text-03);text-overflow:ellipsis;max-width:100%;white-space:nowrap}:host-context(tui-textfield[data-mode=onDark]) .t-filler{color:var(--tui-text-03-night)}.t-inline{display:inline-block;vertical-align:middle}"]
        }),
        __param(0, Inject(TuiPrimitiveTextfieldComponent)),
        __param(1, Inject(TUI_TEXTFIELD_WATCHED_CONTROLLER))
    ], TuiValueDecorationComponent);
    return TuiValueDecorationComponent;
}());
export { TuiValueDecorationComponent };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmFsdWUtZGVjb3JhdGlvbi5jb21wb25lbnQuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdGFpZ2EtdWkvY29yZS9jb21wb25lbnRzL3ByaW1pdGl2ZS10ZXh0ZmllbGQvIiwic291cmNlcyI6WyJ2YWx1ZS1kZWNvcmF0aW9uL3ZhbHVlLWRlY29yYXRpb24uY29tcG9uZW50LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQ0gsdUJBQXVCLEVBQ3ZCLFNBQVMsRUFFVCxVQUFVLEVBQ1YsV0FBVyxFQUNYLFlBQVksRUFDWixNQUFNLEVBQ04sU0FBUyxHQUNaLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFDSCxnQ0FBZ0MsRUFDaEMsc0JBQXNCLEdBQ3pCLE1BQU0sMkJBQTJCLENBQUM7QUFFbkMsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLE1BQU0sQ0FBQztBQUNyQyxPQUFPLEVBQUMsS0FBSyxFQUFFLG9CQUFvQixFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUV4RSxPQUFPLEVBQUMsOEJBQThCLEVBQUMsTUFBTSxrQ0FBa0MsQ0FBQztBQVNoRjtJQWFJLHFDQUVxQixTQUF5QyxFQUV6QyxVQUFrQztRQUp2RCxpQkFLSTtRQUhpQixjQUFTLEdBQVQsU0FBUyxDQUFnQztRQUV6QyxlQUFVLEdBQVYsVUFBVSxDQUF3QjtRQWJ0QyxZQUFPLEdBQUcsSUFBSSxlQUFlLENBQUMsRUFBRSxDQUFDLENBQUM7UUFFMUMsU0FBSSxHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUM3QixLQUFLLENBQUMsQ0FBQyxDQUFDLEVBQ1IsTUFBTSxDQUFDLHNCQUFNLE9BQUEsQ0FBQyxRQUFDLEtBQUksQ0FBQyxHQUFHLDBDQUFFLGFBQWEsQ0FBQyxXQUFXLENBQUEsQ0FBQSxFQUFBLENBQUMsRUFDbkQsb0JBQW9CLEVBQUUsRUFDdEIsR0FBRyxDQUFDLHNCQUFNLE9BQUEsT0FBQSxLQUFJLENBQUMsR0FBRyww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QVcsQ0FBQyxjQUFjLENBQUM7cUVBRzNCO0lBeUJEO1FBREMsWUFBWSxDQUFDLGdCQUFnQixDQUFDO2dFQUc5QjtJQWxEUSwyQkFBMkI7UUFQdkMsU0FBUyxDQUFDO1lBQ1AsUUFBUSxFQUFFLHNCQUFzQjtZQUNoQyxzVkFBK0M7WUFFL0Msb0RBQW9EO1lBQ3BELGVBQWUsRUFBRSx1QkFBdUIsQ0FBQyxPQUFPOztTQUNuRCxDQUFDO1FBZU8sV0FBQSxNQUFNLENBQUMsOEJBQThCLENBQUMsQ0FBQTtRQUV0QyxXQUFBLE1BQU0sQ0FBQyxnQ0FBZ0MsQ0FBQyxDQUFBO09BaEJwQywyQkFBMkIsQ0EyRXZDO0lBQUQsa0NBQUM7Q0FBQSxBQTNFRCxJQTJFQztTQTNFWSwyQkFBMkIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xuICAgIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICAgIENvbXBvbmVudCxcbiAgICBEb0NoZWNrLFxuICAgIEVsZW1lbnRSZWYsXG4gICAgSG9zdEJpbmRpbmcsXG4gICAgSG9zdExpc3RlbmVyLFxuICAgIEluamVjdCxcbiAgICBWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtcbiAgICBUVUlfVEVYVEZJRUxEX1dBVENIRURfQ09OVFJPTExFUixcbiAgICBUdWlUZXh0ZmllbGRDb250cm9sbGVyLFxufSBmcm9tICdAdGFpZ2EtdWkvY29yZS9kaXJlY3RpdmVzJztcbmltcG9ydCB7VHVpQXBwZWFyYW5jZX0gZnJvbSAnQHRhaWdhLXVpL2NvcmUvZW51bXMnO1xuaW1wb3J0IHtCZWhhdmlvclN1YmplY3R9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtkZWxheSwgZGlzdGluY3RVbnRpbENoYW5nZWQsIGZpbHRlciwgbWFwfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7VHVpUHJpbWl0aXZlVGV4dGZpZWxkQ29tcG9uZW50fSBmcm9tICcuLi9wcmltaXRpdmUtdGV4dGZpZWxkLmNvbXBvbmVudCc7XG5cbkBDb21wb25lbnQoe1xuICAgIHNlbGVjdG9yOiAndHVpLXZhbHVlLWRlY29yYXRpb24nLFxuICAgIHRlbXBsYXRlVXJsOiAnLi92YWx1ZS1kZWNvcmF0aW9uLnRlbXBsYXRlLmh0bWwnLFxuICAgIHN0eWxlVXJsczogWycuL3ZhbHVlLWRlY29yYXRpb24uc3R5bGUubGVzcyddLFxuICAgIC8vIEl0IGZvbGxvd3MgQ2hhbmdlIERldGVjdGlvbiBvZiBQcmltaXRpdmVUZXh0ZmllbGRcbiAgICBjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5LkRlZmF1bHQsXG59KVxuZXhwb3J0IGNsYXNzIFR1aVZhbHVlRGVjb3JhdGlvbkNvbXBvbmVudCBpbXBsZW1lbnRzIERvQ2hlY2sge1xuICAgIEBWaWV3Q2hpbGQoJ3ByZScsIHtyZWFkOiBFbGVtZW50UmVmLCBzdGF0aWM6IHRydWV9KVxuICAgIHByaXZhdGUgcmVhZG9ubHkgcHJlPzogRWxlbWVudFJlZjxIVE1MRWxlbWVudD47XG5cbiAgICBwcml2YXRlIHJlYWRvbmx5IHByZWZpeCQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0KCcnKTtcblxuICAgIHJlYWRvbmx5IHByZSQgPSB0aGlzLnByZWZpeCQucGlwZShcbiAgICAgICAgZGVsYXkoMCksXG4gICAgICAgIGZpbHRlcigoKSA9PiAhIXRoaXMucHJlPy5uYXRpdmVFbGVtZW50LmlzQ29ubmVjdGVkKSxcbiAgICAgICAgZGlzdGluY3RVbnRpbENoYW5nZWQoKSxcbiAgICAgICAgbWFwKCgpID0+IHRoaXMucHJlPy5uYXRpdmVFbGVtZW50Lm9mZnNldFdpZHRoIHx8IDApLFxuICAgICk7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgQEluamVjdChUdWlQcmltaXRpdmVUZXh0ZmllbGRDb21wb25lbnQpXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgdGV4dGZpZWxkOiBUdWlQcmltaXRpdmVUZXh0ZmllbGRDb21wb25lbnQsXG4gICAgICAgIEBJbmplY3QoVFVJX1RFWFRGSUVMRF9XQVRDSEVEX0NPTlRST0xMRVIpXG4gICAgICAgIHByaXZhdGUgcmVhZG9ubHkgY29udHJvbGxlcjogVHVpVGV4dGZpZWxkQ29udHJvbGxlcixcbiAgICApIHt9XG5cbiAgICBASG9zdEJpbmRpbmcoJ2NsYXNzLl90YWJsZScpXG4gICAgZ2V0IGlzQ29udGV4dFRhYmxlKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0ZmllbGQuYXBwZWFyYW5jZSA9PT0gVHVpQXBwZWFyYW5jZS5UYWJsZTtcbiAgICB9XG5cbiAgICBnZXQgdmFsdWUoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dGZpZWxkLnZhbHVlO1xuICAgIH1cblxuICAgIGdldCBmaWxsZXIoKTogc3RyaW5nIHtcbiAgICAgICAgY29uc3Qge2ZvY3VzZWQsIHBsYWNlaG9sZGVyLCBleGFtcGxlVGV4dCwgdmFsdWUsIHRleHRmaWVsZH0gPSB0aGlzO1xuXG4gICAgICAgIGlmIChwbGFjZWhvbGRlciAmJiBleGFtcGxlVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGZvY3VzZWQgPyBleGFtcGxlVGV4dCB8fCB0ZXh0ZmllbGQuZmlsbGVyLnNsaWNlKHZhbHVlLmxlbmd0aCkgOiAnJztcbiAgICB9XG5cbiAgICBnZXQgcHJlZml4KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlY29yYXRpb25zVmlzaWJsZSA/IHRoaXMudGV4dGZpZWxkLnByZWZpeCA6ICcnO1xuICAgIH1cblxuICAgIGdldCBwb3N0Zml4KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLmRlY29yYXRpb25zVmlzaWJsZSA/IHRoaXMuY29tcHV0ZWRQb3N0Zml4IDogJyc7XG4gICAgfVxuXG4gICAgQEhvc3RMaXN0ZW5lcignYW5pbWF0aW9uc3RhcnQnKVxuICAgIG5nRG9DaGVjaygpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5wcmVmaXgkLm5leHQodGhpcy5wcmVmaXgpO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0IHBsYWNlaG9sZGVyKCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHRmaWVsZC5uYXRpdmVGb2N1c2FibGVFbGVtZW50Py5wbGFjZWhvbGRlciB8fCAnJztcbiAgICB9XG5cbiAgICBwcml2YXRlIGdldCBleGFtcGxlVGV4dCgpOiBzdHJpbmcge1xuICAgICAgICBjb25zdCBleGFtcGxlVGV4dCA9IHRoaXMuY29udHJvbGxlci5leGFtcGxlVGV4dCB8fCB0aGlzLnBsYWNlaG9sZGVyO1xuXG4gICAgICAgIHJldHVybiAhdGhpcy52YWx1ZSAmJiB0aGlzLmZvY3VzZWQgPyBleGFtcGxlVGV4dCA6ICcnO1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0IGRlY29yYXRpb25zVmlzaWJsZSgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuICEhdGhpcy52YWx1ZSB8fCB0aGlzLmZvY3VzZWQ7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXQgZm9jdXNlZCgpOiBib29sZWFuIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGV4dGZpZWxkLmNvbXB1dGVkRm9jdXNlZCAmJiAhdGhpcy50ZXh0ZmllbGQucmVhZE9ubHk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBnZXQgY29tcHV0ZWRQb3N0Zml4KCk6IHN0cmluZyB7XG4gICAgICAgIHJldHVybiB0aGlzLnRleHRmaWVsZC5wb3N0Zml4ICYmICh0aGlzLmZpbGxlciB8fCB0aGlzLnZhbHVlKVxuICAgICAgICAgICAgPyBgICR7dGhpcy50ZXh0ZmllbGQucG9zdGZpeH1gXG4gICAgICAgICAgICA6IHRoaXMudGV4dGZpZWxkLnBvc3RmaXg7XG4gICAgfVxufVxuIl19