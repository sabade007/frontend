!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@taiga-ui/cdk"),require("@taiga-ui/core/directives/dropdown"),require("@taiga-ui/core/directives/dropdown-controller"),require("@taiga-ui/core/utils/miscellaneous"),require("@angular/common"),require("@tinkoff/ng-polymorpheus")):"function"==typeof define&&define.amd?define("@taiga-ui/core/components/hosted-dropdown",["exports","@angular/core","@taiga-ui/cdk","@taiga-ui/core/directives/dropdown","@taiga-ui/core/directives/dropdown-controller","@taiga-ui/core/utils/miscellaneous","@angular/common","@tinkoff/ng-polymorpheus"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].core=e["taiga-ui"].core||{},e["taiga-ui"].core.components=e["taiga-ui"].core.components||{},e["taiga-ui"].core.components["hosted-dropdown"]={}),e.ng.core,e.cdk,e["taiga-ui"].core.directives.dropdown,e["taiga-ui"].core.directives["dropdown-controller"],e["taiga-ui"].core.utils.miscellaneous,e.ng.common,e.ngPolymorpheus)}(this,(function(e,t,o,n,i,r,s,p){"use strict";function c(e,t,o,n){var i,r=arguments.length,s=r<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,o,n);else for(var p=e.length-1;p>=0;p--)(i=e[p])&&(s=(r<3?i(s):r>3?i(t,o,s):i(t,o))||s);return r>3&&s&&Object.defineProperty(t,o,s),s}function u(e,t){return function(o,n){t(o,n,e)}}Object.create;Object.create;var a=function(){function e(){}return e=c([t.Directive({selector:"[tuiHostedDropdownHost]"})],e)}(),d=function(){function e(e,o){this.elementRef=e,this.controller=o,this.content="",this.canOpen=!0,this.open=!1,this.openChange=new t.EventEmitter,this.focusedChange=new t.EventEmitter}var s;return s=e,Object.defineProperty(e.prototype,"host",{get:function(){return this.dropdownHost?this.dropdownHost.nativeElement:this.elementRef.nativeElement},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dropdown",{get:function(){return this.dropdownDirective&&null!==this.dropdownDirective.dropdownBoxRef?this.dropdownDirective.dropdownBoxRef.location.nativeElement:null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nativeFocusableElement",{get:function(){return o.isNativeKeyboardFocusable(this.host)?this.host:o.getClosestFocusable(this.host,!1,this.elementRef.nativeElement)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"focused",{get:function(){return o.isNativeFocusedIn(this.host)||this.open&&!!this.wrapper&&o.isNativeFocusedIn(this.wrapper.nativeElement)},enumerable:!0,configurable:!0}),e.prototype.onFocusIn=function(e){(this.dropdownHost?this.dropdownHost.nativeElement:this.nativeFocusableElement||this.elementRef.nativeElement).contains(e)||this.updateOpen(!1)},e.prototype.onClick=function(e){var t=this.nativeFocusableElement||this.host,o=this.dropdownHost?this.dropdownHost.nativeElement:t;!this.hostEditable&&o.contains(e)&&this.updateOpen(!this.open)},e.prototype.onKeyDownEsc=function(e){this.canOpen&&this.open&&(e.stopPropagation(),this.closeDropdown())},e.prototype.onArrow=function(e,t){this.focusDropdown(e,t)},e.prototype.onKeydown=function(e){var t=e.key,n=e.target;!e.defaultPrevented&&r.isEditingKey(t)&&this.hostEditable&&n instanceof HTMLElement&&!o.isElementEditable(n)&&this.focusHost()},e.prototype.onActiveZone=function(e){this.updateFocused(e),e||this.updateOpen(!1)},e.prototype.onHostObscured=function(e){e&&this.closeDropdown()},e.prototype.updateOpen=function(e){e&&!this.canOpen||(this.open=e,this.openChange.emit(e))},Object.defineProperty(e.prototype,"hostEditable",{get:function(){var e=this.nativeFocusableElement||this.host;return e instanceof HTMLElement&&o.isElementEditable(e)},enumerable:!0,configurable:!0}),e.prototype.focusDropdown=function(e,t){var n=this.nativeFocusableElement;if(n&&n instanceof HTMLElement&&e.target instanceof Node&&n.contains(e.target)){if(!(this.wrapper&&this.open&&null!==this.dropdown&&this.wrapper.nativeElement.nextElementSibling instanceof HTMLElement))return this.updateOpen(!0),void(o.isElementEditable(n)||e.preventDefault());var i=t?this.wrapper.nativeElement:this.wrapper.nativeElement.nextElementSibling,r=o.getClosestFocusable(i,!t,this.wrapper.nativeElement);null!==r&&(o.setNativeFocused(r),e.preventDefault())}},e.prototype.closeDropdown=function(){this.focused&&this.focusHost(),this.updateOpen(!1)},e.prototype.focusHost=function(){var e=this.nativeFocusableElement;null!==e&&o.setNativeFocused(e,!0,!0)},e.prototype.updateFocused=function(e){this.focusedChange.emit(e)},e.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:i.TuiDropdownControllerDirective,decorators:[{type:t.Inject,args:[i.TUI_DROPDOWN_WATCHED_CONTROLLER]}]}]},c([t.ContentChild(a,{read:t.ElementRef})],e.prototype,"dropdownHost",void 0),c([t.ViewChild("wrapper",{read:t.ElementRef})],e.prototype,"wrapper",void 0),c([t.ViewChild(n.TuiDropdownDirective)],e.prototype,"dropdownDirective",void 0),c([t.Input(),o.tuiDefaultProp()],e.prototype,"content",void 0),c([t.Input(),o.tuiDefaultProp()],e.prototype,"canOpen",void 0),c([t.Input(),o.tuiDefaultProp()],e.prototype,"open",void 0),c([t.Output()],e.prototype,"openChange",void 0),c([t.Output()],e.prototype,"focusedChange",void 0),c([t.HostBinding("class._hosted_dropdown_focused")],e.prototype,"focused",null),c([t.HostListener("focusin",["$event.target"])],e.prototype,"onFocusIn",null),c([t.HostListener("click",["$event.target"])],e.prototype,"onClick",null),c([t.HostListener("keydown.esc",["$event"])],e.prototype,"onKeyDownEsc",null),c([t.HostListener("keydown.arrowDown",["$event","true"]),t.HostListener("keydown.arrowUp",["$event","false"])],e.prototype,"onArrow",null),e=s=c([t.Component({selector:"tui-hosted-dropdown",template:'<div\n    #activeZone="tuiActiveZone"\n    class="t-wrapper"\n    [tuiDropdownAlign]="controller.align"\n    [tuiDropdownDirection]="controller.direction"\n    [tuiDropdownHost]="nativeFocusableElement"\n    [tuiDropdownLimitWidth]="controller.limitWidth"\n    [tuiDropdownMinHeight]="controller.minHeight"\n    [tuiDropdownMaxHeight]="controller.maxHeight"\n    [tuiDropdownSided]="controller.sided"\n    [tuiDropdownContent]="dropdown"\n    [tuiDropdown]="open && canOpen"\n    [tuiObscuredEnabled]="open"\n    (tuiObscured)="onHostObscured($event)"\n    (tuiActiveZoneChange)="onActiveZone($event)"\n>\n    <ng-content></ng-content>\n    <ng-template\n        #dropdown="polymorpheus"\n        polymorpheus\n    >\n        <div\n            #wrapper\n            polymorpheus-outlet\n            [content]="content"\n            [context]="{$implicit: activeZone}"\n            (keydown.esc)="onKeyDownEsc($event)"\n            (keydown)="onKeydown($event)"\n        ></div>\n        \x3c!--This DIV is here to start backwards TreeWalker for focusing last focusable item on ArrowUp--\x3e\n        <div></div>\n    </ng-template>\n</div>\n',changeDetection:t.ChangeDetectionStrategy.OnPush,providers:[{provide:o.TUI_FOCUSABLE_ITEM_ACCESSOR,useExisting:t.forwardRef((function(){return s}))},i.DROPDOWN_CONTROLLER_PROVIDER],styles:[":host{display:inline-flex}.t-wrapper{border-radius:inherit;height:inherit;flex:1 1 auto;width:100%}"]}),u(0,t.Inject(t.ElementRef)),u(1,t.Inject(i.TUI_DROPDOWN_WATCHED_CONTROLLER))],e)}(),l=function(){function e(){}return e=c([t.NgModule({imports:[s.CommonModule,o.TuiObscuredModule,p.PolymorpheusModule,o.TuiActiveZoneModule,n.TuiDropdownModule],declarations:[d,a],exports:[d,a]})],e)}();e.TuiHostedDropdownComponent=d,e.TuiHostedDropdownConnectorDirective=a,e.TuiHostedDropdownModule=l,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-core-components-hosted-dropdown.umd.min.js.map