!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@taiga-ui/cdk"),require("@taiga-ui/core/constants"),require("@taiga-ui/core/utils/format")):"function"==typeof define&&define.amd?define("@taiga-ui/core/utils/mask",["exports","@taiga-ui/cdk","@taiga-ui/core/constants","@taiga-ui/core/utils/format"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].core=e["taiga-ui"].core||{},e["taiga-ui"].core.utils=e["taiga-ui"].core.utils||{},e["taiga-ui"].core.utils.mask={}),e.cdk,e["taiga-ui"].core.constants,e["taiga-ui"].core.utils.format)}(this,(function(e,t,r,i){"use strict";Object.create;function n(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var i,n,u=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(i=u.next()).done;)a.push(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}return a}function u(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(n(arguments[t]));return e}Object.create;var a=/[1-9]/;function o(e){return e.split("").map((function(e){return r.TUI_DIGIT_REGEXP.test(e)?r.TUI_DIGIT_REGEXP:e}))}function s(e){switch(e){case"":case t.CHAR_HYPHEN:case",":case t.CHAR_HYPHEN+",":return!0;default:return!1}}var l=s;function c(e,t,r){return parseFloat(e.split(r).join("").split(t).join("."))}var f=c;e.maskedMoneyValueIsEmpty=s,e.maskedNumberStringToNumber=c,e.tuiCreateAutoCorrectedNumberPipe=function(e,r,i,n,u,a){void 0===e&&(e=0),void 0===r&&(r=","),void 0===i&&(i=t.CHAR_NO_BREAK_SPACE),void 0===a&&(a=!1),t.tuiAssert.assert(Number.isInteger(e)),t.tuiAssert.assert(e>=0);var o=-1,s=!!n&&t.isSafari(n)||a;return n&&s&&n.addEventListener("beforeinput",(function(){o=n.selectionStart||0})),function(a,l){if(!a&&l.rawValue===t.CHAR_HYPHEN&&u)return t.CHAR_HYPHEN;if(n&&s&&t.isNativeFocused(n)){var c=function(e,t,r,i){void 0===e&&(e="");void 0===i&&(i=",");var n=new RegExp(i+".+"),u=e.replace(n,""),a=t.replace(n,"");if(Math.abs(u.length-a.length)>2)return t.length;if(e.length===t.length)return e.indexOf(i)<=r?function(e,t){for(var r=0;r<t.length;r++)if(e[r]!==t[r])return"0"===t[r]?r:r+1;return t.length}(e,t):u===a?r-1:r+1;if(0===e.length)return 1;var o=t.length-e.length;return r+o}(l.previousConformedValue,a,o);setTimeout((function(){n.setSelectionRange(c,c)}))}if(n&&n.ownerDocument!==t.getDocumentOrShadowRoot(n)&&t.isNativeFocused(n)&&l.currentCaretPosition){var f=l.currentCaretPosition+function(e,t,r){void 0===e&&(e="");if(Math.abs(e.length-t.length)>2)return 0;var i=e.split(r).length;return t.split(r).length-i}(l.previousConformedValue,a,i);setTimeout((function(){n.setSelectionRange(f,f)}))}if(""===a||!e)return{value:a};var d=function(e,t){void 0===t&&(t=",");return e.includes(t)?e:e+t}(a,r),v=d.split(r)[1],g=e-v.length;return{value:d+"0".repeat(g)}}},e.tuiCreateCorrectionMask=function(e,i){return function(n){var a=n.split("").reduce((function(n,a,o){var s=i(a,o);return t.tuiAssert.assert(null===s||1===s.length,"Correction function must return single char or null"),e.test(a)||s?e.test(a)?u(n,[e]):s?u(n,[s,r.MASK_CARET_TRAP]):n:n}),[]),o=a.lastIndexOf(r.MASK_CARET_TRAP),s=a.filter((function(e,t){return e!==r.MASK_CARET_TRAP||t===o}));return s.some((function(t){return t!==e}))?u(s,[e]):s}},e.tuiCreateNumberMask=function(e){var s=void 0===e?{}:e,l=s.allowDecimal,c=void 0!==l&&l,f=s.decimalSymbol,d=void 0===f?",":f,v=s.thousandSymbol,g=void 0===v?t.CHAR_NO_BREAK_SPACE:v,m=s.autoCorrectDecimalSymbol,_=void 0===m||m,h=s.decimalLimit,E=void 0===h?2:h,p=s.requireDecimal,A=void 0!==p&&p,R=s.allowNegative,I=void 0!==R&&R,T=s.integerLimit,C=void 0===T?0:T;return t.tuiAssert.assert(Number.isInteger(E)),t.tuiAssert.assert(E>=0),t.tuiAssert.assert(Number.isInteger(C)),t.tuiAssert.assert(C>=0),function(e,s){var l=s.previousConformedValue;l&&A&&(e.split(g).join("")===l.split(g).join("").split(d).join("")&&(e=l));var f=(e[0]===t.CHAR_HYPHEN||e[0]===t.CHAR_EN_DASH)&&I;if(function(e,t,r){if(r)return/^[,.]$/.test(e);return e===t}(e,d,_)&&c)return["0",d,r.TUI_DIGIT_REGEXP];f&&(e=e.slice(1));var v=function(e,t,r){if(!r)return e.lastIndexOf(t);return Math.max(e.lastIndexOf(t),e.lastIndexOf(i.otherDecimalSymbol(t)))}(e,d,_),m=-1!==v,h=m?e.slice(0,v):e,p=h.match(new RegExp(g,"g"))||[],R=(C?h.slice(0,C+p.length):h).replace(r.TUI_NON_DIGITS_REGEXP,""),T=n(R.match(r.TUI_LEADING_ZEROES_REGEXP)||[""],1)[0].length,S=R.replace(/^0+(?!\.|$)/,"").trim(),P=o(function(e,t){return e.length>3?e.replace(/\B(?=(\d{3})+(?!\d))/g,t):e}(S,g));if(m&&c||A){var N=m?o(e.slice(v+1).replace(r.TUI_NON_DIGITS_REGEXP,"")):[],b=E?N.slice(0,E):N;e[v]!==i.otherDecimalSymbol(d)&&P.push(r.MASK_CARET_TRAP),P.push.apply(P,u([d,r.MASK_CARET_TRAP],b));for(var y=0;y<E-b.length;y++)P.push(r.TUI_DIGIT_REGEXP)}var H=1===P.length&&"0"===S;return f&&(0===P.length&&P.push(r.TUI_DIGIT_REGEXP),P.unshift(t.CHAR_HYPHEN)),function(e,t,i){void 0===t&&(t=!1);void 0===i&&(i=0);if(t||0===i)return e;var n=e.indexOf(r.TUI_DIGIT_REGEXP);if(-1===n)return e;var u=e[n+1]===r.MASK_CARET_TRAP;if(u&&1===i)return e;if(u)return e.unshift(a),e;return e[n]=a,e}(P,H,T)}},e.tuiEnableAutoCorrectDecimalSymbol=function(e){var t=e.thousandSeparator;return!r.TUI_DECIMAL_SYMBOLS.includes(t)},e.tuiMaskedMoneyValueIsEmpty=l,e.tuiMaskedNumberStringToNumber=f,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-core-utils-mask.umd.min.js.map