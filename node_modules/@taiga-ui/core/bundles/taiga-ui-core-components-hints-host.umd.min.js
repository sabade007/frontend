!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("@ng-web-apis/common"),require("@taiga-ui/cdk"),require("@taiga-ui/core/animations"),require("@taiga-ui/core/directives"),require("@taiga-ui/core/directives/pointer-hint"),require("@taiga-ui/core/tokens"),require("@taiga-ui/core/utils"),require("@tinkoff/ng-polymorpheus"),require("rxjs"),require("rxjs/operators"),require("@taiga-ui/core/services"),require("@angular/common")):"function"==typeof define&&define.amd?define("@taiga-ui/core/components/hints-host",["exports","@angular/core","@ng-web-apis/common","@taiga-ui/cdk","@taiga-ui/core/animations","@taiga-ui/core/directives","@taiga-ui/core/directives/pointer-hint","@taiga-ui/core/tokens","@taiga-ui/core/utils","@tinkoff/ng-polymorpheus","rxjs","rxjs/operators","@taiga-ui/core/services","@angular/common"],e):e(((t=t||self)["taiga-ui"]=t["taiga-ui"]||{},t["taiga-ui"].core=t["taiga-ui"].core||{},t["taiga-ui"].core.components=t["taiga-ui"].core.components||{},t["taiga-ui"].core.components["hints-host"]={}),t.ng.core,t.common,t.cdk,t["taiga-ui"].core.animations,t["taiga-ui"].core.directives,t["taiga-ui"].core.directives["pointer-hint"],t["taiga-ui"].core.tokens,t["taiga-ui"].core.utils,t.ngPolymorpheus,t.rxjs,t.rxjs.operators,t["taiga-ui"].core.services,t.ng.common)}(this,(function(t,e,o,i,r,n,a,s,d,c,h,l,u,p){"use strict";var f=function(){return(f=Object.assign||function(t){for(var e,o=1,i=arguments.length;o<i;o++)for(var r in e=arguments[o])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function m(t,e,o,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,o):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,i);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(n<3?r(a):n>3?r(e,o,a):r(e,o))||a);return n>3&&a&&Object.defineProperty(e,o,a),a}function b(t,e){return function(o,i){e(o,i,t)}}Object.create;Object.create;var g=function(){function t(t,e){this.elementRef=t,this.hints$=e,this.component=new c.PolymorpheusComponent(x)}return Object.defineProperty(t.prototype,"clientRect",{get:function(){return this.elementRef.nativeElement.getBoundingClientRect()},enumerable:!0,configurable:!0}),t.ctorParameters=function(){return[{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:h.Observable,decorators:[{type:e.Inject,args:[u.TuiHintService]}]}]},t=m([e.Component({selector:"tui-hints-host",template:'<div\n    *ngFor="let hint of hints$ | async"\n    role="tooltip"\n    polymorpheus-outlet\n    @tuiParentAnimation\n    [attr.id]="hint.id"\n    [content]="hint.component || component"\n    [context]="{$implicit: hint}"\n    [tuiActiveZoneParent]="hint.activeZone"\n></div>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,animations:[i.TUI_PARENT_ANIMATION],host:{"aria-live":"polite"},styles:[":host{position:fixed;bottom:0;left:0;width:100%;height:0}"]}),b(0,e.Inject(e.ElementRef)),b(1,e.Inject(u.TuiHintService))],t)}(),v=16+8*Math.sqrt(2)/2,w={"top-left":"bottom-left","top-right":"bottom-right","bottom-left":"top-left","bottom-right":"top-right",left:"right",right:"left","top-middle":"bottom-middle","bottom-middle":"top-middle"},y={"top-left":"top-right","top-right":"top-left","bottom-left":"bottom-right","bottom-right":"bottom-left",left:"right",right:"left","top-middle":"top-middle","bottom-middle":"bottom-middle"},x=function(){function t(t,e,o,r,n,a,s,d,c){var h=this;this.options=r,this.elementRef=n,this.windowRef=a,this.media=s,this.hintsHost=d,this.context=c,this.animation=f({value:""},this.options),t.pipe(i.tuiZonefree(o),l.takeUntil(e)).subscribe((function(){return h.calculatePosition()}))}return Object.defineProperty(t.prototype,"hint",{get:function(){return this.context.$implicit},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUntouchable",{get:function(){return this.hint instanceof a.TuiPointerHintDirective},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mode",{get:function(){return this.hint.mode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMobile",{get:function(){return d.tuiIsMobile(this.windowRef,this.media)},enumerable:!0,configurable:!0}),t.prototype.onHovered=function(t){this.hint instanceof n.TuiHintDirective&&this.hint.componentHovered$.next(t)},t.prototype.calculatePosition=function(){"overflow"!==this.mode?this.calculateCoordinates():this.setOverflowStyles()},t.prototype.calculateCoordinates=function(){if(this.isMobile)this.calculateMobileCoordinates();else{var t=this.hint.getElementClientRect(),e=this.hintsHost.clientRect,o=this.elementRef.nativeElement,r=o.style,n=o.getBoundingClientRect(),a=t.width>2*v,s=["left","right","bottom-left","bottom-right","bottom-middle","top-left","top-right","top-middle"],d=0,c=0,h=this.hint.direction,l=t.top+t.height/2-n.height/2-e.top,u=t.left-n.width-8-e.left,p=t.left+t.width+8-e.left,f=t.bottom+8-e.top,m=t.top-n.height-8-e.top,b=a?t.left-e.left:t.left+t.width/2-v-e.left,g=a?t.left-n.width+t.width-e.left:t.left-n.width+t.width/2+v-e.left,x=t.left-n.width/2+t.width/2-e.left;for(s.splice(s.indexOf(h),1);;){switch(h){case"left":d=l,c=u;break;case"right":d=l,c=p;break;case"top-right":d=m,c=b;break;case"top-left":d=m,c=g;break;case"bottom-right":d=f,c=b;break;case"bottom-left":d=f,c=g;break;case"bottom-middle":d=f,c=x;break;case"top-middle":d=m,c=x}var I=d+e.top>8&&d+n.height+8+e.top<this.windowRef.innerHeight,j=c>8&&c+n.width+8+e.left<e.width;if(0===s.length||I&&j)break;h=I?y[h]:w[h],h=s.splice(s.indexOf(h),1)[0]||h}r.top=i.px(d),r.left=i.px(c),o.setAttribute("data-tui-host-direction",h)}},t.prototype.calculateMobileCoordinates=function(){var t=this.hint.getElementClientRect(),e=this.hintsHost.clientRect,o=this.elementRef.nativeElement,r=o.style,n=o.getBoundingClientRect(),a=t.top-n.height-8-e.top,s=t.bottom+8-e.top,d=a+e.top>8&&t.top<this.windowRef.innerHeight,c=t.bottom>0&&t.bottom+16+n.height<this.windowRef.innerHeight,h=this.hint.direction.includes("top")&&d||!c?"top":"bottom",l=e.left+t.left+t.width/2-n.width/2,u=Math.max(l+n.width+8>e.right?e.right-8-n.width:l,16);r.left=i.px(u),r.top="top"===h?i.px(a):i.px(s),this.arrow&&(this.arrow.nativeElement.style.left=i.px(t.left<=16&&t.width>32?16:t.left+t.width/2-u-4)),o.setAttribute("data-tui-host-direction",h)},t.prototype.setOverflowStyles=function(){var t=this.hint.getElementClientRect(),e=this.elementRef.nativeElement.style;e.top=i.px(t.top-window.innerHeight-12-1),e.left=i.px(t.left-16-1),e.width=i.px(t.width+32+2)},t.ctorParameters=function(){return[{type:h.Observable,decorators:[{type:e.Inject,args:[o.ANIMATION_FRAME]}]},{type:h.Observable,decorators:[{type:e.Inject,args:[i.TuiDestroyService]}]},{type:e.NgZone,decorators:[{type:e.Inject,args:[e.NgZone]}]},{type:void 0,decorators:[{type:e.Inject,args:[s.TUI_ANIMATION_OPTIONS]}]},{type:e.ElementRef,decorators:[{type:e.Inject,args:[e.ElementRef]}]},{type:Window,decorators:[{type:e.Inject,args:[o.WINDOW]}]},{type:void 0,decorators:[{type:e.Inject,args:[s.TUI_MEDIA]}]},{type:g,decorators:[{type:e.Inject,args:[e.forwardRef((function(){return g}))]}]},{type:void 0,decorators:[{type:e.Inject,args:[c.POLYMORPHEUS_CONTEXT]}]}]},m([e.ViewChild("arrow")],t.prototype,"arrow",void 0),m([e.HostBinding("@tuiFadeIn")],t.prototype,"animation",void 0),m([i.tuiPure,e.HostBinding("class._untouchable")],t.prototype,"isUntouchable",null),m([e.HostBinding("attr.data-mode")],t.prototype,"mode",null),t=m([e.Component({selector:"tui-hint-box[hint]",template:'\x3c!-- @bad TODO: Refactor to use this arrow in all cases --\x3e\n<div\n    *ngIf="isMobile && mode !== \'overflow\'"\n    #arrow\n    class="t-arrow"\n></div>\n<div\n    automation-id="tui-hint-box__tooltip"\n    polymorpheus-outlet\n    class="t-tooltip"\n    [content]="hint.content"\n    (tuiHoveredChange)="onHovered($event)"\n>\n    <ng-template let-text>\n        <span class="t-text">{{ text }}</span>\n    </ng-template>\n</div>\n',changeDetection:e.ChangeDetectionStrategy.OnPush,providers:[i.TuiDestroyService],animations:[r.tuiFadeIn],styles:[":host{position:absolute;top:0;left:0;max-width:18rem;min-height:var(--tui-height-m);padding:.75rem 1rem;background:var(--tui-primary);border-radius:var(--tui-radius-l);color:var(--tui-primary-text);box-sizing:border-box}:host .t-arrow,:host:not([data-mode=overflow]):before{content:'';position:absolute;width:.5rem;height:.5rem;border-radius:.125rem;box-sizing:border-box;background-color:inherit;transform:rotate(45deg)}:host[data-tui-host-direction=top] .t-arrow{bottom:-.25rem}:host[data-tui-host-direction=bottom] .t-arrow{top:-.25rem}:host[data-tui-host-direction=bottom]:before,:host[data-tui-host-direction=top]:before{display:none}:host[data-tui-host-direction=top-left]:before,:host[data-tui-host-direction=top-middle]:before,:host[data-tui-host-direction=top-right]:before{bottom:-.25rem}:host[data-tui-host-direction=bottom-left]:before,:host[data-tui-host-direction=bottom-middle]:before,:host[data-tui-host-direction=bottom-right]:before{top:-.25rem}:host[data-tui-host-direction=bottom-middle]:before,:host[data-tui-host-direction=top-middle]:before{left:calc(50% - .2rem)}:host[data-tui-host-direction=bottom-left]:before,:host[data-tui-host-direction=top-left]:before{right:1.075rem}:host[data-tui-host-direction=bottom-right]:before,:host[data-tui-host-direction=top-right]:before{left:1.075rem}:host[data-tui-host-direction=left]:before,:host[data-tui-host-direction=right]:before{top:50%;margin-top:-.25rem}:host[data-tui-host-direction=left]:before{right:-.25rem}:host[data-tui-host-direction=right]:before{left:-.25rem}:host[data-mode=error]{background-color:var(--tui-error-fill)}:host[data-mode=onDark],:host[data-mode=overflow]{box-shadow:0 .5rem 1rem rgba(0,0,0,.16);border:1px solid var(--tui-base-03);background-color:var(--tui-base-01);color:var(--tui-text-01)}:host[data-mode=onDark]:before,:host[data-mode=overflow]:before{border:1px solid var(--tui-base-03)}:host[data-mode=onDark][data-tui-host-direction=left]:before,:host[data-mode=overflow][data-tui-host-direction=left]:before{border-left-color:transparent;border-bottom-color:transparent}:host[data-mode=onDark][data-tui-host-direction=right]:before,:host[data-mode=overflow][data-tui-host-direction=right]:before{border-right-color:transparent;border-top-color:transparent}:host[data-mode=onDark][data-tui-host-direction=top-left]:before,:host[data-mode=onDark][data-tui-host-direction=top-middle]:before,:host[data-mode=onDark][data-tui-host-direction=top-right]:before,:host[data-mode=overflow][data-tui-host-direction=top-left]:before,:host[data-mode=overflow][data-tui-host-direction=top-middle]:before,:host[data-mode=overflow][data-tui-host-direction=top-right]:before{border-left-color:transparent;border-top-color:transparent}:host[data-mode=onDark][data-tui-host-direction=bottom-left]:before,:host[data-mode=onDark][data-tui-host-direction=bottom-middle]:before,:host[data-mode=onDark][data-tui-host-direction=bottom-right]:before,:host[data-mode=overflow][data-tui-host-direction=bottom-left]:before,:host[data-mode=overflow][data-tui-host-direction=bottom-middle]:before,:host[data-mode=overflow][data-tui-host-direction=bottom-right]:before{border-right-color:transparent;border-bottom-color:transparent}:host[data-mode=overflow]{max-width:none}:host._untouchable{pointer-events:none}.t-tooltip{font:var(--tui-font-text-s);word-wrap:break-word}:host[data-mode=overflow] .t-tooltip{font:inherit}.t-text{white-space:pre-wrap}"]}),b(0,e.Inject(o.ANIMATION_FRAME)),b(1,e.Inject(i.TuiDestroyService)),b(2,e.Inject(e.NgZone)),b(3,e.Inject(s.TUI_ANIMATION_OPTIONS)),b(4,e.Inject(e.ElementRef)),b(5,e.Inject(o.WINDOW)),b(6,e.Inject(s.TUI_MEDIA)),b(7,e.Inject(e.forwardRef((function(){return g})))),b(8,e.Inject(c.POLYMORPHEUS_CONTEXT))],t)}(),I=function(){function t(){}return t=m([e.NgModule({imports:[p.CommonModule,c.PolymorpheusModule,i.TuiHoveredModule],declarations:[x],exports:[x],entryComponents:[x]})],t)}(),j=function(){function t(){}return t=m([e.NgModule({imports:[p.CommonModule,c.PolymorpheusModule,I,i.TuiActiveZoneModule],declarations:[g],exports:[g]})],t)}();t.TuiHintBoxComponent=x,t.TuiHintBoxModule=I,t.TuiHintsHostComponent=g,t.TuiHintsHostModule=j,Object.defineProperty(t,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-core-components-hints-host.umd.min.js.map