{"version":3,"file":"taiga-ui-cdk-directives-for-async.js","sources":["ng://@taiga-ui/cdk/directives/for-async/for-async.directive.ts","ng://@taiga-ui/cdk/directives/for-async/for-async.module.ts","ng://@taiga-ui/cdk/directives/for-async/taiga-ui-cdk-directives-for-async.ts"],"sourcesContent":["import {\n    Directive,\n    Inject,\n    Input,\n    OnChanges,\n    OnDestroy,\n    TemplateRef,\n    ViewContainerRef,\n} from '@angular/core';\nimport {from, of, Subject} from 'rxjs';\nimport {concatMap, delay, takeUntil} from 'rxjs/operators';\n\n@Directive({selector: '[tuiForAsync][tuiForAsyncOf]'})\nexport class TuiForAsyncDirective<T> implements OnChanges, OnDestroy {\n    private readonly destroy$ = new Subject<void>();\n\n    @Input()\n    tuiForAsyncOf: readonly T[] | null | undefined;\n\n    @Input()\n    tuiForAsyncTimeout = 10;\n\n    constructor(\n        @Inject(ViewContainerRef) private readonly view: ViewContainerRef,\n        @Inject(TemplateRef) private readonly template: TemplateRef<unknown>,\n    ) {}\n\n    ngOnChanges(): void {\n        this.clearViewForOldNodes();\n        this.createAsyncViewForNewNodes();\n    }\n\n    ngOnDestroy(): void {\n        this.clearViewForOldNodes();\n        this.destroy$.complete();\n    }\n\n    private createAsyncViewForNewNodes(): void {\n        from((this.tuiForAsyncOf || []).entries())\n            .pipe(\n                concatMap(entry => of(entry).pipe(delay(this.tuiForAsyncTimeout))),\n                takeUntil(this.destroy$),\n            )\n            .subscribe(([index, item]) =>\n                this.view\n                    .createEmbeddedView(this.template, {$implicit: item, index}, index)\n                    .detectChanges(),\n            );\n    }\n\n    private clearViewForOldNodes(): void {\n        this.destroy$.next();\n        this.view.clear();\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiForAsyncDirective} from './for-async.directive';\n\n/**\n * @experimental\n */\n@NgModule({\n    declarations: [TuiForAsyncDirective],\n    exports: [TuiForAsyncDirective],\n})\nexport class TuiForAsyncModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;IAaa,oBAAoB,GAAjC,MAAa,oBAAoB;IAS7B,YAC+C,IAAsB,EAC3B,QAA8B;QADzB,SAAI,GAAJ,IAAI,CAAkB;QAC3B,aAAQ,GAAR,QAAQ,CAAsB;QAVvD,aAAQ,GAAG,IAAI,OAAO,EAAQ,CAAC;QAMhD,uBAAkB,GAAG,EAAE,CAAC;KAKpB;IAEJ,WAAW;QACP,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,0BAA0B,EAAE,CAAC;KACrC;IAED,WAAW;QACP,IAAI,CAAC,oBAAoB,EAAE,CAAC;QAC5B,IAAI,CAAC,QAAQ,CAAC,QAAQ,EAAE,CAAC;KAC5B;IAEO,0BAA0B;QAC9B,IAAI,CAAC,CAAC,IAAI,CAAC,aAAa,IAAI,EAAE,EAAE,OAAO,EAAE,CAAC;aACrC,IAAI,CACD,SAAS,CAAC,KAAK,IAAI,EAAE,CAAC,KAAK,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,kBAAkB,CAAC,CAAC,CAAC,EAClE,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CAC3B;aACA,SAAS,CAAC,CAAC,CAAC,KAAK,EAAE,IAAI,CAAC,KACrB,IAAI,CAAC,IAAI;aACJ,kBAAkB,CAAC,IAAI,CAAC,QAAQ,EAAE,EAAC,SAAS,EAAE,IAAI,EAAE,KAAK,EAAC,EAAE,KAAK,CAAC;aAClE,aAAa,EAAE,CACvB,CAAC;KACT;IAEO,oBAAoB;QACxB,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;QACrB,IAAI,CAAC,IAAI,CAAC,KAAK,EAAE,CAAC;KACrB;EACJ;;YA/BwD,gBAAgB,uBAAhE,MAAM,SAAC,gBAAgB;YACwB,WAAW,uBAA1D,MAAM,SAAC,WAAW;;AAPvB;IADC,KAAK,EAAE;2DACuC;AAG/C;IADC,KAAK,EAAE;gEACgB;AAPf,oBAAoB;IADhC,SAAS,CAAC,EAAC,QAAQ,EAAE,8BAA8B,EAAC,CAAC;IAW7C,WAAA,MAAM,CAAC,gBAAgB,CAAC,CAAA;IACxB,WAAA,MAAM,CAAC,WAAW,CAAC,CAAA;GAXf,oBAAoB,CAyChC;;AClDD;;;IAOa,iBAAiB,GAA9B,MAAa,iBAAiB;EAAG;AAApB,iBAAiB;IAJ7B,QAAQ,CAAC;QACN,YAAY,EAAE,CAAC,oBAAoB,CAAC;QACpC,OAAO,EAAE,CAAC,oBAAoB,CAAC;KAClC,CAAC;GACW,iBAAiB,CAAG;;ACXjC;;;;;;"}