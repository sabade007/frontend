{"version":3,"file":"taiga-ui-cdk-decorators.js","sources":["ng://@taiga-ui/cdk/decorators/default-prop.ts","ng://@taiga-ui/cdk/decorators/pure.ts","ng://@taiga-ui/cdk/decorators/required-setter.ts","ng://@taiga-ui/cdk/decorators/taiga-ui-cdk-decorators.ts"],"sourcesContent":["import {tuiAssert} from '@taiga-ui/cdk/classes';\nimport {TuiBooleanHandler} from '@taiga-ui/cdk/types';\n\n/**\n * Decorator for checking input values for undefined. You can also pass\n * optional assertion to check input against.\n *\n * CAUTION: This decorator overwrites other getters and setters.\n */\nexport function tuiDefaultProp<T extends Record<string, any>, K extends keyof T>(\n    assertion?: TuiBooleanHandler<T[K]>,\n    ...args: unknown[]\n): PropertyDecorator {\n    return (target, key) => {\n        const {name} = target.constructor;\n        const errorGetDefaultMessage = errorGetDefault(key, name);\n        const errorSetDefaultMessage = errorSetDefault(key, name);\n\n        Object.defineProperty(target, key, {\n            configurable: true,\n            get(): undefined {\n                tuiAssert.assert(false, errorGetDefaultMessage);\n\n                return undefined;\n            },\n            set(this: T, initialValue: T[K]) {\n                const isValid = initialValue !== undefined;\n                const errorMessage = errorSetDefaultInitial(key, name);\n                let currentValue = initialValue;\n\n                tuiAssert.assert(isValid, errorMessage);\n\n                if (isValid && assertion) {\n                    tuiAssert.assert(\n                        assertion.call(this, initialValue),\n                        `${String(key)} in ${name} received:`,\n                        initialValue,\n                        ...args,\n                    );\n                }\n\n                Object.defineProperty(this, key, {\n                    configurable: true,\n                    get(): T[K] {\n                        return currentValue;\n                    },\n                    set(this: T, value: T[K]) {\n                        const isValid = value !== undefined;\n                        const backupValue = initialValue;\n\n                        tuiAssert.assert(\n                            isValid,\n                            errorSetDefaultMessage,\n                            String(backupValue),\n                        );\n\n                        if (isValid && assertion) {\n                            tuiAssert.assert(\n                                assertion.call(this, value),\n                                `${String(key)} in ${name} received:`,\n                                value,\n                                ...args,\n                            );\n                        }\n\n                        currentValue = isValid ? value : backupValue;\n                    },\n                });\n            },\n        });\n    };\n}\n\nfunction errorGetDefault(key: string | symbol, component: string): string {\n    return `Default value for ${String(\n        key,\n    )} was not provided in ${component}, error in Taiga UI Angular Kit`;\n}\n\nfunction errorSetDefault(key: string | symbol, component: string): string {\n    return `Undefined was passed as ${String(\n        key,\n    )} to ${component}, which is invalid input, using default value:`;\n}\n\nfunction errorSetDefaultInitial(key: string | symbol, component: string): string {\n    return `Undefined was passed as default value for ${String(\n        key,\n    )} to ${component}, error in Taiga UI Angular Kit`;\n}\n","import {TuiPureException} from '@taiga-ui/cdk/exceptions';\n\n/**\n * Implements lazy initialization for getter or memoization of a function call similar to pure {@link: Pipe}.\n * Replaces getter with its calculated value upon first call or keeps track of last call arguments and returned\n * value for function, skipping calculation when arguments are strictly the same.\n *\n * @throws error if used not on getter or function\n *\n * CAUTION: `this` is not available inside such functions/getters, they must be pure.\n */\nexport function tuiPure<T>(\n    _target: Record<string, any>,\n    propertyKey: string,\n    {get, enumerable, value}: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T> {\n    if (get) {\n        return {\n            configurable: true,\n            enumerable,\n            get(): T {\n                const value = get.call(this);\n\n                Object.defineProperty(this, propertyKey, {enumerable, value});\n\n                return value;\n            },\n        };\n    }\n\n    if (typeof value !== `function`) {\n        throw new TuiPureException();\n    }\n\n    const original = value;\n\n    return {\n        configurable: true,\n        enumerable,\n        get(): T {\n            let previousArgs: readonly unknown[] = [];\n            let originalFnWasCalledLeastAtOnce = false;\n            let pureValue: unknown;\n\n            const patched = (...args: unknown[]): unknown => {\n                const isPure =\n                    originalFnWasCalledLeastAtOnce &&\n                    previousArgs.length === args.length &&\n                    args.every((arg, index) => arg === previousArgs[index]);\n\n                if (isPure) {\n                    return pureValue;\n                }\n\n                previousArgs = args;\n                pureValue = original.apply(this, args);\n                originalFnWasCalledLeastAtOnce = true;\n\n                return pureValue;\n            };\n\n            Object.defineProperty(this, propertyKey, {\n                configurable: true,\n                value: patched,\n            });\n\n            return patched as unknown as T;\n        },\n    };\n}\n","import {tuiAssert} from '@taiga-ui/cdk/classes';\nimport {TuiBooleanHandler} from '@taiga-ui/cdk/types';\n\n/**\n * Decorator for checking input setter values against a custom assertion which\n * takes value passed to input setter and component instance as arguments.\n * It specifically checks for undefined values and prevents calls to the\n * original setter in this case.\n */\nexport function tuiRequiredSetter<T extends Record<string, any>, K extends keyof T>(\n    assertion?: TuiBooleanHandler<T[K]>,\n    ...args: any[]\n): MethodDecorator {\n    return (\n        target: Record<string, any>,\n        key,\n        {configurable, enumerable, get, set}: PropertyDescriptor,\n    ): PropertyDescriptor => {\n        const {name} = target.constructor;\n\n        return {\n            configurable,\n            enumerable,\n            get,\n            set(this: T, value: T[K]) {\n                if (value !== undefined && assertion) {\n                    tuiAssert.assert(\n                        assertion.call(this, value),\n                        `${String(key)} in ${name} received:`,\n                        value,\n                        ...args,\n                    );\n                }\n\n                if (!set || value === undefined) {\n                    tuiAssert.assert(value !== undefined, errorSet(key, name));\n\n                    return;\n                }\n\n                set.call(this, value);\n            },\n        };\n    };\n}\n\nfunction errorSet(key: string | symbol, component: string): string {\n    return `Undefined was passed as ${String(\n        key,\n    )} to ${component}, setter will not be called`;\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}