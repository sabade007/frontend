{"version":3,"file":"taiga-ui-cdk-directives-active-zone.js","sources":["ng://@taiga-ui/cdk/directives/active-zone/active-zone.directive.ts","ng://@taiga-ui/cdk/directives/active-zone/active-zone.module.ts","ng://@taiga-ui/cdk/directives/active-zone/taiga-ui-cdk-directives-active-zone.ts"],"sourcesContent":["import {\n    Directive,\n    ElementRef,\n    Inject,\n    Input,\n    NgZone,\n    OnDestroy,\n    Optional,\n    Output,\n    SkipSelf,\n} from '@angular/core';\nimport {tuiDefaultProp, tuiPure} from '@taiga-ui/cdk/decorators';\nimport {tuiZoneOptimized} from '@taiga-ui/cdk/observables';\nimport {TUI_ACTIVE_ELEMENT} from '@taiga-ui/cdk/tokens';\nimport {Observable} from 'rxjs';\nimport {distinctUntilChanged, map, skip, startWith} from 'rxjs/operators';\n\n@Directive({\n    selector:\n        '[tuiActiveZone]:not(ng-container), [tuiActiveZoneChange]:not(ng-container), [tuiActiveZoneParent]:not(ng-container)',\n    exportAs: 'tuiActiveZone',\n})\nexport class TuiActiveZoneDirective implements OnDestroy {\n    private subActiveZones: readonly TuiActiveZoneDirective[] = [];\n\n    private tuiActiveZoneParent: TuiActiveZoneDirective | null = null;\n\n    @Input('tuiActiveZoneParent')\n    @tuiDefaultProp()\n    set tuiActiveZoneParentSetter(zone: TuiActiveZoneDirective | null) {\n        this.setZone(zone);\n    }\n\n    @Output()\n    readonly tuiActiveZoneChange = this.active$.pipe(\n        map(element => !!element && this.contains(element)),\n        startWith(false),\n        distinctUntilChanged(),\n        skip(1),\n        tuiZoneOptimized(this.ngZone),\n    );\n\n    constructor(\n        @Inject(TUI_ACTIVE_ELEMENT)\n        private readonly active$: Observable<Element | null>,\n        @Inject(NgZone) private readonly ngZone: NgZone,\n        @Inject(ElementRef) private readonly elementRef: ElementRef<Element>,\n        @Optional()\n        @SkipSelf()\n        @Inject(TuiActiveZoneDirective)\n        private readonly directParentActiveZone: TuiActiveZoneDirective | null,\n    ) {\n        if (this.directParentActiveZone) {\n            this.directParentActiveZone.addSubActiveZone(this);\n        }\n    }\n\n    ngOnDestroy(): void {\n        if (this.directParentActiveZone) {\n            this.directParentActiveZone.removeSubActiveZone(this);\n        }\n\n        if (this.tuiActiveZoneParent) {\n            this.tuiActiveZoneParent.removeSubActiveZone(this);\n        }\n    }\n\n    contains(node: Node): boolean {\n        return (\n            this.elementRef.nativeElement.contains(node) ||\n            this.subActiveZones.some(\n                (item, index, array) =>\n                    array.indexOf(item) === index && item.contains(node),\n            )\n        );\n    }\n\n    @tuiPure\n    private setZone(zone: TuiActiveZoneDirective | null): void {\n        if (this.tuiActiveZoneParent) {\n            this.tuiActiveZoneParent.removeSubActiveZone(this);\n        }\n\n        if (zone) {\n            zone.addSubActiveZone(this);\n        }\n\n        this.tuiActiveZoneParent = zone;\n    }\n\n    private addSubActiveZone(activeZone: TuiActiveZoneDirective): void {\n        this.subActiveZones = [...this.subActiveZones, activeZone];\n    }\n\n    private removeSubActiveZone(activeZone: TuiActiveZoneDirective): void {\n        const index = this.subActiveZones.findIndex(item => item === activeZone);\n\n        this.subActiveZones = [\n            ...this.subActiveZones.slice(0, index),\n            ...this.subActiveZones.slice(index + 1),\n        ];\n    }\n}\n","import {NgModule} from '@angular/core';\n\nimport {TuiActiveZoneDirective} from './active-zone.directive';\n\n@NgModule({\n    declarations: [TuiActiveZoneDirective],\n    exports: [TuiActiveZoneDirective],\n})\nexport class TuiActiveZoneModule {}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}