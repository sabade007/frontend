"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const workspace_1 = require("@schematics/angular/utility/workspace");
const get_project_1 = require("../../utils/get-project");
const get_project_target_options_1 = require("../../utils/get-project-target-options");
const TAIGA_GLOBAL_STYLE = `node_modules/@taiga-ui/core/styles/taiga-ui-global.less`;
const TAIGA_THEME_STYLE = `node_modules/@taiga-ui/core/styles/taiga-ui-theme.less`;
function addTaigaStyles(options) {
    return (_) => tslib_1.__awaiter(this, void 0, void 0, function* () {
        return addTaigaStylesToAngularJson(options);
    });
}
exports.addTaigaStyles = addTaigaStyles;
function addTaigaStylesToAngularJson(options) {
    return workspace_1.updateWorkspace(workspace => {
        const project = get_project_1.getProject(options, workspace);
        const targetOptions = get_project_target_options_1.getProjectTargetOptions(project, `build`);
        const styles = targetOptions.styles;
        const taigaStyles = [TAIGA_GLOBAL_STYLE, TAIGA_THEME_STYLE];
        targetOptions.styles = styles
            ? Array.from(new Set([...taigaStyles, ...styles]))
            : taigaStyles;
    });
}
exports.addTaigaStylesToAngularJson = addTaigaStylesToAngularJson;
