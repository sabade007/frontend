!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("rxjs"),require("@angular/common"),require("@taiga-ui/cdk/tokens"),require("@taiga-ui/cdk/observables"),require("rxjs/operators"),require("@taiga-ui/cdk/utils/dom"),require("@ng-web-apis/common"),require("@taiga-ui/cdk/constants"),require("@ng-web-apis/resize-observer"),require("@taiga-ui/cdk/classes"),require("@taiga-ui/cdk/utils/math"),require("@taiga-ui/cdk/utils/miscellaneous"),require("@taiga-ui/cdk/utils")):"function"==typeof define&&define.amd?define("@taiga-ui/cdk/services",["exports","@angular/core","rxjs","@angular/common","@taiga-ui/cdk/tokens","@taiga-ui/cdk/observables","rxjs/operators","@taiga-ui/cdk/utils/dom","@ng-web-apis/common","@taiga-ui/cdk/constants","@ng-web-apis/resize-observer","@taiga-ui/cdk/classes","@taiga-ui/cdk/utils/math","@taiga-ui/cdk/utils/miscellaneous","@taiga-ui/cdk/utils"],t):t(((e=e||self)["taiga-ui"]=e["taiga-ui"]||{},e["taiga-ui"].cdk=e["taiga-ui"].cdk||{},e["taiga-ui"].cdk.services={}),e.ng.core,e.rxjs,e.ng.common,e["taiga-ui"].cdk.tokens,e["taiga-ui"].cdk.observables,e.rxjs.operators,e["taiga-ui"].cdk.utils.dom,e.common$1,e["taiga-ui"].cdk.constants,e.resizeObserver,e["taiga-ui"].cdk.classes,e["taiga-ui"].cdk.utils.math,e["taiga-ui"].cdk.utils.miscellaneous,e["taiga-ui"].cdk.utils)}(this,(function(e,t,n,r,o,i,c,a,s,u,l,p,f,d,m){"use strict";var v=function(e,t){return(v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function I(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}v(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function y(e,t,n,r){var o,i=arguments.length,c=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(c=(i<3?o(c):i>3?o(t,n,c):o(t,n))||c);return i>3&&c&&Object.defineProperty(t,n,c),c}function g(e,t){return function(n,r){t(n,r,e)}}Object.create;function h(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c}Object.create;var E=function(e){function n(){return e.call(this,1)||this}return I(n,e),n.prototype.ngOnDestroy=function(){this.next(),this.complete()},n=y([t.Injectable()],n)}(n.ReplaySubject),j=function(){function e(e,t,n,r){this.resolver=e,this.injector=t,this.documentRef=n,this.renderer=r,this.map=new Map}return e.prototype.addComponent=function(e){this.map.has(e)||this.map.set(e,this.resolver.resolveComponentFactory(e).create(this.injector))},e.prototype.addStyle=function(e,t){if(!this.documentRef.head.querySelector("style["+t+"]")){var n=this.renderer.createElement("style");this.renderer.setProperty(n,"textContent",e),this.renderer.setAttribute(n,t,""),this.documentRef.head.appendChild(n)}},e.ctorParameters=function(){return[{type:t.ComponentFactoryResolver,decorators:[{type:t.Inject,args:[t.ComponentFactoryResolver]}]},{type:t.Injector,decorators:[{type:t.Inject,args:[t.INJECTOR]}]},{type:Document,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]},{type:t.Renderer2,decorators:[{type:t.Inject,args:[o.TUI_DEFAULT_RENDERER]}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(t.ComponentFactoryResolver),t.ɵɵinject(t.INJECTOR),t.ɵɵinject(r.DOCUMENT),t.ɵɵinject(o.TUI_DEFAULT_RENDERER))},token:e,providedIn:"root"}),e=y([t.Injectable({providedIn:"root"}),g(0,t.Inject(t.ComponentFactoryResolver)),g(1,t.Inject(t.INJECTOR)),g(2,t.Inject(r.DOCUMENT)),g(3,t.Inject(o.TUI_DEFAULT_RENDERER))],e)}(),b=function(e){function r(t,n,r){var o=t.nativeElement,a=e.call(this,(function(e){return a.focusVisible$.subscribe(e)}))||this;return a.focusVisible$=i.focusVisibleObservable(o).pipe(i.watch(n),c.takeUntil(r)),a}return I(r,e),r.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:t.ChangeDetectorRef,decorators:[{type:t.Inject,args:[t.ChangeDetectorRef]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[E]}]}]},r=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(t.ChangeDetectorRef)),g(2,t.Inject(E))],r)}(n.Observable),O=function(){function e(e,t){this.ngZone=t,this.documentEvents$=n.merge(i.typedFromEvent(e,"mousemove"),i.typedFromEvent(e,"touchstart",{capture:!0}))}return e.prototype.createHovered$=function(e,t){var r=this;return void 0===t&&(t={passive:!0}),n.merge(i.typedFromEvent(e,"mouseenter",t),i.typedFromEvent(e,"touchstart",t)).pipe(c.switchMap((function(){return n.merge(i.typedFromEvent(e,"mouseleave",t),r.documentEvents$.pipe(c.filter((function(t){return!e.contains(a.getActualTarget(t))})),i.tuiZoneOptimized(r.ngZone),c.take(1))).pipe(c.mapTo(!1),c.startWith(!0))})),c.distinctUntilChanged())},e.ctorParameters=function(){return[{type:Document,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]},{type:t.NgZone,decorators:[{type:t.Inject,args:[t.NgZone]}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r.DOCUMENT),t.ɵɵinject(t.NgZone))},token:e,providedIn:"root"}),e=y([t.Injectable({providedIn:"root"}),g(0,t.Inject(r.DOCUMENT)),g(1,t.Inject(t.NgZone))],e)}(),R=function(){function e(){}var n;return n=e,e.prototype.generate=function(){return"tui_"+n.autoId+++Date.now()},e.autoId=0,e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=n=y([t.Injectable({providedIn:"root"})],e)}(),T=function(e){function r(t,r){var o=e.call(this,(function(e){return o.callback$.subscribe(e)}))||this;return o.callback$=n.defer((function(){for(var e=t.nativeElement,o=[r,e];e.parentElement;)e=e.parentElement,o.push(e);return n.merge.apply(void 0,function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(h(arguments[t]));return e}(o.map((function(e){return i.typedFromEvent(e,"scroll")}))))})),o}return I(r,e),r.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:Window,decorators:[{type:t.Inject,args:[s.WINDOW]}]}]},r=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(s.WINDOW))],r)}(n.Observable),N=function(e){function r(t,r,o,s,l,p){var f=r.nativeElement,d=e.call(this,(function(e){return d.obscured$.subscribe(e)}))||this;return d.obscured$=n.merge(n.merge(t,n.fromEvent(s,"resize")).pipe(c.delay(0)),p.pipe(c.throttleTime(u.POLLING_TIME))).pipe(c.map((function(){return a.getElementObscurers(f)})),c.startWith(null),c.distinctUntilChanged(),i.tuiZoneOptimized(o),c.takeUntil(l)),d}return I(r,e),r.ctorParameters=function(){return[{type:T,decorators:[{type:t.Inject,args:[T]},{type:t.Self}]},{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:t.NgZone,decorators:[{type:t.Inject,args:[t.NgZone]}]},{type:Window,decorators:[{type:t.Inject,args:[s.WINDOW]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[E]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[s.ANIMATION_FRAME]}]}]},r=y([t.Injectable(),g(0,t.Inject(T)),g(0,t.Self()),g(1,t.Inject(t.ElementRef)),g(2,t.Inject(t.NgZone)),g(3,t.Inject(s.WINDOW)),g(4,t.Inject(E)),g(5,t.Inject(s.ANIMATION_FRAME))],r)}(n.Observable),S=function(e){function o(t,r){var o=t.nativeElement;return e.call(this,(function(e){n.merge(i.typedFromEvent(o,"touchstart",{passive:!0}),i.typedFromEvent(o,"mousedown")).pipe(c.switchMapTo(n.merge(i.typedFromEvent(r,"touchmove",{passive:!0}).pipe(c.filter((function(e){return e.touches.length<2})),c.map((function(e){return e.touches[0]}))),i.typedFromEvent(r,"mousemove"))),c.pairwise(),c.map((function(e){var t=h(e,2),n=t[0],r=t[1];return[r.clientX-n.clientX,r.clientY-n.clientY]})),c.takeUntil(n.merge(i.typedFromEvent(r,"touchend"),i.typedFromEvent(r,"mouseup"))),c.repeat()).subscribe(e)}))||this}return I(o,e),o.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:Document,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]}]},o=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(r.DOCUMENT))],o)}(n.Observable),k=function(e){function r(t,n,r,o,a,s){return(e.call(this,t,n,o,a)||this).pipe(c.catchError((function(){return s.pipe(c.throttleTime(u.POLLING_TIME),c.map((function(){return t.nativeElement.clientWidth+" "+t.nativeElement.clientHeight})),c.distinctUntilChanged(),c.mapTo(u.EMPTY_ARRAY))})),c.debounceTime(0),i.tuiZonefree(n),c.takeUntil(r))}return I(r,e),r.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:t.NgZone,decorators:[{type:t.Inject,args:[t.NgZone]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[E]}]},{type:Boolean,decorators:[{type:t.Inject,args:[l.RESIZE_OBSERVER_SUPPORT]}]},{type:void 0,decorators:[{type:t.Inject,args:[l.RESIZE_OPTION_BOX]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[s.ANIMATION_FRAME]}]}]},r=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(t.NgZone)),g(2,t.Inject(E)),g(3,t.Inject(l.RESIZE_OBSERVER_SUPPORT)),g(4,t.Inject(l.RESIZE_OPTION_BOX)),g(5,t.Inject(s.ANIMATION_FRAME))],r)}(l.ResizeObserverService),_=function(){function e(e,t){this.performanceRef=e,this.animationFrame$=t}return e.prototype.scroll$=function(e,t,r,o){var i=this;void 0===r&&(r=M(e)),void 0===o&&(o=300),p.tuiAssert.assert(o>=0,"Duration cannot be negative"),p.tuiAssert.assert(t>=0,"scrollTop cannot be negative"),p.tuiAssert.assert(r>=0,"scrollLeft cannot be negative");var a=function(e){return"scrollY"in e?e.scrollY:e.scrollTop}(e),s=M(e),u=t-a,l=r-s;return(o?n.defer((function(){return n.of(i.performanceRef.now())})).pipe(c.switchMap((function(e){return i.animationFrame$.pipe(c.map((function(t){return t-e})))})),c.map((function(e){return d.tuiEaseInOutQuad(f.tuiClamp(e/o,0,1))})),c.map((function(e){return[a+u*e,s+l*e]})),c.takeUntil(n.timer(o))):n.of([t,r])).pipe(c.tap((function(t){var n,r=h(t,2),o=r[0],i=r[1];null===(n=e.scrollTo)||void 0===n||n.call(e,i,o)})))},e.ctorParameters=function(){return[{type:Performance,decorators:[{type:t.Inject,args:[s.PERFORMANCE]}]},{type:n.Observable,decorators:[{type:t.Inject,args:[s.ANIMATION_FRAME]}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(s.PERFORMANCE),t.ɵɵinject(s.ANIMATION_FRAME))},token:e,providedIn:"root"}),e=y([t.Injectable({providedIn:"root"}),g(0,t.Inject(s.PERFORMANCE)),g(1,t.Inject(s.ANIMATION_FRAME))],e)}();function M(e){return"scrollX"in e?e.scrollX:e.scrollLeft}var F=function(){function e(){this.cache=new Map}return e.prototype.request=function(e){var t=this.cache.get(e);if(t)return t;var r=new n.Observable((function(t){var n=new XMLHttpRequest;return n.onreadystatechange=function(){if(4===n.readyState){var e=n.responseType?n.response:n.responseText;200===n.status?(t.next(e),t.complete()):t.error(e)}},n.open("GET",e),n.send(),function(){n.abort()}})).pipe(c.shareReplay({bufferSize:1,refCount:!1}));return this.cache.set(e,r),r},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=y([t.Injectable({providedIn:"root"})],e)}(),P=function(e){function a(t,r,o){var a=t.nativeElement,s=r.timeout,u=r.threshold;return e.call(this,(function(e){n.merge(i.typedFromEvent(a,"touchstart",{passive:!0}),i.typedFromEvent(o,"touchend")).pipe(c.pairwise(),c.filter((function(e){var t=h(e,2),n=t[0],r=t[1];return!!n.touches.length&&n.touches[0].identifier===r.changedTouches[0].identifier})),c.map((function(e){var t=h(e,2),n=t[0],r=t[1],o=n.touches[0].clientX,i=n.touches[0].clientY,c=o-r.changedTouches[0].clientX,a=i-r.changedTouches[0].clientY,l=r.timeStamp-n.timeStamp;return(Math.abs(c)>u||Math.abs(a)>u)&&l<s?{direction:d.getSwipeDirection(c,a),events:[n,r]}:null})),c.filter(d.isPresent)).subscribe(e)}))||this}return I(a,e),a.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:void 0,decorators:[{type:t.Inject,args:[o.TUI_SWIPE_OPTIONS]}]},{type:Document,decorators:[{type:t.Inject,args:[r.DOCUMENT]}]}]},a=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(o.TUI_SWIPE_OPTIONS)),g(2,t.Inject(r.DOCUMENT))],a)}(n.Observable),w=function(e){function r(t,r){var o=t.nativeElement,a=r.wheelSensitivity;return e.call(this,(function(e){n.merge(i.typedFromEvent(o,"touchstart",{passive:!0}).pipe(c.filter((function(e){return e.touches.length>1})),c.switchMap((function(e){return i.typedFromEvent(o,"touchmove",{passive:!0}).pipe(i.preventDefault(),c.scan((function(e,t){var n=m.distanceBetweenTouches(t);return{event:t,distance:n,delta:.01*(n-e.distance)}}),{event:e,distance:m.distanceBetweenTouches(e),delta:0}),c.map((function(e){var t=e.event,n=e.delta;return{clientX:(t.touches[0].clientX+t.touches[1].clientX)/2,clientY:(t.touches[0].clientY+t.touches[1].clientY)/2,delta:n,event:t}})),c.takeUntil(i.typedFromEvent(o,"touchend")))}))),i.typedFromEvent(o,"wheel",{passive:!1}).pipe(i.preventDefault(),c.map((function(e){return{clientX:e.clientX,clientY:e.clientY,delta:-e.deltaY*a,event:e}})))).subscribe(e)}))||this}return I(r,e),r.ctorParameters=function(){return[{type:t.ElementRef,decorators:[{type:t.Inject,args:[t.ElementRef]}]},{type:void 0,decorators:[{type:t.Inject,args:[o.TUI_ZOOM_OPTIONS]}]}]},r=y([t.Injectable(),g(0,t.Inject(t.ElementRef)),g(1,t.Inject(o.TUI_ZOOM_OPTIONS))],r)}(n.Observable);e.TuiDestroyService=E,e.TuiDirectiveStylesService=j,e.TuiFocusVisibleService=b,e.TuiHoveredService=O,e.TuiIdService=R,e.TuiObscuredService=N,e.TuiPanService=S,e.TuiParentsScrollService=T,e.TuiResizeService=k,e.TuiScrollService=_,e.TuiStaticRequestService=F,e.TuiSwipeService=P,e.TuiZoomService=w,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=taiga-ui-cdk-services.umd.min.js.map